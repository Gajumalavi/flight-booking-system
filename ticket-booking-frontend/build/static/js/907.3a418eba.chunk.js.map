{"version":3,"file":"static/js/907.3a418eba.chunk.js","mappings":"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","sources":["components/common/Navbar.tsx","components/common/ErrorAlert.tsx","components/auth/Login.tsx","components/auth/Register.tsx","utils/formatters.ts","components/common/HighlightText.tsx","components/common/AirportAutocomplete.tsx","components/flight/FlightList.tsx","services/websocket.service.ts","components/flight/SeatSelection.tsx","components/flight/SeatSelectionWrapper.tsx","components/home/Home.tsx","components/profile/Profile.tsx","components/booking/BookingHistory.tsx","components/booking/BookingConfirmation.tsx","components/common/ProtectedRoute.tsx","components/admin/ApiManagement.tsx","components/admin/UserManagement.tsx","components/admin/AdminDashboard.tsx","components/common/AdminRoute.tsx","AppRouter.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport {\n    AppBar,\n    Toolbar,\n    Typography,\n    Button,\n    IconButton,\n    Menu,\n    MenuItem,\n    Divider,\n    Avatar,\n    Tooltip\n} from '@mui/material';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport MenuIcon from '@mui/icons-material/Menu';\nimport HomeIcon from '@mui/icons-material/Home';\nimport AirplaneTicketIcon from '@mui/icons-material/AirplaneTicket';\nimport PersonIcon from '@mui/icons-material/Person';\nimport HistoryIcon from '@mui/icons-material/History';\nimport AdminPanelSettingsIcon from '@mui/icons-material/AdminPanelSettings';\nimport { useAuth } from '../../contexts/AuthContext';\n\nconst Navbar = () => {\n    const navigate = useNavigate();\n    const location = useLocation();\n    const { isAuthenticated, user, logout, checkAuth } = useAuth();\n    \n    // Auth status with loading state\n    const [authStatus, setAuthStatus] = useState({\n        isAuthenticated: false,\n        isAdmin: false,\n        checked: false\n    });\n    \n    // Check auth status on mount and path change\n    useEffect(() => {\n        const updateAuthStatus = () => {\n            const isAuth = checkAuth();\n            const isAdminUser = user?.role === 'ADMIN';\n            \n            console.log('Navbar auth check:', { isAuth, user, isAdmin: isAdminUser });\n            \n            setAuthStatus({\n                isAuthenticated: isAuth,\n                isAdmin: isAdminUser,\n                checked: true\n            });\n        };\n        \n        updateAuthStatus();\n    }, [checkAuth, user, location.pathname]);\n    \n    const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);\n    const open = Boolean(anchorEl);\n    \n    const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n        setAnchorEl(event.currentTarget);\n    };\n    \n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    const handleLogout = () => {\n        logout();\n        handleClose();\n        navigate('/');\n    };\n\n    return (\n        <AppBar \n            position=\"static\" \n            sx={{ \n                background: 'linear-gradient(45deg, #E33069 30%, #9C27B0 90%)',\n                boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n            }}\n        >\n            <Toolbar>\n                <IconButton\n                    size=\"large\"\n                    edge=\"start\"\n                    color=\"inherit\"\n                    aria-label=\"menu\"\n                    sx={{ mr: 2 }}\n                    onClick={() => navigate('/')}\n                >\n                    <HomeIcon />\n                </IconButton>\n                \n                <Typography variant=\"h6\" component=\"div\" sx={{ flexGrow: 1 }}>\n                    Flight Booking System\n                </Typography>\n                \n                <Button color=\"inherit\" onClick={() => navigate('/flights')} startIcon={<AirplaneTicketIcon />}>\n                    Flights\n                </Button>\n                \n                {authStatus.isAuthenticated && (\n                    <>\n                        <Button color=\"inherit\" onClick={() => navigate('/profile')} startIcon={<PersonIcon />}>\n                            Profile\n                        </Button>\n                        \n                        <Button color=\"inherit\" onClick={() => navigate('/bookings')} startIcon={<HistoryIcon />}>\n                            Bookings\n                        </Button>\n                        \n                        {authStatus.isAdmin && (\n                            <Button \n                                color=\"inherit\" \n                                onClick={() => {\n                                    console.log('Admin button clicked, navigating to /admin');\n                                    navigate('/admin');\n                                }} \n                                startIcon={<AdminPanelSettingsIcon />}\n                            >\n                                Admin\n                            </Button>\n                        )}\n                    </>\n                )}\n                \n                {authStatus.isAuthenticated ? (\n                    <>\n                        <Tooltip title={user?.email || 'User'}>\n                            <IconButton\n                                onClick={handleClick}\n                                size=\"small\"\n                                aria-controls={open ? 'account-menu' : undefined}\n                                aria-haspopup=\"true\"\n                                aria-expanded={open ? 'true' : undefined}\n                                sx={{ ml: 2 }}\n                            >\n                                <Avatar sx={{ width: 32, height: 32, bgcolor: '#FF7F23' }}>\n                                    {user?.email?.charAt(0).toUpperCase() || 'U'}\n                                </Avatar>\n                            </IconButton>\n                        </Tooltip>\n                        \n                        <Menu\n                            id=\"basic-menu\"\n                            anchorEl={anchorEl}\n                            open={open}\n                            onClose={handleClose}\n                            MenuListProps={{\n                                'aria-labelledby': 'basic-button',\n                            }}\n                            PaperProps={{\n                                sx: {\n                                    borderRadius: '8px',\n                                    boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n                                }\n                            }}\n                        >\n                            <MenuItem onClick={() => { handleClose(); navigate('/profile'); }}>Profile</MenuItem>\n                            <MenuItem onClick={() => { handleClose(); navigate('/bookings'); }}>My Bookings</MenuItem>\n                            \n                            {authStatus.isAdmin && (\n                                <>\n                                    <Divider />\n                                    <MenuItem onClick={() => { \n                                        handleClose(); \n                                        console.log('Admin menu item clicked, navigating to /admin');\n                                        navigate('/admin'); \n                                    }}>\n                                        Admin Dashboard\n                                    </MenuItem>\n                                </>\n                            )}\n                            \n                            <Divider />\n                            <MenuItem onClick={handleLogout}>Logout</MenuItem>\n                        </Menu>\n                    </>\n                ) : (\n                    <>\n                        <Button \n                            color=\"inherit\" \n                            onClick={() => navigate('/login')}\n                            sx={{ borderRadius: '8px' }}\n                        >\n                            Login\n                        </Button>\n                        <Button \n                            color=\"inherit\" \n                            onClick={() => navigate('/register')}\n                            sx={{ \n                                ml: 1, \n                                bgcolor: 'rgba(255, 255, 255, 0.15)',\n                                borderRadius: '8px',\n                                '&:hover': {\n                                    bgcolor: 'rgba(255, 255, 255, 0.25)',\n                                }\n                            }}\n                        >\n                            Register\n                        </Button>\n                    </>\n                )}\n            </Toolbar>\n        </AppBar>\n    );\n};\n\nexport default Navbar;","import React from 'react';\r\nimport { Alert, AlertTitle, Box, Collapse, IconButton } from '@mui/material';\r\nimport CloseIcon from '@mui/icons-material/Close';\r\n\r\ninterface ErrorAlertProps {\r\n  error: string | null;\r\n  severity?: 'error' | 'warning' | 'info' | 'success';\r\n  title?: string;\r\n  onClose?: () => void;\r\n  action?: React.ReactNode;\r\n  sx?: any;\r\n}\r\n\r\nconst ErrorAlert: React.FC<ErrorAlertProps> = ({\r\n  error,\r\n  severity = 'error',\r\n  title,\r\n  onClose,\r\n  action,\r\n  sx = {}\r\n}) => {\r\n  if (!error) return null;\r\n\r\n  return (\r\n    <Box sx={{ width: '100%', mb: 2, ...sx }}>\r\n      <Collapse in={!!error}>\r\n        <Alert\r\n          severity={severity}\r\n          action={\r\n            onClose ? (\r\n              <IconButton\r\n                aria-label=\"close\"\r\n                color=\"inherit\"\r\n                size=\"small\"\r\n                onClick={onClose}\r\n              >\r\n                <CloseIcon fontSize=\"inherit\" />\r\n              </IconButton>\r\n            ) : action\r\n          }\r\n        >\r\n          {title && <AlertTitle>{title}</AlertTitle>}\r\n          {error}\r\n        </Alert>\r\n      </Collapse>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default ErrorAlert; ","import React, { useState, useEffect } from 'react';\nimport {\n    Box,\n    TextField,\n    Button,\n    Typography,\n    Container,\n    Paper,\n    CircularProgress,\n    Alert\n} from '@mui/material';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport ErrorAlert from '../common/ErrorAlert';\nimport { useAuth } from '../../contexts/AuthContext';\n\nconst Login = () => {\n    const navigate = useNavigate();\n    const location = useLocation();\n    const { login, loading: authLoading } = useAuth();\n    \n    const [email, setEmail] = useState('');\n    const [password, setPassword] = useState('');\n    const [error, setError] = useState('');\n    const [sessionExpired, setSessionExpired] = useState(false);\n    const [loading, setLoading] = useState(false);\n    const [showTestCredentials, setShowTestCredentials] = useState(false);\n\n    // Check for session expiration message in query params\n    useEffect(() => {\n        const queryParams = new URLSearchParams(location.search);\n        const expired = queryParams.get('expired');\n        if (expired === 'true') {\n            setSessionExpired(true);\n        }\n    }, [location]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError('');\n        setSessionExpired(false);\n\n        if (!email || !password) {\n            setError('Email and password are required!');\n            return;\n        }\n\n        setLoading(true);\n\n        try {\n            console.log(' Attempting login with:', { email });\n            \n            // Use the login function from AuthContext\n            const success = await login(email, password);\n            \n            if (success) {\n                console.log(' Login successful.');\n                \n                // Redirect to either the requested page or flights listing\n                const { from } = location.state as { from?: string } || {};\n                navigate(from || '/flights');\n            } else {\n                throw new Error('Login failed');\n            }\n        } catch (error: any) {  // Use `any` to fix TypeScript error\n            console.error(' Login failed:', error.message);\n            \n            // Provide more user-friendly error messages\n            if (error.status === 401) {\n                setError('Invalid email or password. Please try again.');\n            } else if (error.status === 403) {\n                setError('Your account is locked. Please contact support.');\n            } else if (!navigator.onLine) {\n                setError('No internet connection. Please check your network and try again.');\n            } else {\n                setError(error.message || 'Login failed. Please try again.'); \n            }\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const applyTestCredentials = (role: string) => {\n        if (role === 'admin') {\n            setEmail('admin@example.com');\n            setPassword('adminpassword');\n        } else {\n            setEmail('user@example.com');\n            setPassword('userpassword');\n        }\n    };\n\n    // Combine local and auth loading states\n    const isLoading = loading || authLoading;\n\n    return (\n        <Container component=\"main\" maxWidth=\"xs\">\n            <Paper \n                elevation={3} \n                sx={{ \n                    p: 4, \n                    mt: 8, \n                    borderRadius: '8px',\n                    boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n                }}\n            >\n                <Box sx={{ \n                    p: 3, \n                    mb: 3, \n                    background: 'linear-gradient(45deg, #E33069 30%, #9C27B0 90%)',\n                    color: 'white',\n                    borderRadius: '8px',\n                    textAlign: 'center'\n                }}>\n                    <Typography component=\"h1\" variant=\"h5\">\n                        Login to Your Account\n                    </Typography>\n                </Box>\n\n                {sessionExpired && (\n                    <Alert \n                        severity=\"warning\" \n                        sx={{ \n                            mb: 3,\n                            borderRadius: '8px'\n                        }}\n                    >\n                        Your session has expired. Please log in again.\n                    </Alert>\n                )}\n\n                <ErrorAlert \n                    error={error}\n                    onClose={() => setError('')}\n                />\n\n                <Box component=\"form\" onSubmit={handleSubmit} sx={{ mt: 1 }}>\n                    <TextField\n                        margin=\"normal\"\n                        required\n                        fullWidth\n                        id=\"email\"\n                        label=\"Email Address\"\n                        name=\"email\"\n                        autoComplete=\"email\"\n                        autoFocus\n                        value={email}\n                        onChange={(e) => setEmail(e.target.value)}\n                        error={!!error && !email}\n                        disabled={isLoading}\n                        sx={{\n                            '& .MuiOutlinedInput-root': {\n                                borderRadius: '8px',\n                                bgcolor: '#F5F8FA'\n                            }\n                        }}\n                    />\n                    <TextField\n                        margin=\"normal\"\n                        required\n                        fullWidth\n                        name=\"password\"\n                        label=\"Password\"\n                        type=\"password\"\n                        id=\"password\"\n                        autoComplete=\"current-password\"\n                        value={password}\n                        onChange={(e) => setPassword(e.target.value)}\n                        error={!!error && !password}\n                        disabled={isLoading}\n                        sx={{\n                            '& .MuiOutlinedInput-root': {\n                                borderRadius: '8px',\n                                bgcolor: '#F5F8FA'\n                            }\n                        }}\n                    />\n                    <Button\n                        type=\"submit\"\n                        fullWidth\n                        variant=\"contained\"\n                        sx={{ \n                            mt: 3, \n                            mb: 2,\n                            bgcolor: '#FF7F23',\n                            '&:hover': {\n                                bgcolor: '#E67D2E'\n                            },\n                            borderRadius: '8px'\n                        }}\n                        disabled={isLoading}\n                    >\n                        {isLoading ? <CircularProgress size={24} /> : 'Sign In'}\n                    </Button>\n                    <Button\n                        onClick={() => navigate('/register')}\n                        fullWidth\n                        variant=\"outlined\"\n                        sx={{ \n                            mt: 1,\n                            borderRadius: '8px',\n                            borderColor: '#9C27B0',\n                            color: '#9C27B0',\n                            '&:hover': {\n                                borderColor: '#7B1FA2',\n                                backgroundColor: 'rgba(156, 39, 176, 0.04)'\n                            }\n                        }}\n                        disabled={isLoading}\n                    >\n                        Don't have an account? Register\n                    </Button>\n                    \n                    <Button\n                        onClick={() => setShowTestCredentials(!showTestCredentials)}\n                        fullWidth\n                        variant=\"text\"\n                        size=\"small\"\n                        sx={{ \n                            mt: 2,\n                            color: '#9C27B0'\n                        }}\n                        disabled={isLoading}\n                    >\n                        {showTestCredentials ? 'Hide Test Accounts' : 'Show Test Accounts'}\n                    </Button>\n                    \n                    {showTestCredentials && (\n                        <Box sx={{ \n                            mt: 2, \n                            p: 2, \n                            bgcolor: '#F5F8FA', \n                            borderRadius: '8px'\n                        }}>\n                            <Typography variant=\"subtitle2\" gutterBottom>\n                                Test Accounts (for development)\n                            </Typography>\n                            <Button \n                                size=\"small\" \n                                onClick={() => applyTestCredentials('admin')}\n                                sx={{ \n                                    color: '#9C27B0',\n                                    mr: 1\n                                }}\n                            >\n                                Use Admin Account\n                            </Button>\n                            <Button \n                                size=\"small\" \n                                onClick={() => applyTestCredentials('user')}\n                                sx={{ color: '#9C27B0' }}\n                            >\n                                Use User Account\n                            </Button>\n                            <Typography variant=\"caption\" display=\"block\" sx={{ mt: 1 }}>\n                                Admin: admin@example.com / adminpassword<br />\n                                User: user@example.com / userpassword\n                            </Typography>\n                        </Box>\n                    )}\n                </Box>\n            </Paper>\n        </Container>\n    );\n};\n\nexport default Login;\n","import React, { useState } from 'react';\nimport {\n    Box,\n    TextField,\n    Button,\n    Typography,\n    Container,\n    Paper,\n    Grid,\n    CircularProgress\n} from '@mui/material';\nimport { useNavigate } from 'react-router-dom';\nimport { registerUser, AuthResponse } from '../../services/api';\nimport { initializeSession } from '../../utils/sessionHandler';\n\nconst Register = () => {\n    const navigate = useNavigate();\n    const [formData, setFormData] = useState({\n        firstName: '',\n        lastName: '',\n        email: '',\n        password: '',\n        confirmPassword: ''\n    });\n    const [error, setError] = useState('');\n    const [loading, setLoading] = useState(false);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        setFormData({\n            ...formData,\n            [e.target.name]: e.target.value\n        });\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError('');\n        \n        // Validation\n        if (!formData.email || !formData.password) {\n            setError('Email and password are required');\n            return;\n        }\n\n        if (formData.password !== formData.confirmPassword) {\n            setError('Passwords do not match');\n            return;\n        }\n\n        if (formData.password.length < 6) {\n            setError('Password must be at least 6 characters long');\n            return;\n        }\n\n        setLoading(true);\n\n        try {\n            console.log(' Sending registration request with:', { email: formData.email });\n            \n            // Call the registration API and get full response\n            const response = await registerUser(formData.email, formData.password);\n            console.log(' Registration successful. User ID:', response.userId);\n            \n            // Store token and other user info - localStorage.setItem in registerUser already handles this\n            // Initialize session \n            initializeSession();\n            \n            // For better UX, you might want to navigate to a profile completion page\n            // or directly to the flights page\n            navigate('/flights');\n        } catch (error: any) {\n            console.error(' Registration failed:', error.message);\n            setError(error.message || 'Registration failed. Please try again.');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Container component=\"main\" maxWidth=\"xs\">\n            <Paper \n                elevation={3} \n                sx={{ \n                    p: 4, \n                    mt: 8,\n                    borderRadius: '8px',\n                    boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n                }}\n            >\n                <Box sx={{ \n                    p: 3, \n                    mb: 3, \n                    background: 'linear-gradient(45deg, #E33069 30%, #9C27B0 90%)',\n                    color: 'white',\n                    borderRadius: '8px',\n                    textAlign: 'center'\n                }}>\n                    <Typography component=\"h1\" variant=\"h5\">\n                        Create an Account\n                    </Typography>\n                </Box>\n                \n                {error && (\n                    <Typography \n                        color=\"error\" \n                        align=\"center\" \n                        sx={{ \n                            mt: 2,\n                            p: 1,\n                            borderRadius: '8px',\n                            bgcolor: 'rgba(244, 67, 54, 0.1)'\n                        }}\n                    >\n                        {error}\n                    </Typography>\n                )}\n                \n                <Box component=\"form\" onSubmit={handleSubmit} sx={{ mt: 3 }}>\n                    <Grid container spacing={2}>\n                        <Grid item xs={12} sm={6}>\n                            <TextField\n                                autoComplete=\"given-name\"\n                                fullWidth\n                                name=\"firstName\"\n                                label=\"First Name\"\n                                value={formData.firstName}\n                                onChange={handleChange}\n                                sx={{\n                                    '& .MuiOutlinedInput-root': {\n                                        borderRadius: '8px',\n                                        bgcolor: '#F5F8FA'\n                                    }\n                                }}\n                            />\n                        </Grid>\n                        <Grid item xs={12} sm={6}>\n                            <TextField\n                                autoComplete=\"family-name\"\n                                fullWidth\n                                name=\"lastName\"\n                                label=\"Last Name\"\n                                value={formData.lastName}\n                                onChange={handleChange}\n                                sx={{\n                                    '& .MuiOutlinedInput-root': {\n                                        borderRadius: '8px',\n                                        bgcolor: '#F5F8FA'\n                                    }\n                                }}\n                            />\n                        </Grid>\n                        <Grid item xs={12}>\n                            <TextField\n                                required\n                                fullWidth\n                                name=\"email\"\n                                label=\"Email Address\"\n                                type=\"email\"\n                                autoComplete=\"email\"\n                                value={formData.email}\n                                onChange={handleChange}\n                                sx={{\n                                    '& .MuiOutlinedInput-root': {\n                                        borderRadius: '8px',\n                                        bgcolor: '#F5F8FA'\n                                    }\n                                }}\n                            />\n                        </Grid>\n                        <Grid item xs={12}>\n                            <TextField\n                                required\n                                fullWidth\n                                name=\"password\"\n                                label=\"Password\"\n                                type=\"password\"\n                                autoComplete=\"new-password\"\n                                value={formData.password}\n                                onChange={handleChange}\n                                sx={{\n                                    '& .MuiOutlinedInput-root': {\n                                        borderRadius: '8px',\n                                        bgcolor: '#F5F8FA'\n                                    }\n                                }}\n                            />\n                        </Grid>\n                        <Grid item xs={12}>\n                            <TextField\n                                required\n                                fullWidth\n                                name=\"confirmPassword\"\n                                label=\"Confirm Password\"\n                                type=\"password\"\n                                autoComplete=\"new-password\"\n                                value={formData.confirmPassword}\n                                onChange={handleChange}\n                                error={formData.confirmPassword !== '' && formData.password !== formData.confirmPassword}\n                                helperText={formData.confirmPassword !== '' && formData.password !== formData.confirmPassword ? 'Passwords do not match' : ''}\n                                sx={{\n                                    '& .MuiOutlinedInput-root': {\n                                        borderRadius: '8px',\n                                        bgcolor: '#F5F8FA'\n                                    }\n                                }}\n                            />\n                        </Grid>\n                    </Grid>\n                    <Button\n                        type=\"submit\"\n                        fullWidth\n                        variant=\"contained\"\n                        sx={{ \n                            mt: 3, \n                            mb: 2,\n                            bgcolor: '#FF7F23',\n                            '&:hover': {\n                                bgcolor: '#E67D2E'\n                            },\n                            borderRadius: '8px'\n                        }}\n                        disabled={loading}\n                    >\n                        {loading ? <CircularProgress size={24} /> : 'Register'}\n                    </Button>\n                    <Button\n                        onClick={() => navigate('/login')}\n                        fullWidth\n                        variant=\"outlined\"\n                        sx={{ \n                            borderRadius: '8px',\n                            borderColor: '#9C27B0',\n                            color: '#9C27B0',\n                            '&:hover': {\n                                borderColor: '#7B1FA2',\n                                backgroundColor: 'rgba(156, 39, 176, 0.04)'\n                            }\n                        }}\n                    >\n                        Already have an account? Login\n                    </Button>\n                </Box>\n            </Paper>\n        </Container>\n    );\n};\n\nexport default Register;","/**\r\n * Utility functions for formatting data in the ticket booking system\r\n */\r\n\r\n/**\r\n * Format price with Indian Rupee symbol and thousands separators\r\n * @param price - Price in numerical format\r\n * @returns Formatted price string with currency symbol\r\n */\r\nexport const formatPrice = (price: number): string => {\r\n  return new Intl.NumberFormat('en-IN', {\r\n    style: 'currency',\r\n    currency: 'INR',\r\n    maximumFractionDigits: 0\r\n  }).format(price);\r\n};\r\n\r\n/**\r\n * Format date and time for display\r\n * @param dateString - ISO date string\r\n * @returns Formatted date and time string\r\n */\r\nexport const formatDate = (dateString: string): string => {\r\n  try {\r\n    const date = new Date(dateString);\r\n    return new Intl.DateTimeFormat('en-IN', {\r\n      dateStyle: 'medium',\r\n      timeStyle: 'short'\r\n    }).format(date);\r\n  } catch (error) {\r\n    console.error('Error formatting date:', error);\r\n    return dateString;\r\n  }\r\n};\r\n\r\n/**\r\n * Format date only (no time)\r\n * @param dateString - ISO date string\r\n * @returns Formatted date string\r\n */\r\nexport const formatDateOnly = (dateString: string): string => {\r\n  try {\r\n    const date = new Date(dateString);\r\n    return new Intl.DateTimeFormat('en-IN', {\r\n      dateStyle: 'medium'\r\n    }).format(date);\r\n  } catch (error) {\r\n    console.error('Error formatting date:', error);\r\n    return dateString;\r\n  }\r\n};\r\n\r\n/**\r\n * Format time only (no date)\r\n * @param dateString - ISO date string\r\n * @returns Formatted time string\r\n */\r\nexport const formatTimeOnly = (dateString: string): string => {\r\n  try {\r\n    const date = new Date(dateString);\r\n    return new Intl.DateTimeFormat('en-IN', {\r\n      timeStyle: 'short'\r\n    }).format(date);\r\n  } catch (error) {\r\n    console.error('Error formatting time:', error);\r\n    return dateString;\r\n  }\r\n};\r\n\r\n/**\r\n * Format flight duration from departure and arrival timestamps\r\n * @param departureTime - Departure ISO date string\r\n * @param arrivalTime - Arrival ISO date string\r\n * @returns Formatted duration string (e.g., \"2h 15m\")\r\n */\r\nexport const formatDuration = (departureTime: string, arrivalTime: string): string => {\r\n  try {\r\n    const departure = new Date(departureTime);\r\n    const arrival = new Date(arrivalTime);\r\n    \r\n    // Calculate duration in minutes\r\n    const durationInMinutes = (arrival.getTime() - departure.getTime()) / (1000 * 60);\r\n    \r\n    // Convert to hours and minutes\r\n    const hours = Math.floor(durationInMinutes / 60);\r\n    const minutes = Math.floor(durationInMinutes % 60);\r\n    \r\n    // Format the duration string\r\n    if (hours > 0) {\r\n      return `${hours}h ${minutes > 0 ? `${minutes}m` : ''}`;\r\n    } else {\r\n      return `${minutes}m`;\r\n    }\r\n  } catch (error) {\r\n    console.error('Error calculating duration:', error);\r\n    return 'N/A';\r\n  }\r\n};\r\n\r\n/**\r\n * Format a flight number with airline code and number\r\n * @param flightNumber - Raw flight number\r\n * @returns Formatted flight number\r\n */\r\nexport const formatFlightNumber = (flightNumber: string): string => {\r\n  // If the flight number already has a space, return as is\r\n  if (flightNumber.includes(' ')) {\r\n    return flightNumber;\r\n  }\r\n  \r\n  // Try to separate airline code and flight number\r\n  // Assuming airline code is 2 characters followed by numbers\r\n  const match = flightNumber.match(/^([A-Z0-9]{2})(\\d+)$/i);\r\n  \r\n  if (match) {\r\n    return `${match[1]} ${match[2]}`;\r\n  }\r\n  \r\n  return flightNumber;\r\n};\r\n\r\nexport default {\r\n  formatPrice,\r\n  formatDate,\r\n  formatDateOnly,\r\n  formatTimeOnly,\r\n  formatDuration,\r\n  formatFlightNumber\r\n}; ","import React from 'react';\r\n\r\ninterface HighlightTextProps {\r\n  text: string;\r\n  highlight: string;\r\n}\r\n\r\nconst HighlightText: React.FC<HighlightTextProps> = ({ text, highlight }) => {\r\n  if (!highlight.trim()) {\r\n    return <>{text}</>;\r\n  }\r\n\r\n  // Escape special regex characters in the search string\r\n  const searchValue = highlight.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n  \r\n  // Create regex that matches any part of highlight string (case insensitive)\r\n  const regex = new RegExp(`(${searchValue})`, 'gi');\r\n  \r\n  // Split on highlight term and include term in parts array\r\n  const parts = text.split(regex);\r\n\r\n  return (\r\n    <>\r\n      {parts.map((part, i) => {\r\n        // Check if this part matches the search term\r\n        const isMatch = part.toLowerCase() === highlight.toLowerCase();\r\n        \r\n        return isMatch ? (\r\n          <span key={i} style={{ fontWeight: 'bold', backgroundColor: 'rgba(255, 213, 79, 0.3)' }}>\r\n            {part}\r\n          </span>\r\n        ) : (\r\n          part\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default HighlightText; ","import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport {\r\n  TextField,\r\n  Box,\r\n  Typography,\r\n  Popper,\r\n  Paper,\r\n  ClickAwayListener,\r\n  CircularProgress,\r\n  InputAdornment,\r\n  IconButton,\r\n  Divider,\r\n  styled\r\n} from '@mui/material';\r\nimport CloseIcon from '@mui/icons-material/Close';\r\nimport SearchIcon from '@mui/icons-material/Search';\r\nimport HighlightText from './HighlightText';\r\n\r\n// API base URL\r\nconst API_BASE_URL = process.env.REACT_APP_BACKEND_URL || 'http://localhost:8080';\r\n\r\nexport interface Airport {\r\n  id: number;\r\n  code: string;\r\n  name: string;\r\n  city: string;\r\n  state?: string;\r\n  country: string;\r\n}\r\n\r\ninterface AirportAutocompleteProps {\r\n  label: string;\r\n  placeholder?: string;\r\n  value: string;\r\n  onChange: (value: string, airport?: Airport) => void;\r\n  disabled?: boolean;\r\n  required?: boolean;\r\n  error?: boolean;\r\n  helperText?: string;\r\n}\r\n\r\n// Styled components\r\nconst CodePill = styled(Box)(({ theme }) => ({\r\n  display: 'flex',\r\n  alignItems: 'center',\r\n  justifyContent: 'center',\r\n  minWidth: '48px',\r\n  height: '32px',\r\n  backgroundColor: '#f0f0f0',\r\n  borderRadius: '4px',\r\n  marginRight: theme.spacing(1.5),\r\n  padding: theme.spacing(0, 1),\r\n  fontWeight: 'bold'\r\n}));\r\n\r\nconst ResultItem = styled(Box)(({ theme }) => ({\r\n  padding: theme.spacing(1.5),\r\n  display: 'flex',\r\n  alignItems: 'flex-start',\r\n  cursor: 'pointer',\r\n  '&:hover': {\r\n    backgroundColor: theme.palette.action.hover\r\n  }\r\n}));\r\n\r\nconst AirportAutocomplete: React.FC<AirportAutocompleteProps> = ({\r\n  label,\r\n  placeholder,\r\n  value,\r\n  onChange,\r\n  disabled = false,\r\n  required = false,\r\n  error = false,\r\n  helperText,\r\n}) => {\r\n  const [open, setOpen] = useState(false);\r\n  const [options, setOptions] = useState<Airport[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [searchText, setSearchText] = useState('');\r\n  const [displayValue, setDisplayValue] = useState('');\r\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\r\n  const anchorRef = useRef<HTMLDivElement>(null);\r\n  \r\n  // Set initial display value based on input value\r\n  useEffect(() => {\r\n    if (!value) {\r\n      setDisplayValue('');\r\n      setSearchText('');\r\n    }\r\n  }, [value]);\r\n  \r\n  // Search airports function\r\n  const searchAirports = useCallback(async (query: string) => {\r\n    if (!query || query.length < 2) {\r\n      setOptions([]);\r\n      setOpen(false);\r\n      setErrorMessage(null);\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setErrorMessage(null);\r\n    \r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/api/airports/search?query=${encodeURIComponent(query)}`);\r\n      \r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        \r\n        setOptions(data);\r\n        setOpen(data.length > 0);\r\n        \r\n        if (data.length === 0) {\r\n          setErrorMessage('No airports found matching your search');\r\n        }\r\n      } else {\r\n        setOptions([]);\r\n        setOpen(false);\r\n        setErrorMessage(`Server error: ${response.status}`);\r\n      }\r\n    } catch (error) {\r\n      setOptions([]);\r\n      setOpen(false);\r\n      setErrorMessage('Connection error. Please try again.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n  \r\n  // Handle input change\r\n  const handleInputChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const newValue = event.target.value;\r\n    setSearchText(newValue);\r\n    setDisplayValue(newValue);\r\n    searchAirports(newValue);\r\n  };\r\n  \r\n  // Handle option selection\r\n  const handleOptionSelect = (airport: Airport) => {\r\n    const formattedValue = `${airport.code} - ${airport.city}`;\r\n    setDisplayValue(formattedValue);\r\n    setSearchText(formattedValue);\r\n    setOpen(false);\r\n    onChange(airport.code, airport);\r\n  };\r\n  \r\n  // Handle clearing the input\r\n  const handleClear = () => {\r\n    setDisplayValue('');\r\n    setSearchText('');\r\n    setOpen(false);\r\n    onChange('');\r\n  };\r\n  \r\n  // Close dropdown when clicking away\r\n  const handleClickAway = () => {\r\n    setOpen(false);\r\n  };\r\n  \r\n  // Format location display\r\n  const getLocationDisplay = (airport: Airport) => {\r\n    const parts = [];\r\n    if (airport.city) parts.push(airport.city);\r\n    if (airport.state) parts.push(airport.state);\r\n    if (airport.country) parts.push(airport.country);\r\n    return parts.join(', ');\r\n  };\r\n  \r\n  return (\r\n    <ClickAwayListener onClickAway={handleClickAway}>\r\n      <Box ref={anchorRef} sx={{ position: 'relative', width: '100%' }}>\r\n        <TextField\r\n          fullWidth\r\n          label={label}\r\n          placeholder={placeholder || 'Enter city, airport name, or code'}\r\n          value={displayValue}\r\n          onChange={handleInputChange}\r\n          onFocus={() => searchText.length >= 2 && searchAirports(searchText)}\r\n          disabled={disabled}\r\n          required={required}\r\n          error={!!errorMessage || error}\r\n          helperText={errorMessage || helperText}\r\n          InputProps={{\r\n            startAdornment: (\r\n              <InputAdornment position=\"start\">\r\n                <SearchIcon color=\"action\" />\r\n              </InputAdornment>\r\n            ),\r\n            endAdornment: displayValue ? (\r\n              <InputAdornment position=\"end\">\r\n                <IconButton \r\n                  aria-label=\"clear input\"\r\n                  onClick={handleClear}\r\n                  edge=\"end\"\r\n                  size=\"small\"\r\n                >\r\n                  <CloseIcon fontSize=\"small\" />\r\n                </IconButton>\r\n              </InputAdornment>\r\n            ) : null\r\n          }}\r\n        />\r\n        \r\n        <Popper\r\n          open={open}\r\n          anchorEl={anchorRef.current}\r\n          placement=\"bottom-start\"\r\n          style={{ width: anchorRef.current?.clientWidth, zIndex: 1301 }}\r\n        >\r\n          <Paper elevation={3} sx={{ maxHeight: 300, overflow: 'auto' }}>\r\n            {loading ? (\r\n              <Box sx={{ display: 'flex', justifyContent: 'center', p: 2 }}>\r\n                <CircularProgress size={24} />\r\n              </Box>\r\n            ) : (\r\n              options.map((airport) => (\r\n                <React.Fragment key={airport.id}>\r\n                  <ResultItem onClick={() => handleOptionSelect(airport)}>\r\n                    <CodePill>{airport.code}</CodePill>\r\n                    <Box sx={{ overflow: 'hidden' }}>\r\n                      <Typography variant=\"body1\" noWrap>\r\n                        <HighlightText \r\n                          text={`${airport.city}${airport.state ? ', ' + airport.state : ''}, ${airport.country}`} \r\n                          highlight={searchText} \r\n                        />\r\n                      </Typography>\r\n                      <Typography \r\n                        variant=\"body2\" \r\n                        color=\"text.secondary\" \r\n                        noWrap\r\n                        sx={{ mt: 0.5 }}\r\n                      >\r\n                        <HighlightText \r\n                          text={airport.name} \r\n                          highlight={searchText} \r\n                        />\r\n                      </Typography>\r\n                    </Box>\r\n                  </ResultItem>\r\n                  <Divider />\r\n                </React.Fragment>\r\n              ))\r\n            )}\r\n          </Paper>\r\n        </Popper>\r\n      </Box>\r\n    </ClickAwayListener>\r\n  );\r\n};\r\n\r\nexport default AirportAutocomplete; ","import { useNavigate } from 'react-router-dom';\nimport React, { useState, useEffect } from 'react';\nimport {\n    Container, Paper, Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Button,\n    TextField, Box, Typography, CircularProgress, Alert, Tooltip, Chip, LinearProgress, Skeleton,\n    Grid, Card, CardContent, CardActions, useMediaQuery, useTheme, Divider\n} from '@mui/material';\nimport { DatePicker } from '@mui/x-date-pickers/DatePicker';\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\nimport { AdapterMoment } from '@mui/x-date-pickers/AdapterMoment';\nimport moment, { Moment } from 'moment';\nimport axios from 'axios';\nimport FlightIcon from '@mui/icons-material/Flight';\nimport CloudIcon from '@mui/icons-material/Cloud';\nimport { formatPrice, formatDate } from '../../utils/formatters';\nimport { saveApiFlightToDatabase, Flight as ApiFlightType, Seat as ApiSeatType } from '../../services/api';\nimport AccessTimeIcon from '@mui/icons-material/AccessTime';\nimport ArrowRightAltIcon from '@mui/icons-material/ArrowRightAlt';\nimport AirlineSeatReclineNormalIcon from '@mui/icons-material/AirlineSeatReclineNormal';\nimport AttachMoneyIcon from '@mui/icons-material/AttachMoney';\nimport AirportAutocomplete, { Airport } from '../common/AirportAutocomplete';\nimport { getAirportByCode } from '../../services/api';\n\n// Local interfaces for the component\ninterface Seat {\n    id: number;\n    seatNumber: string;\n    available: boolean;\n}\n\ninterface Flight {\n    id: number;\n    flightNumber: string;\n    origin: string;\n    destination: string;\n    departureTime: string;\n    arrivalTime: string;\n    price: number;\n    seats: Seat[];\n    apiSourced?: boolean;\n    airline?: string;\n    availableSeats?: number;\n    status?: string;\n    originCity?: string;\n    originName?: string;\n    destinationCity?: string;\n    destinationName?: string;\n}\n\n// Function to convert local Flight to API Flight\nconst convertToApiFlightType = (flight: Flight): ApiFlightType => {\n    // Make sure the flight has all the required fields\n    console.log('Converting to API Flight type:', {\n        flightId: flight.id,\n        flightNumber: flight.flightNumber,\n        origin: flight.origin,\n        destination: flight.destination,\n        seatCount: flight.seats?.length,\n        apiSourced: flight.apiSourced\n    });\n    \n    // We'll only count the available seats, but not pass the full seat objects\n    // to avoid serialization issues with the backend\n    const availableSeatsCount = flight.seats.filter(seat => seat.available).length;\n    \n    // Create a minimal flight object with essential fields only\n    const apiFlightData: ApiFlightType = {\n        id: flight.id,\n        flightNumber: flight.flightNumber,\n        origin: flight.origin,\n        destination: flight.destination,\n        departureTime: flight.departureTime,\n        arrivalTime: flight.arrivalTime,\n        price: flight.price,\n        airline: flight.airline || 'Unknown Airline',\n        seats: [], // Empty seats array, let the backend create them\n        apiSourced: true // Explicitly set to true\n    };\n    \n    // Add availableSeats property - this will work with the API even if not in the TypeScript interface\n    (apiFlightData as any).availableSeats = availableSeatsCount;\n    \n    return apiFlightData;\n};\n\ninterface FlightListProps {\n    isAdminView?: boolean;\n}\n\n// Demo flights for when the API is not available\nconst demoFlights = [\n    {\n        id: 1001,\n        flightNumber: 'AI101',\n        airline: 'Air India',\n        origin: 'DEL',\n        destination: 'BOM',\n        departureTime: moment().add(1, 'day').set({ hour: 10, minute: 30 }).format(),\n        arrivalTime: moment().add(1, 'day').set({ hour: 12, minute: 30 }).format(),\n        price: 5500,\n        seats: Array(60).fill(null).map((_, i) => ({\n            id: i + 1,\n            seatNumber: `${String.fromCharCode(65 + Math.floor(i / 10))}${(i % 10) + 1}`,\n            available: Math.random() > 0.3\n        })),\n        apiSourced: false,\n        originCity: 'Delhi',\n        originName: 'Indira Gandhi International Airport',\n        destinationCity: 'Mumbai',\n        destinationName: 'Chhatrapati Shivaji Maharaj International Airport'\n    },\n    {\n        id: 1002,\n        flightNumber: 'SG202',\n        airline: 'SpiceJet',\n        origin: 'BLR',\n        destination: 'MAA',\n        departureTime: moment().add(1, 'day').set({ hour: 14, minute: 45 }).format(),\n        arrivalTime: moment().add(1, 'day').set({ hour: 16, minute: 0 }).format(),\n        price: 3200,\n        seats: Array(60).fill(null).map((_, i) => ({\n            id: i + 1,\n            seatNumber: `${String.fromCharCode(65 + Math.floor(i / 10))}${(i % 10) + 1}`,\n            available: Math.random() > 0.3\n        })),\n        apiSourced: false,\n        originCity: 'Bangalore',\n        originName: 'Kempegowda International Airport',\n        destinationCity: 'Chennai',\n        destinationName: 'Chennai International Airport'\n    },\n    {\n        id: 1003,\n        flightNumber: 'UK303',\n        airline: 'Vistara',\n        origin: 'BOM',\n        destination: 'CCU',\n        departureTime: moment().add(2, 'day').set({ hour: 9, minute: 15 }).format(),\n        arrivalTime: moment().add(2, 'day').set({ hour: 11, minute: 45 }).format(),\n        price: 6800,\n        seats: Array(60).fill(null).map((_, i) => ({\n            id: i + 1,\n            seatNumber: `${String.fromCharCode(65 + Math.floor(i / 10))}${(i % 10) + 1}`,\n            available: Math.random() > 0.3\n        })),\n        apiSourced: false,\n        originCity: 'Mumbai',\n        originName: 'Chhatrapati Shivaji Maharaj International Airport',\n        destinationCity: 'Kolkata',\n        destinationName: 'Netaji Subhas Chandra Bose International Airport'\n    },\n    {\n        id: 1004,\n        flightNumber: 'DM130',\n        airline: 'Demo Air',\n        origin: 'BOM',\n        destination: 'BLR',\n        departureTime: moment().add(3, 'day').set({ hour: 8, minute: 17 }).format(),\n        arrivalTime: moment().add(3, 'day').set({ hour: 9, minute: 17 }).format(),\n        price: 5656,\n        seats: Array(60).fill(null).map((_, i) => ({\n            id: i + 1,\n            seatNumber: `${String.fromCharCode(65 + Math.floor(i / 10))}${(i % 10) + 1}`,\n            available: Math.random() > 0.3\n        })),\n        apiSourced: false,\n        originCity: 'Mumbai',\n        originName: 'Chhatrapati Shivaji Maharaj International Airport',\n        destinationCity: 'Bangalore',\n        destinationName: 'Kempegowda International Airport'\n    }\n];\n\nconst FlightList = ({ isAdminView = false }: FlightListProps) => {\n    const navigate = useNavigate();\n    const [searchDate, setSearchDate] = useState<Moment | null>(moment().add(1, 'days')); // Default to tomorrow\n    const [origin, setOrigin] = useState('');\n    const [originAirport, setOriginAirport] = useState<Airport | undefined>(undefined);\n    const [destination, setDestination] = useState('');\n    const [destinationAirport, setDestinationAirport] = useState<Airport | undefined>(undefined);\n    const [flights, setFlights] = useState<Flight[]>([]);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState('');\n    const [isSearching, setIsSearching] = useState(false);\n    const [apiAvailable, setApiAvailable] = useState(true);\n    const [searchAttempted, setSearchAttempted] = useState(false);\n    const [bookingInProgress, setBookingInProgress] = useState<number | null>(null);\n\n    const theme = useTheme();\n    const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\n    const isTablet = useMediaQuery(theme.breakpoints.between('sm', 'md'));\n\n    const handleSearch = async () => {\n        if (!origin || !destination || !searchDate) {\n            setError('Please fill in all search fields');\n            return;\n        }\n\n        // Validate search date is not in the past\n        if (searchDate.isBefore(moment().startOf('day'))) {\n            setError('Cannot search for flights in the past');\n            return;\n        }\n\n        setError('');\n        setIsSearching(true);\n        setSearchAttempted(true);\n        \n        try {\n            const token = localStorage.getItem('token');\n            if (!token) throw new Error('Authentication required');\n            \n            try {\n                // Try to use the actual API\n                const response = await axios.get(`http://localhost:8080/api/flights/search`, {\n                    params: {\n                        origin: origin,\n                        destination: destination,\n                        departureDate: searchDate.format('YYYY-MM-DD')\n                    },\n                    headers: {\n                        'Authorization': `Bearer ${token}`\n                    }\n                });\n                \n                // Process API response to include airport details\n                const processedData = await Promise.all(response.data.map(async (flight: any) => {\n                    // Enrich with airport details if missing\n                    const enrichedFlight = {\n                        ...flight,\n                        apiSourced: flight.apiSourced !== undefined ? flight.apiSourced : true\n                    };\n                    \n                    // Get origin airport details if needed\n                    if (!flight.originCity || !flight.originName) {\n                        try {\n                            const originAirport = await getAirportByCode(flight.origin);\n                            if (originAirport) {\n                                enrichedFlight.originCity = originAirport.city;\n                                enrichedFlight.originName = originAirport.name;\n                            }\n                        } catch (err) {\n                            console.warn(`Could not fetch details for origin airport ${flight.origin}`, err);\n                        }\n                    }\n                    \n                    // Get destination airport details if needed\n                    if (!flight.destinationCity || !flight.destinationName) {\n                        try {\n                            const destinationAirport = await getAirportByCode(flight.destination);\n                            if (destinationAirport) {\n                                enrichedFlight.destinationCity = destinationAirport.city;\n                                enrichedFlight.destinationName = destinationAirport.name;\n                            }\n                        } catch (err) {\n                            console.warn(`Could not fetch details for destination airport ${flight.destination}`, err);\n                        }\n                    }\n                    \n                    return enrichedFlight;\n                }));\n                \n                if (processedData.length > 0) {\n                    // We got actual flights from the API or database\n                    setFlights(processedData);\n                    setApiAvailable(true);\n                } else {\n                    // No flights found in database, use demo flights as fallback\n                    console.log('No flights found in database, using demo flights as fallback');\n                    setApiAvailable(false);\n                    \n                    // Filter demo flights for search\n                    const filteredFlights = demoFlights.filter(flight => \n                        flight.origin.toLowerCase().includes(origin.toLowerCase()) &&\n                        flight.destination.toLowerCase().includes(destination.toLowerCase()) &&\n                        moment(flight.departureTime).isSame(searchDate, 'day')\n                    );\n                    \n                    if (filteredFlights.length === 0) {\n                        // Create a new demo flight with the search parameters if no matches\n                        const originCode = originAirport ? originAirport.code : origin.toUpperCase();\n                        const destinationCode = destinationAirport ? destinationAirport.code : destination.toUpperCase();\n                        \n                        const newDemoFlight = {\n                            id: Math.floor(Math.random() * 10000) + 2000,\n                            flightNumber: `DM${Math.floor(Math.random() * 900) + 100}`,\n                            airline: ['Air India', 'IndiGo', 'SpiceJet', 'Vistara', 'GoAir'][Math.floor(Math.random() * 5)],\n                            origin: originCode,\n                            destination: destinationCode,\n                            departureTime: searchDate.clone().set({ hour: Math.floor(Math.random() * 12) + 6, minute: [0, 15, 30, 45][Math.floor(Math.random() * 4)] }).format(),\n                            arrivalTime: searchDate.clone().set({ hour: Math.floor(Math.random() * 12) + 6, minute: [0, 15, 30, 45][Math.floor(Math.random() * 4)] }).add(Math.floor(Math.random() * 3) + 1, 'hours').format(),\n                            price: Math.floor(Math.random() * 8000) + 3000,\n                            seats: Array(60).fill(null).map((_, i) => ({\n                                id: i + 1,\n                                seatNumber: `${String.fromCharCode(65 + Math.floor(i / 10))}${(i % 10) + 1}`,\n                                available: Math.random() > 0.3\n                            })),\n                            apiSourced: false,\n                            // Add airport info\n                            originCity: originAirport ? originAirport.city : origin,\n                            originName: originAirport ? originAirport.name : `${origin} Airport`,\n                            destinationCity: destinationAirport ? destinationAirport.city : destination,\n                            destinationName: destinationAirport ? destinationAirport.name : `${destination} Airport`\n                        };\n                        \n                        setFlights([newDemoFlight]);\n                    } else {\n                        setFlights(filteredFlights);\n                    }\n                }\n            } catch (error) {\n                console.error('API error:', error);\n                setApiAvailable(false);\n                \n                // Filter demo flights as fallback\n                const filteredFlights = demoFlights.filter(flight => \n                    flight.origin.toLowerCase().includes(origin.toLowerCase()) &&\n                    flight.destination.toLowerCase().includes(destination.toLowerCase()) &&\n                    moment(flight.departureTime).isSame(searchDate, 'day')\n                );\n                \n                if (filteredFlights.length === 0) {\n                    // Create a new demo flight with the search parameters if no matches\n                    const originCode = originAirport ? originAirport.code : origin.toUpperCase();\n                    const destinationCode = destinationAirport ? destinationAirport.code : destination.toUpperCase();\n                    \n                    const newDemoFlight = {\n                        id: Math.floor(Math.random() * 10000) + 2000,\n                        flightNumber: `DM${Math.floor(Math.random() * 900) + 100}`,\n                        airline: ['Air India', 'IndiGo', 'SpiceJet', 'Vistara', 'GoAir'][Math.floor(Math.random() * 5)],\n                        origin: originCode,\n                        destination: destinationCode,\n                        departureTime: searchDate.clone().set({ hour: Math.floor(Math.random() * 12) + 6, minute: [0, 15, 30, 45][Math.floor(Math.random() * 4)] }).format(),\n                        arrivalTime: searchDate.clone().set({ hour: Math.floor(Math.random() * 12) + 6, minute: [0, 15, 30, 45][Math.floor(Math.random() * 4)] }).add(Math.floor(Math.random() * 3) + 1, 'hours').format(),\n                        price: Math.floor(Math.random() * 8000) + 3000,\n                        seats: Array(60).fill(null).map((_, i) => ({\n                            id: i + 1,\n                            seatNumber: `${String.fromCharCode(65 + Math.floor(i / 10))}${(i % 10) + 1}`,\n                            available: Math.random() > 0.3\n                        })),\n                        apiSourced: false,\n                        // Add airport info\n                        originCity: originAirport ? originAirport.city : origin,\n                        originName: originAirport ? originAirport.name : `${origin} Airport`,\n                        destinationCity: destinationAirport ? destinationAirport.city : destination,\n                        destinationName: destinationAirport ? destinationAirport.name : `${destination} Airport`\n                    };\n                    \n                    setFlights([newDemoFlight]);\n                } else {\n                    setFlights(filteredFlights);\n                }\n            }\n        } catch (err: any) {\n            console.error('Error during search:', err);\n            setError(err.message || 'Error during search');\n            setFlights([]);\n        } finally {\n            setIsSearching(false);\n        }\n    };\n\n    const handleBooking = async (flightId: number) => {\n        try {\n            const flight = flights.find(f => f.id === flightId);\n            if (!flight) {\n                setError('Flight not found');\n                return;\n            }\n            \n            // Check if flight has already departed\n            if (moment(flight.departureTime).isBefore(moment())) {\n                setError(`Cannot book flight ${flight.flightNumber} as it has already departed.`);\n                return;\n            }\n            \n            if (!flight.seats || flight.seats.filter(s => s.available).length === 0) {\n                setError('No seats available for this flight');\n                return;\n            }\n\n            // Set booking in progress for this flight\n            setBookingInProgress(flightId);\n            setError('');\n            \n            console.log('Starting booking process for flight:', {\n                flightId: flight.id,\n                flightNumber: flight.flightNumber,\n                apiSourced: flight.apiSourced\n            });\n\n            // If the flight is from the API, we need to save it to the database first\n            if (flight.apiSourced) {\n                try {\n                    const token = localStorage.getItem('token');\n                    if (!token) {\n                        throw new Error('Authentication required');\n                    }\n\n                    console.log('Flight is API-sourced, saving to database first');\n                    \n                    // Convert to API Flight type and save to database\n                    const apiFlightData = convertToApiFlightType(flight);\n                    \n                    // Add a timeout to ensure we don't wait forever\n                    const timeoutPromise = new Promise<never>((_, reject) => {\n                        setTimeout(() => reject(new Error('Request timed out after 15 seconds')), 15000);\n                    });\n                    \n                    // Race between the API call and the timeout\n                    const savedFlight = await Promise.race([\n                        saveApiFlightToDatabase(apiFlightData, token),\n                        timeoutPromise\n                    ]) as ApiFlightType;\n                    \n                    console.log('Successfully saved API flight, navigating to seat selection:', savedFlight);\n                    \n                    // Navigate to the seat selection page using the new database ID\n                    navigate(`/flights/${savedFlight.id}/seats`);\n                } catch (error) {\n                    console.error('Error saving API flight:', error);\n                    let errorMessage = 'Failed to prepare flight for booking.';\n                    \n                    if (error instanceof Error) {\n                        if (error.message.includes('timed out')) {\n                            errorMessage = 'Request timed out. Please try again later.';\n                        } else if (error.message.includes('401') || error.message.includes('Authentication')) {\n                            errorMessage = 'Authentication error. Please log in again.';\n                        } else if (error.message.includes('403')) {\n                            errorMessage = 'You do not have permission to perform this action.';\n                        } else if (error.message.includes('404')) {\n                            errorMessage = 'The flight data could not be saved. Flight not found.';\n                        } else if (error.message.includes('500')) {\n                            errorMessage = 'Server error. Please try again later.';\n                        } else {\n                            errorMessage = `Failed to prepare flight for booking: ${error.message}`;\n                        }\n                    }\n                    \n                    setError(errorMessage);\n                    setBookingInProgress(null);\n                }\n            } else {\n                // For non-API flights, navigate directly to seat selection\n                console.log('Flight is not API-sourced, navigating directly to seat selection');\n                navigate(`/flights/${flightId}/seats`);\n            }\n        } catch (err) {\n            console.error('Booking error:', err);\n            if (err instanceof Error) {\n                setError(`Booking error: ${err.message}`);\n            } else {\n                setError('An error occurred during booking');\n            }\n        } finally {\n            setBookingInProgress(null);\n        }\n    };\n\n    const getAvailableSeatsCount = (flight: Flight) => {\n        return flight.seats ? flight.seats.filter(seat => seat.available).length : 0;\n    };\n\n    // Check if flight is departing soon (within 2 hours)\n    const isDepartingSoon = (departureTime: string) => {\n        const departure = moment(departureTime);\n        const now = moment();\n        const hoursDiff = departure.diff(now, 'hours');\n        return hoursDiff >= 0 && hoursDiff <= 2;\n    };\n\n    // Function to get flight status display\n    const getFlightStatus = (flight: Flight) => {\n        // First check if the flight has a status from the server\n        if (flight.status) {\n            switch (flight.status) {\n                case 'SCHEDULED':\n                    return <Chip label=\"Scheduled\" color=\"primary\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n                case 'IN_FLIGHT':\n                    return <Chip label=\"In Flight\" color=\"info\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n                case 'ARRIVED':\n                    return <Chip label=\"Arrived\" color=\"success\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n                case 'DELAYED':\n                    return <Chip label=\"Delayed\" color=\"warning\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n                case 'CANCELLED':\n                    return <Chip label=\"Cancelled\" color=\"error\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n                default:\n                    // Fall back to the time-based logic for unknown statuses\n                    break;\n            }\n        }\n        \n        // Fall back to the existing time-based logic if no status is provided\n        const departureTime = moment(flight.departureTime);\n        const now = moment();\n        \n        // Check if flight has already departed\n        if (departureTime.isBefore(now)) {\n            return <Chip label=\"Departed\" color=\"default\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n        }\n        \n        // Check if flight is departing soon (within 2 hours)\n        if (isDepartingSoon(flight.departureTime)) {\n            return <Chip label=\"Departing Soon\" color=\"warning\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n        }\n        \n        const availableSeats = getAvailableSeatsCount(flight);\n        const totalSeats = flight.seats ? flight.seats.length : 0;\n        \n        if (totalSeats === 0) {\n            return <Chip label=\"Unknown\" color=\"default\" size=\"small\" />;\n        } else if (availableSeats === 0) {\n            return <Chip label=\"Sold Out\" color=\"error\" size=\"small\" />;\n        } else if (availableSeats < totalSeats * 0.2) {\n            return <Chip label=\"Almost Full\" color=\"error\" size=\"small\" />;\n        } else if (availableSeats < totalSeats * 0.5) {\n            return <Chip label=\"Filling Up\" color=\"warning\" size=\"small\" />;\n        } else {\n            return <Chip label=\"Available\" color=\"success\" size=\"small\" />;\n        }\n    };\n\n    // Function to get flight source icon and tooltip\n    const getFlightSourceInfo = (flight: Flight) => {\n        if (flight.apiSourced) {\n            return (\n                <Tooltip title=\"External API sourced flight\">\n                    <CloudIcon color=\"info\" />\n                </Tooltip>\n            );\n        } else {\n            return (\n                <Tooltip title=\"Internal database flight\">\n                    <Box component=\"span\" sx={{ display: 'inline-flex' }}>\n                        <FlightIcon color=\"primary\" />\n                    </Box>\n                </Tooltip>\n            );\n        }\n    };\n\n    // Function to format flight duration\n    const calculateDuration = (departureTime: string, arrivalTime: string) => {\n        const start = moment(departureTime);\n        const end = moment(arrivalTime);\n        const duration = moment.duration(end.diff(start));\n        const hours = Math.floor(duration.asHours());\n        const minutes = duration.minutes();\n        \n        return `${hours}h ${minutes}m`;\n    };\n\n    // Handle airport selection for origin\n    const handleOriginChange = (value: string, airport?: Airport) => {\n        setOrigin(value);\n        setOriginAirport(airport);\n    };\n\n    // Handle airport selection for destination\n    const handleDestinationChange = (value: string, airport?: Airport) => {\n        setDestination(value);\n        setDestinationAirport(airport);\n    };\n\n    // Add helper functions to format airport display\n    const getAirportDisplayShort = (code: string, city?: string) => {\n        if (city) {\n            return `${code} - ${city}`;\n        }\n        return code;\n    };\n\n    const getAirportDisplayLong = (code: string, city?: string, name?: string) => {\n        if (city && name) {\n            return `${code} - ${city} (${name})`;\n        } else if (city) {\n            return `${code} - ${city}`;\n        }\n        return code;\n    };\n\n    return (\n        <Container maxWidth={isAdminView ? false : \"lg\"} className=\"flight-list\">\n            <Box sx={{ py: 4 }}>\n                {!isAdminView && (\n                    <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n                        Find your perfect flight\n                    </Typography>\n                )}\n                \n                {error && <Alert severity=\"error\" sx={{ mb: 3, borderRadius: '8px' }}>{error}</Alert>}\n                \n                {/* Search Form */}\n                <Grid container spacing={2} sx={{ mb: 4 }}>\n                    <Grid item xs={12} sm={4}>\n                    <AirportAutocomplete \n                        label=\"From\" \n                        value={origin} \n                        onChange={handleOriginChange}\n                        placeholder=\"City or airport code\"\n                        required\n                    />\n                    </Grid>\n                    <Grid item xs={12} sm={4}>\n                    <AirportAutocomplete \n                        label=\"To\" \n                        value={destination} \n                        onChange={handleDestinationChange}\n                        placeholder=\"City or airport code\"\n                        required\n                    />\n                    </Grid>\n                    <Grid item xs={12} sm={4}>\n                    <LocalizationProvider dateAdapter={AdapterMoment}>\n                        <DatePicker \n                            label=\"Date\" \n                            value={searchDate} \n                            onChange={(newValue) => setSearchDate(newValue)}\n                                slotProps={{ \n                                    textField: { \n                                        fullWidth: true,\n                                        size: isMobile ? \"small\" : \"medium\",\n                                        sx: {\n                                            '& .MuiOutlinedInput-root': {\n                                                borderRadius: '8px',\n                                                bgcolor: '#F5F8FA'\n                                            }\n                                        }\n                                    } \n                                }}\n                        />\n                    </LocalizationProvider>\n                    </Grid>\n                    <Grid item xs={12}>\n                    <Button \n                        variant=\"contained\" \n                            color=\"primary\"\n                        onClick={handleSearch}\n                            disabled={isSearching}\n                            fullWidth={isMobile}\n                            sx={{ \n                                mt: 1,\n                                bgcolor: '#FF7F23',\n                                '&:hover': {\n                                    bgcolor: '#E67D2E'\n                                },\n                                borderRadius: '8px'\n                            }}\n                    >\n                            {isSearching ? 'Searching...' : 'Search Flights'}\n                    </Button>\n                    </Grid>\n                </Grid>\n                \n                {isSearching && <LinearProgress sx={{ mb: 3, borderRadius: '4px' }} />}\n                \n                {/* Flight Results */}\n                {searchAttempted && !isSearching && flights.length === 0 && (\n                    <Alert severity=\"info\" sx={{ borderRadius: '8px' }}>\n                        No flights found for your search criteria. Please try different dates or locations.\n                    </Alert>\n                )}\n                \n                {flights.length > 0 && (\n                    <>\n                        <Typography variant=\"h6\" gutterBottom>\n                            {flights.length} {flights.length === 1 ? 'Flight' : 'Flights'} Available\n                        </Typography>\n                        \n                        {/* Mobile/Tablet Card View */}\n                        {(isMobile || isTablet) && (\n                            <Grid container spacing={2}>\n                                {flights.map((flight) => (\n                                    <Grid item xs={12} key={flight.id}>\n                                        <Card \n                                            elevation={0}\n                                            sx={{ \n                                                mb: 2,\n                                                transition: 'transform 0.2s',\n                                                borderRadius: '8px',\n                                                boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)',\n                                                p: '0.25rem',\n                                                '&:hover': {\n                                                    transform: 'translateY(-4px)',\n                                                    boxShadow: '0px 6px 12px rgba(0, 0, 0, 0.15)'\n                                                }\n                                            }}\n                                        >\n                                            <CardContent sx={{ pb: 1, p: '1.25rem' }}>\n                                                <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n                                                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                                                        <FlightIcon \n                                                            sx={{ \n                                                                mr: 1, \n                                                                color: '#E33069',\n                                                                transform: 'rotate(45deg)'\n                                                            }} \n                                                        />\n                                                        <Typography variant=\"subtitle1\" fontWeight=\"bold\">\n                                                            {flight.airline} {flight.flightNumber}\n                                                        </Typography>\n                                                    </Box>\n                                                    {getFlightStatus(flight)}\n                                                </Box>\n                                                \n                                                <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 2 }}>\n                                                    <Box>\n                                                        <Typography variant=\"h6\">{getAirportDisplayShort(flight.origin, flight.originCity)}</Typography>\n                                                        <Typography variant=\"body2\" color=\"text.secondary\">\n                                                            {moment(flight.departureTime).format('h:mm A')}\n                                                        </Typography>\n                                                        <Typography variant=\"caption\" color=\"text.secondary\">\n                                                            {moment(flight.departureTime).format('MMM D, YYYY')}\n                                                        </Typography>\n                                                    </Box>\n                                                    \n                                                    <Box sx={{ display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center' }}>\n                                                        <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mb: 0.5 }}>\n                                                            {calculateDuration(flight.departureTime, flight.arrivalTime)}\n                                                        </Typography>\n                                                        <Box sx={{ display: 'flex', alignItems: 'center', width: '100%' }}>\n                                                            <Box sx={{ height: 1, bgcolor: 'grey.400', flex: 1 }} />\n                                                            <ArrowRightAltIcon sx={{ color: '#9C27B0', mx: 0.5 }} />\n                                                            <Box sx={{ height: 1, bgcolor: 'grey.400', flex: 1 }} />\n                                                        </Box>\n                                                    </Box>\n                                                    \n                                                    <Box sx={{ textAlign: 'right' }}>\n                                                        <Typography variant=\"h6\">{getAirportDisplayShort(flight.destination, flight.destinationCity)}</Typography>\n                                                        <Typography variant=\"body2\" color=\"text.secondary\">\n                                                            {moment(flight.arrivalTime).format('h:mm A')}\n                                                        </Typography>\n                                                        <Typography variant=\"caption\" color=\"text.secondary\">\n                                                            {moment(flight.arrivalTime).format('MMM D, YYYY')}\n                                                        </Typography>\n                                                    </Box>\n                </Box>\n                                                \n                                                <Divider sx={{ my: 1 }} />\n                                                \n                                                <Grid container spacing={1} sx={{ mt: 1 }}>\n                                                    <Grid item xs={6}>\n                                                        <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                                                            <AirlineSeatReclineNormalIcon fontSize=\"small\" sx={{ mr: 0.5, color: '#9C27B0' }} />\n                                                            <Typography variant=\"body2\">\n                                                                {getAvailableSeatsCount(flight)} seats available\n                                                            </Typography>\n                                                        </Box>\n                                                    </Grid>\n                                                    <Grid item xs={6}>\n                                                        <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'flex-end' }}>\n                                                            <AttachMoneyIcon fontSize=\"small\" sx={{ mr: 0.5, color: '#FF7F23' }} />\n                                                            <Typography variant=\"h6\" color=\"#FF7F23\">\n                                                                {formatPrice(flight.price)}\n                                                            </Typography>\n                </Box>\n                                                    </Grid>\n                                                </Grid>\n                                            </CardContent>\n                                            \n                                            <CardActions sx={{ px: '1.25rem', pb: '1.25rem', pt: 0 }}>\n                                                <Button\n                                                    variant=\"contained\"\n                                                    fullWidth\n                                                    onClick={() => handleBooking(flight.id)}\n                                                    disabled={bookingInProgress === flight.id}\n                                                    sx={{\n                                                        bgcolor: '#FF7F23',\n                                                        '&:hover': {\n                                                            bgcolor: '#E67D2E'\n                                                        },\n                                                        borderRadius: '8px'\n                                                    }}\n                                                >\n                                                    {bookingInProgress === flight.id ? 'Processing...' : 'Select Flight'}\n                                                </Button>\n                                            </CardActions>\n                                        </Card>\n                                    </Grid>\n                                ))}\n                            </Grid>\n                        )}\n                        \n                        {/* Desktop Table View */}\n                        {!isMobile && !isTablet && (\n                            <TableContainer component={Paper} variant=\"outlined\" sx={{ mt: 2, borderRadius: '8px', boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)' }}>\n                                <Table aria-label=\"flights table\">\n                                    <TableHead sx={{ bgcolor: '#F5F8FA' }}>\n                            <TableRow>\n                                <TableCell>Flight Number</TableCell>\n                                <TableCell>From</TableCell>\n                                <TableCell>To</TableCell>\n                                <TableCell>Departure</TableCell>\n                                <TableCell>Arrival</TableCell>\n                                <TableCell>Price (INR)</TableCell>\n                                <TableCell>Available Seats</TableCell>\n                                <TableCell>Status</TableCell>\n                                <TableCell>Source</TableCell>\n                                <TableCell>Action</TableCell>\n                            </TableRow>\n                        </TableHead>\n                        <TableBody>\n                                        {flights.map((flight) => (\n                                            <TableRow \n                                                key={flight.id}\n                                                hover\n                                                sx={{\n                                                    transition: 'background-color 0.2s',\n                                                    '&:hover': {\n                                                        backgroundColor: 'rgba(0, 0, 0, 0.04)'\n                                                    }\n                                                }}\n                                            >\n                                        <TableCell>\n                                                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                                                        <FlightIcon \n                                                            sx={{ \n                                                                mr: 1, \n                                                                color: '#E33069',\n                                                                transform: 'rotate(45deg)'\n                                                            }} \n                                                        />\n                                                        <Box>\n                                                            <Typography variant=\"body2\" fontWeight=\"bold\">\n                                            {flight.flightNumber}\n                                                            </Typography>\n                                                            <Typography variant=\"caption\" color=\"text.secondary\">\n                                                    {flight.airline}\n                                                </Typography>\n                                                        </Box>\n                                                    </Box>\n                                        </TableCell>\n                                        <TableCell>\n                                            <Typography variant=\"body2\" fontWeight=\"medium\">\n                                                {getAirportDisplayShort(flight.origin, flight.originCity)}\n                                            </Typography>\n                                            {flight.originName && (\n                                                <Typography variant=\"caption\" color=\"text.secondary\" display=\"block\">\n                                                    {flight.originName}\n                                                </Typography>\n                                            )}\n                                        </TableCell>\n                                        <TableCell>\n                                            <Typography variant=\"body2\" fontWeight=\"medium\">\n                                                {getAirportDisplayShort(flight.destination, flight.destinationCity)}\n                                            </Typography>\n                                            {flight.destinationName && (\n                                                <Typography variant=\"caption\" color=\"text.secondary\" display=\"block\">\n                                                    {flight.destinationName}\n                                                </Typography>\n                                            )}\n                                        </TableCell>\n                                        <TableCell>\n                                                    <Typography variant=\"body2\">\n                                                        {moment(flight.departureTime).format('MMM D, YYYY')}\n                                                    </Typography>\n                                                    <Typography variant=\"body2\" fontWeight=\"bold\">\n                                                        {moment(flight.departureTime).format('h:mm A')}\n                                                    </Typography>\n                                        </TableCell>\n                                        <TableCell>\n                                                    <Typography variant=\"body2\">\n                                                        {moment(flight.arrivalTime).format('MMM D, YYYY')}\n                                                    </Typography>\n                                                    <Typography variant=\"body2\" fontWeight=\"bold\">\n                                                        {moment(flight.arrivalTime).format('h:mm A')}\n                                                    </Typography>\n                                        </TableCell>\n                                        <TableCell>\n                                                    <Typography variant=\"body2\" fontWeight=\"bold\" color=\"#FF7F23\">\n                                                        {formatPrice(flight.price)}\n                                                    </Typography>\n                                                </TableCell>\n                                                <TableCell>{getAvailableSeatsCount(flight)}</TableCell>\n                                                <TableCell>{getFlightStatus(flight)}</TableCell>\n                                                <TableCell>{getFlightSourceInfo(flight)}</TableCell>\n                                                <TableCell>\n                                                    <Button \n                                                        variant=\"contained\" \n                                                        size=\"small\"\n                                                        onClick={() => handleBooking(flight.id)}\n                                                        disabled={bookingInProgress === flight.id}\n                                                        sx={{\n                                                            bgcolor: '#FF7F23',\n                                                            '&:hover': {\n                                                                bgcolor: '#E67D2E'\n                                                            },\n                                                            borderRadius: '8px'\n                                                        }}\n                                                    >\n                                                        {bookingInProgress === flight.id ? 'Processing...' : 'Select'}\n                                                    </Button>\n                                        </TableCell>\n                                    </TableRow>\n                                        ))}\n                        </TableBody>\n                    </Table>\n                </TableContainer>\n                        )}\n                    </>\n            )}\n            </Box>\n        </Container>\n    );\n};\n\nexport default FlightList;","import { Client } from '@stomp/stompjs';\r\nimport SockJS from 'sockjs-client';\r\n\r\nexport interface SeatUpdate {\r\n    flightId: number;\r\n    seatId: number;\r\n    available: boolean;\r\n    status: string;\r\n    timestamp: number;\r\n}\r\n\r\nexport interface SeatSelectionRequest {\r\n    seatId: number;\r\n    flightId: number;\r\n    userId?: string; // Optional user ID\r\n}\r\n\r\nclass WebSocketService {\r\n    private client: Client | null = null;\r\n    private subscriptions = new Map<string, { subscription: any; callback: Function }>();\r\n    private connectionPromise: Promise<void> | null = null;\r\n    private reconnectAttempts = 0;\r\n    private maxReconnectAttempts = 10;\r\n    private reconnectDelay = 1000;\r\n    private _connected = false;\r\n    private userId: string;\r\n\r\n    constructor() {\r\n        // Generate or retrieve a user-specific ID that's consistent across tabs/browsers\r\n        // First try to get the user ID from the token\r\n        const token = localStorage.getItem('token');\r\n        const tokenUserId = this.getUserIdFromToken(token);\r\n        \r\n        // If we have a user ID from token, use that as base\r\n        if (tokenUserId) {\r\n            // Create a consistent ID based on the actual user ID from token\r\n            this.userId = `auth_user_${tokenUserId}`;\r\n            localStorage.setItem('websocket_user_id', this.userId);\r\n            console.log('[WebSocket] Using authenticated user ID:', this.userId);\r\n        } else {\r\n            // Fall back to the stored ID or generate a new one\r\n            const storedUserId = localStorage.getItem('websocket_user_id');\r\n            if (storedUserId) {\r\n                this.userId = storedUserId;\r\n            } else {\r\n                // Generate random ID as fallback\r\n                this.userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substring(2, 9);\r\n                localStorage.setItem('websocket_user_id', this.userId);\r\n            }\r\n            console.log('[WebSocket] Using anonymous user ID:', this.userId);\r\n        }\r\n        \r\n        this.initializeConnection();\r\n        \r\n        // Set up listener for auth changes to update user ID\r\n        window.addEventListener('storage', (event) => {\r\n            if (event.key === 'token') {\r\n                this.updateUserIdFromToken();\r\n            }\r\n        });\r\n    }\r\n    \r\n    // Get user ID from the token\r\n    private getUserIdFromToken(token: string | null): string | null {\r\n        if (!token) return null;\r\n        \r\n        try {\r\n            // Basic parsing of JWT token\r\n            const base64Url = token.split('.')[1];\r\n            const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n            const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {\r\n                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\r\n            }).join(''));\r\n            \r\n            const payload = JSON.parse(jsonPayload);\r\n            return payload.sub || payload.user_id || payload.id || null;\r\n        } catch (error) {\r\n            console.error('[WebSocket] Error extracting user ID from token:', error);\r\n            return null;\r\n        }\r\n    }\r\n    \r\n    // Update user ID when token changes\r\n    private updateUserIdFromToken() {\r\n        const token = localStorage.getItem('token');\r\n        const tokenUserId = this.getUserIdFromToken(token);\r\n        \r\n        if (tokenUserId) {\r\n            const newUserId = `auth_user_${tokenUserId}`;\r\n            \r\n            // Only update if changed\r\n            if (this.userId !== newUserId) {\r\n                console.log('[WebSocket] User ID changed, reconnecting...');\r\n                this.userId = newUserId;\r\n                localStorage.setItem('websocket_user_id', this.userId);\r\n                \r\n                // Force reconnect to use new user ID\r\n                this.forceReconnect();\r\n            }\r\n        }\r\n    }\r\n\r\n    // Add this getter to check connection status\r\n    get isConnected(): boolean {\r\n        return this._connected;\r\n    }\r\n\r\n    // Make this method public so we can call it from test panel\r\n    public connect(): Promise<void> {\r\n        return this.initializeConnection();\r\n    }\r\n\r\n    // Force reconnect method to ensure a fresh connection\r\n    public forceReconnect(): Promise<void> {\r\n        console.log('[WebSocket] Forcing reconnect...');\r\n        \r\n        // Disconnect if connected\r\n        if (this.client && this._connected) {\r\n            this.client.deactivate();\r\n            this._connected = false;\r\n        }\r\n        \r\n        // Clear connection promise to allow new connection\r\n        this.connectionPromise = null;\r\n        \r\n        // Initialize new connection\r\n        return this.initializeConnection();\r\n    }\r\n\r\n    private initializeConnection() {\r\n        if (this.connectionPromise) return this.connectionPromise;\r\n\r\n        console.log('[WebSocket] Initializing connection...');\r\n\r\n        this.client = new Client({\r\n            webSocketFactory: () => new SockJS('http://localhost:8080/ws'),\r\n            debug: (str) => {\r\n                if (process.env.NODE_ENV === 'development') {\r\n                    console.log('[WebSocket] Debug:', str);\r\n                }\r\n            },\r\n            reconnectDelay: this.reconnectDelay,\r\n            heartbeatIncoming: 10000,\r\n            heartbeatOutgoing: 10000,\r\n        });\r\n\r\n        this.connectionPromise = new Promise((resolve, reject) => {\r\n            if (!this.client) return reject('Client not initialized');\r\n\r\n            this.client.onConnect = (frame) => {\r\n                console.log('[WebSocket] Connected!', frame);\r\n                const wasDisconnected = !this._connected;\r\n                this._connected = true;\r\n                this.reconnectAttempts = 0;\r\n                this.reconnectDelay = 1000;\r\n\r\n                // Resubscribe to all topics\r\n                this.resubscribeAll();\r\n\r\n                // If this was a reconnection (not the initial connection)\r\n                if (wasDisconnected) {\r\n                    // Dispatch a custom event that components can listen for\r\n                    const reconnectEvent = new CustomEvent('webSocketReconnected');\r\n                    document.dispatchEvent(reconnectEvent);\r\n                }\r\n\r\n                resolve();\r\n            };\r\n\r\n            this.client.onStompError = (frame) => {\r\n                console.error('[WebSocket] STOMP error', frame);\r\n                this._connected = false;\r\n                reject(frame);\r\n            };\r\n\r\n            this.client.onWebSocketClose = () => {\r\n                console.log('[WebSocket] Connection closed');\r\n                this._connected = false;\r\n                this.handleReconnect();\r\n            };\r\n\r\n            this.client.activate();\r\n        });\r\n\r\n        return this.connectionPromise;\r\n    }\r\n\r\n    private handleReconnect() {\r\n        if (this.reconnectAttempts >= this.maxReconnectAttempts) {\r\n            console.error('[WebSocket] Max reconnection attempts reached');\r\n            return;\r\n        }\r\n\r\n        this.reconnectAttempts++;\r\n\r\n        // Exponential backoff: 1s, 2s, 4s, 8s, etc. up to 30s max\r\n        const delay = Math.min(30000, this.reconnectDelay * Math.pow(2, this.reconnectAttempts - 1));\r\n\r\n        console.log(`[WebSocket] Attempting to reconnect in ${delay / 1000} seconds... (${this.reconnectAttempts}/${this.maxReconnectAttempts})`);\r\n\r\n        // Clear previous promise to allow new connection attempt\r\n        this.connectionPromise = null;\r\n\r\n        setTimeout(() => {\r\n            if (!this._connected) {\r\n                this.initializeConnection();\r\n            }\r\n        }, delay);\r\n    }\r\n\r\n    // Method to resubscribe to all topics\r\n    private resubscribeAll() {\r\n        console.log('[WebSocket] Resubscribing to all topics');\r\n\r\n        // Store subscriptions temporarily\r\n        const oldSubscriptions = new Map(this.subscriptions);\r\n        this.subscriptions.clear();\r\n\r\n        // Resubscribe to each topic\r\n        oldSubscriptions.forEach(({ callback }, topic) => {\r\n            console.log('[WebSocket] Resubscribing to:', topic);\r\n            if (this.client) {\r\n                const subscription = this.client.subscribe(topic, (message) => {\r\n                    try {\r\n                        const data = JSON.parse(message.body);\r\n                        callback(data);\r\n                    } catch (error) {\r\n                        console.error('[WebSocket] Error parsing message:', error);\r\n                    }\r\n                });\r\n                this.subscriptions.set(topic, { subscription, callback });\r\n            }\r\n        });\r\n    }\r\n\r\n    async subscribeSeatUpdates(flightId: number, callback: (update: SeatUpdate) => void) {\r\n        try {\r\n            await this.ensureConnection();\r\n            const topic = `/topic/flight/${flightId}/seats`;\r\n\r\n            if (!this.subscriptions.has(topic) && this.client) {\r\n                const subscription = this.client.subscribe(topic, (message) => {\r\n                    try {\r\n                        const update: SeatUpdate = JSON.parse(message.body);\r\n                        callback(update);\r\n                    } catch (error) {\r\n                        console.error('[WebSocket] Error parsing seat update:', error);\r\n                    }\r\n                });\r\n                this.subscriptions.set(topic, { subscription, callback });\r\n            }\r\n            return true;\r\n        } catch (error) {\r\n            console.error('[WebSocket] Failed to subscribe:', error);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    unsubscribeSeatUpdates(flightId: number) {\r\n        const topic = `/topic/flight/${flightId}/seats`;\r\n        const subscription = this.subscriptions.get(topic);\r\n        if (subscription) {\r\n            subscription.subscription.unsubscribe();\r\n            this.subscriptions.delete(topic);\r\n        }\r\n    }\r\n\r\n    // Method to ensure connection is established\r\n    private async ensureConnection() {\r\n        if (!this._connected || !this.connectionPromise) {\r\n            // If connection is stale (more than 2 minutes old), force a new connection\r\n            const staleConnectionTime = 2 * 60 * 1000; // 2 minutes\r\n            const lastConnectionAttempt = localStorage.getItem('websocket_last_connect');\r\n            const now = Date.now();\r\n            \r\n            if (lastConnectionAttempt && (now - parseInt(lastConnectionAttempt)) > staleConnectionTime) {\r\n                console.log('[WebSocket] Connection might be stale, forcing reconnect');\r\n                return this.forceReconnect();\r\n            }\r\n            \r\n            // Normal connection\r\n            this.connectionPromise = this.initializeConnection();\r\n            // Store last connection time\r\n            localStorage.setItem('websocket_last_connect', now.toString());\r\n        }\r\n        return this.connectionPromise;\r\n    }\r\n\r\n    // Method to send seat selection\r\n    async selectSeat(request: SeatSelectionRequest): Promise<boolean> {\r\n        // Ensure userId is included\r\n        return this.sendMessage('/app/seats/hold', { \r\n            ...request, \r\n            userId: this.userId \r\n        });\r\n    }\r\n\r\n    // Method to send seat release\r\n    async releaseSeat(request: SeatSelectionRequest): Promise<boolean> {\r\n        // Ensure userId is included\r\n        return this.sendMessage('/app/seats/release', { \r\n            ...request, \r\n            userId: this.userId \r\n        });\r\n    }\r\n\r\n    // Method to send seat hold\r\n    async holdSeat(request: SeatSelectionRequest): Promise<boolean> {\r\n        // Ensure userId is included\r\n        return this.sendMessage('/app/seats/hold', { \r\n            ...request, \r\n            userId: this.userId \r\n        });\r\n    }\r\n\r\n    // Generic method to send messages\r\n    private async sendMessage(destination: string, data: any): Promise<boolean> {\r\n        try {\r\n            await this.ensureConnection();\r\n\r\n            if (!this.client || !this._connected) {\r\n                console.warn('[WebSocket] Cannot send message, not connected');\r\n                return false;\r\n            }\r\n\r\n            this.client.publish({\r\n                destination,\r\n                body: JSON.stringify(data)\r\n            });\r\n\r\n            return true;\r\n        } catch (error) {\r\n            console.error(`[WebSocket] Failed to send message to ${destination}:`, error);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    disconnect() {\r\n        if (this.client) {\r\n            this.subscriptions.forEach(({ subscription }) => subscription.unsubscribe());\r\n            this.subscriptions.clear();\r\n            this.client.deactivate();\r\n            this.client = null;\r\n            this.connectionPromise = null;\r\n            this.reconnectAttempts = 0;\r\n            this._connected = false;\r\n            console.log('[WebSocket] Disconnected');\r\n        }\r\n    }\r\n}\r\n\r\nexport const webSocketService = new WebSocketService();","import React, { useState, useEffect } from 'react';\nimport { Box, Grid, Button, Typography, Paper, Alert, CircularProgress, Snackbar } from '@mui/material';\nimport { useWebSocket } from '../../hooks/useWebSocket';\nimport { getAvailableSeats, getAllSeatsForFlight, selectSeat, releaseSeat } from '../../services/api';\nimport { webSocketService } from '../../services/websocket.service';\nimport EventSeatIcon from '@mui/icons-material/EventSeat';\nimport SyncIcon from '@mui/icons-material/Sync';\n\n// Add a storage event key for cross-tab communication\nconst SEAT_SELECTION_STORAGE_KEY = 'seat_selection_update';\n\ninterface Seat {\n    id: number;\n    seatNumber: string;\n    available: boolean;\n    booked: boolean;\n}\n\ninterface SeatSelectionProps {\n    flightId: number;\n    onSeatSelect?: (seatId: number, seatNumber: string) => void;\n    selectedSeats?: number[];\n}\n\ninterface SeatSelectionResponse {\n    success: boolean;\n    message: string;\n    seatId?: number;\n}\n\n// Add a new interface for seat update events\ninterface SeatSelectionEvent {\n    flightId: number;\n    seatId: number;\n    action: 'select' | 'release';\n    timestamp: number;\n}\n\nconst SeatSelection: React.FC<SeatSelectionProps> = ({ \n    flightId, \n    onSeatSelect, \n    selectedSeats = [] \n}) => {\n    const [seats, setSeats] = useState<Seat[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [isProcessing, setIsProcessing] = useState(false);\n    const [initialSeatCount, setInitialSeatCount] = useState<number>(0);\n    const [lastVerificationTime, setLastVerificationTime] = useState<number>(0);\n    const VERIFICATION_INTERVAL = 2000; // Reduced from 5000 to 2000 ms for more frequent checks\n    const [holdExpirationMessage, setHoldExpirationMessage] = useState<string | null>(null);\n    const [pendingOperations, setPendingOperations] = useState<Set<number>>(new Set());\n    const [lastRefreshTime, setLastRefreshTime] = useState<number>(Date.now());\n    const [lastBroadcastTime, setLastBroadcastTime] = useState<number>(0);\n\n    // Add a function to broadcast seat selection changes to other tabs/windows\n    const broadcastSeatUpdate = (seatId: number, action: 'select' | 'release') => {\n        try {\n            // Don't broadcast too frequently (prevent loops)\n            const now = Date.now();\n            if (now - lastBroadcastTime < 500) return;\n            \n            setLastBroadcastTime(now);\n            \n            const event: SeatSelectionEvent = {\n                flightId,\n                seatId,\n                action,\n                timestamp: now\n            };\n            \n            // Store in localStorage to trigger storage event in other tabs\n            localStorage.setItem(SEAT_SELECTION_STORAGE_KEY, JSON.stringify(event));\n            \n            // Remove after a short delay to allow for future events\n            setTimeout(() => {\n                localStorage.removeItem(SEAT_SELECTION_STORAGE_KEY);\n            }, 100);\n            \n            console.log(`[SeatSync] Broadcasting ${action} for seat ${seatId} on flight ${flightId}`);\n        } catch (error) {\n            console.error('[SeatSync] Error broadcasting seat update:', error);\n        }\n    };\n    \n    // Listen for seat selection broadcasts from other tabs/windows\n    useEffect(() => {\n        const handleStorageChange = (event: StorageEvent) => {\n            if (event.key === SEAT_SELECTION_STORAGE_KEY && event.newValue) {\n                try {\n                    const data: SeatSelectionEvent = JSON.parse(event.newValue);\n                    \n                    // Only process events for our current flight\n                    if (data.flightId === flightId) {\n                        console.log(`[SeatSync] Received ${data.action} for seat ${data.seatId} from another tab`);\n                        \n                        // Force immediate seat verification\n                        verifyAllSeats();\n                    }\n                } catch (error) {\n                    console.error('[SeatSync] Error processing seat update from storage:', error);\n                }\n            }\n        };\n        \n        // Add listener\n        window.addEventListener('storage', handleStorageChange);\n        \n        // Clean up\n        return () => {\n            window.removeEventListener('storage', handleStorageChange);\n        };\n    }, [flightId]);\n\n    // Force WebSocket reconnect when component mounts\n    useEffect(() => {\n        console.log('SeatSelection: Forcing WebSocket reconnect for better real-time updates');\n        // Force a reconnect to ensure fresh connection for seat updates\n        webSocketService.forceReconnect().then(() => {\n            console.log('SeatSelection: WebSocket reconnected successfully');\n        }).catch(err => {\n            console.error('SeatSelection: WebSocket reconnect failed:', err);\n        });\n        \n        // Set up an interval to refresh seats more frequently\n        const refreshInterval = setInterval(() => {\n            refreshSeats();\n        }, 5000); // Refresh all seats every 5 seconds (reduced from 10s)\n        \n        return () => {\n            clearInterval(refreshInterval);\n        };\n    }, []);\n\n    // Update the WebSocket subscription for real-time updates\n    useEffect(() => {\n        if (flightId) {\n            const handleSeatUpdate = (update: any) => {\n                if (update.flightId === flightId) {\n                    console.log('WebSocket: Received seat update:', update);\n                    \n                    // Update the seat in our local state\n                    setSeats(prevSeats => {\n                        return prevSeats.map(seat => {\n                            if (seat.id === update.seatId) {\n                                // Update the seat with the new data from WebSocket\n                                const isBooked = update.status === \"CONFIRMED\";\n                                \n                                // Show notification for hold expired\n                                if (update.status === \"HOLD_EXPIRED\" || update.status === \"FIXED_INCONSISTENCY\") {\n                                    const seatNumber = seat.seatNumber;\n                                    setTimeout(() => {\n                                        setError(`Seat ${seatNumber} hold time expired and is now available for booking.`);\n                                        setHoldExpirationMessage(`Seat ${seatNumber} is now available for booking!`);\n                                    }, 100);\n                                }\n                                \n                                return { \n                                    ...seat, \n                                    available: update.available,\n                                    booked: isBooked // Set booked status based on update status\n                                };\n                            }\n                            return seat;\n                        });\n                    });\n\n                    // Update selected seats list if seat was released (including hold expiration)\n                    if ((update.status === \"RELEASED\" || update.status === \"HOLD_EXPIRED\") && \n                        selectedSeats.includes(update.seatId)) {\n                        const seatNumber = seats.find(s => s.id === update.seatId)?.seatNumber || '';\n                        onSeatSelect && onSeatSelect(update.seatId, seatNumber);\n                    }\n                    \n                    // Force a seat verification after any update\n                    verifyAllSeats();\n                }\n            };\n\n            // Subscribe to seat updates for this flight\n            console.log(`Subscribing to seat updates for flight ${flightId}`);\n            webSocketService.subscribeSeatUpdates(flightId, handleSeatUpdate);\n\n            // Clean up subscription when component unmounts or flightId changes\n            return () => {\n                console.log(`Unsubscribing from seat updates for flight ${flightId}`);\n                webSocketService.unsubscribeSeatUpdates(flightId);\n            };\n        }\n    }, [flightId, seats]); // Added seats dependency to update selection when seats change\n\n    // Add new function to verify all seats\n    const verifyAllSeats = async () => {\n        try {\n            const token = localStorage.getItem('token');\n            if (!token) return;\n\n            console.log('Verifying all seats with latest server data');\n            const allSeatsData = await getAllSeatsForFlight(flightId.toString(), token);\n            \n            // Update our seats array with the latest server data\n            setSeats(prevSeats => {\n                return prevSeats.map(seat => {\n                    // Find the matching seat in the server data\n                    const serverSeat = allSeatsData.find((s: Seat) => s.id === seat.id);\n                    if (serverSeat) {\n                        // If this seat is in our selection, mark it accordingly\n                        if (selectedSeats.includes(seat.id)) {\n                            return { ...serverSeat, available: false };\n                        }\n                        // Otherwise use the server status\n                        return serverSeat;\n                    }\n                    return seat;\n                });\n            });\n        } catch (err) {\n            console.error('Error verifying all seats:', err);\n        }\n    };\n\n    // Update the verification useEffect to run more frequently\n    useEffect(() => {\n        const now = Date.now();\n        if (now - lastVerificationTime < VERIFICATION_INTERVAL) {\n            // Skip verification if it was done recently\n            return;\n        }\n\n        const verifySelectedSeats = async () => {\n            setLastVerificationTime(Date.now());\n            try {\n                const token = localStorage.getItem('token');\n                if (!token) return;\n\n                // Get ALL seats to verify selected ones\n                const allSeatsData = await getAllSeatsForFlight(flightId.toString(), token);\n                console.log('Verifying selected seats with server data');\n                \n                // Check if our selected seats are still available or valid\n                const unavailableSelectedSeats = selectedSeats.filter(seatId => {\n                    const seat = allSeatsData.find((s: Seat) => s.id === seatId);\n                    // If the seat doesn't exist at all or it's already booked\n                    return !seat || seat.booked === true;\n                });\n                \n                if (unavailableSelectedSeats.length > 0) {\n                    console.warn('Some selected seats are no longer available:', unavailableSelectedSeats);\n                    \n                    // Remove these unavailable seats from the selection\n                    for (const unavailableSeatId of unavailableSelectedSeats) {\n                        const seatNumber = seats.find(s => s.id === unavailableSeatId)?.seatNumber || '';\n                        if (onSeatSelect && seatNumber) {\n                            console.log(`Auto-removing unavailable seat ${unavailableSeatId} (${seatNumber}) from selection`);\n                            onSeatSelect(unavailableSeatId, seatNumber);\n                            setError(`Seat ${seatNumber} is no longer available and has been removed from your selection.`);\n                        }\n                    }\n                }\n                \n                // Always update our seats array with the latest data\n                setSeats(prevSeats => {\n                    // Create a filtered list of still-valid selections\n                    const validSelectedSeats = selectedSeats.filter(\n                        seatId => !unavailableSelectedSeats.includes(seatId)\n                    );\n                    \n                    return allSeatsData.map((serverSeat: Seat) => {\n                        // If this seat is in our valid selection list, mark it accordingly\n                        if (validSelectedSeats.includes(serverSeat.id)) {\n                            return { ...serverSeat, available: false };\n                        }\n                        // Otherwise use the server status\n                        return serverSeat;\n                    });\n                });\n            } catch (err) {\n                console.error('Error verifying seat status:', err);\n            }\n        };\n        \n        // Run the verification\n        verifySelectedSeats();\n    }, [selectedSeats, flightId, lastVerificationTime, seats]);\n\n    // Add a new refreshSeats function\n    const refreshSeats = async () => {\n        try {\n            const token = localStorage.getItem('token');\n            if (!token) return;\n\n            console.log('Refreshing all seats data from server');\n            const allSeatsData = await getAllSeatsForFlight(flightId.toString(), token);\n            \n            // Update seats with the latest data\n            setSeats(prevSeats => {\n                return allSeatsData.map((serverSeat: Seat) => {\n                    // If this seat is in our selection, mark it accordingly\n                    if (selectedSeats.includes(serverSeat.id)) {\n                        return { ...serverSeat, available: false };\n                    }\n                    // Otherwise use the server status\n                    return serverSeat;\n                });\n            });\n            \n            // Update last refresh time\n            setLastRefreshTime(Date.now());\n        } catch (err) {\n            console.error('Error refreshing seats:', err);\n        }\n    };\n\n    // Fetch initial seats data\n    useEffect(() => {\n        const fetchSeats = async () => {\n            setLoading(true);\n            setError(null);\n            try {\n                const token = localStorage.getItem('token');\n                if (!token) throw new Error('Authentication required');\n\n                // Get ALL seats, not just available ones\n                const seatsData = await getAllSeatsForFlight(flightId.toString(), token);\n                console.log('Fetched ALL seats:', seatsData.length);\n                \n                // Keep track of the initial seat count for future reference\n                setInitialSeatCount(seatsData.length);\n                \n                // Mark selected seats as unavailable\n                const updatedSeats = seatsData.map((seat: Seat) => {\n                    if (selectedSeats.includes(seat.id)) {\n                        return { ...seat, available: false };\n                    }\n                    return seat;\n                });\n                \n                setSeats(updatedSeats);\n            } catch (err) {\n                setError('Failed to load seats. Please try again later.');\n                console.error('Seat loading error:', err);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        fetchSeats();\n    }, [flightId, selectedSeats]);\n\n    // Add these logging effects\n    useEffect(() => {\n        // Only log significant changes in seat count\n        if (seats.length !== 0 && Math.abs(seats.length - initialSeatCount) > 5) {\n            console.log('Significant change in seats state:', seats.length, 'seats');\n        }\n    }, [seats, initialSeatCount]);\n\n    useEffect(() => {\n        // Only log when selected seats actually change\n        if (selectedSeats.length > 0) {\n            console.log('Selected seats updated:', selectedSeats);\n        }\n    }, [selectedSeats]);\n\n    // If we ever lose seats from our array, fetch them again\n    useEffect(() => {\n        // Only run this check after initial load\n        if (initialSeatCount > 0 && !loading && seats.length < initialSeatCount) {\n            console.warn(`Seat count decreased from ${initialSeatCount} to ${seats.length}. Refetching ALL seats...`);\n            const refetchSeats = async () => {\n                try {\n                    const token = localStorage.getItem('token');\n                    if (!token) return;\n                    \n                    // Get ALL seats, not just available ones\n                    const seatsData = await getAllSeatsForFlight(flightId.toString(), token);\n                    console.log('Refetched ALL seats:', seatsData.length);\n                    \n                    // Preserve our selected seats in the refetched data\n                    const updatedSeats = seatsData.map((seat: Seat) => {\n                        if (selectedSeats.includes(seat.id)) {\n                            return { ...seat, available: false };\n                        }\n                        return seat;\n                    });\n                    \n                    setSeats(updatedSeats);\n                } catch (err) {\n                    console.error('Error refetching seats:', err);\n                }\n            };\n            \n            refetchSeats();\n        } else if (!loading && seats.length > 0 && initialSeatCount === 0) {\n            // Store the initial seat count once loaded\n            setInitialSeatCount(seats.length);\n            console.log('Initial seat count set to:', seats.length);\n        }\n    }, [seats.length, loading, initialSeatCount, flightId, selectedSeats]);\n\n    // Add this forced refresh effect when seats get stuck\n    useEffect(() => {\n        const now = Date.now();\n        // Force refresh seats every 10 seconds at most\n        if (now - lastRefreshTime > 10000 && pendingOperations.size === 0) {\n            const refreshSeats = async () => {\n                try {\n                    const token = localStorage.getItem('token');\n                    if (!token) return;\n                    \n                    console.log('Performing periodic refresh of seat data');\n                    setLastRefreshTime(now);\n                    \n                    // Get ALL seats, not just available ones\n                    const seatsData = await getAllSeatsForFlight(flightId.toString(), token);\n                    \n                    // Preserve our selected seats in the refetched data\n                    const updatedSeats = seatsData.map((seat: Seat) => {\n                        if (selectedSeats.includes(seat.id)) {\n                            return { ...seat, available: false };\n                        }\n                        return seat;\n                    });\n                    \n                    setSeats(updatedSeats);\n                } catch (err) {\n                    console.error('Error in periodic refresh:', err);\n                }\n            };\n            \n            refreshSeats();\n        }\n    }, [seats, flightId, selectedSeats, lastRefreshTime, pendingOperations]);\n\n    // Add a new effect to check for seat status changes and ensure consistency\n    useEffect(() => {\n        // Get all seats and check their status against what we have locally\n        const syncAllSeats = async () => {\n            try {\n                const token = localStorage.getItem('token');\n                if (!token) return;\n                \n                console.log('Performing deep seat synchronization...');\n                const allSeatsData = await getAllSeatsForFlight(flightId.toString(), token);\n                \n                // Check if any seat has changed state (booked/held by someone else)\n                let hasChanges = false;\n                \n                // Map all seats by ID for easy lookup\n                const seatMap = new Map();\n                allSeatsData.forEach((serverSeat: Seat) => {\n                    seatMap.set(serverSeat.id, serverSeat);\n                });\n                \n                // Compare with our current seats\n                seats.forEach(localSeat => {\n                    const serverSeat = seatMap.get(localSeat.id);\n                    if (serverSeat) {\n                        // Check if seat status is different (except for our selections)\n                        if (selectedSeats.includes(localSeat.id)) {\n                            // This is our selected seat - we don't sync available status\n                            // But we should check if it was booked by someone else\n                            if (serverSeat.booked !== localSeat.booked) {\n                                console.warn(`Our selected seat ${localSeat.seatNumber} (${localSeat.id}) has been booked by someone else!`);\n                                hasChanges = true;\n                            }\n                        } else {\n                            // Not our selected seat, check if status changed\n                            if (serverSeat.available !== localSeat.available || \n                                serverSeat.booked !== localSeat.booked) {\n                                console.log(`Seat ${localSeat.seatNumber} (${localSeat.id}) status changed from server`);\n                                hasChanges = true;\n                            }\n                        }\n                    }\n                });\n                \n                // If there are changes, update all seats with server data\n                if (hasChanges) {\n                    console.log('Seat status changes detected from server, syncing...');\n                    setSeats(prevSeats => {\n                        return allSeatsData.map((serverSeat: Seat) => {\n                            // Keep our selected seats marked as selected\n                            if (selectedSeats.includes(serverSeat.id)) {\n                                // If it's already booked, we should de-select it\n                                if (serverSeat.booked) {\n                                    // This seat was booked by someone else, we need to notify and remove from selection\n                                    setTimeout(() => {\n                                        const seatNumber = seats.find(s => s.id === serverSeat.id)?.seatNumber || '';\n                                        if (onSeatSelect && seatNumber) {\n                                            onSeatSelect(serverSeat.id, seatNumber);\n                                            setError(`Seat ${seatNumber} was booked by another user and has been removed from your selection.`);\n                                        }\n                                    }, 100);\n                                    return serverSeat; // Don't mark as selected\n                                }\n                                return { ...serverSeat, available: false };\n                            }\n                            return serverSeat;\n                        });\n                    });\n                }\n            } catch (err) {\n                console.error('Error syncing seats:', err);\n            }\n        };\n        \n        // Run the sync when component mounts and when selectedSeats changes\n        syncAllSeats();\n        \n        // Also set up an interval to check for changes from outside\n        const intervalId = setInterval(syncAllSeats, 5000); // Check every 5 seconds\n        \n        return () => clearInterval(intervalId);\n    }, [flightId, selectedSeats]);\n\n    const handleSeatClick = async (seatId: number, seatNumber: string) => {\n        // Prevent clicking if this seat already has a pending operation\n        if (pendingOperations.has(seatId)) {\n            console.warn(`Ignoring click on seat ${seatId}, operation already in progress`);\n            return;\n        }\n\n        setIsProcessing(true);\n        setError(null);\n        \n        // Add this seat to pending operations\n        setPendingOperations(prev => new Set([...Array.from(prev), seatId]));\n        \n        try {\n            // Check if seat is already in selectedSeats\n            const isSelected = selectedSeats.includes(seatId);\n            console.log(`Clicking seat ${seatId} (${seatNumber}), currently selected: ${isSelected}`);\n            \n            // Get the current seat object\n            const currentSeat = seats.find((seat: Seat) => seat.id === seatId);\n            if (!currentSeat) {\n                console.warn(`Seat ${seatId} not found in seats array before operation`);\n                setError(`Seat ${seatNumber} information could not be found. Please refresh the page.`);\n                setPendingOperations(prev => {\n                    const newSet = new Set(prev);\n                    newSet.delete(seatId);\n                    return newSet;\n                });\n                setIsProcessing(false);\n                return;\n            }\n            \n            // Check if seat is actually available (not booked and not held by someone else)\n            if (!isSelected && (!currentSeat.available || currentSeat.booked)) {\n                console.warn(`Attempting to select unavailable seat ${seatId}`);\n                setError(`Seat ${seatNumber} is not available for selection`);\n                setPendingOperations(prev => {\n                    const newSet = new Set(prev);\n                    newSet.delete(seatId);\n                    return newSet;\n                });\n                setIsProcessing(false);\n                return;\n            }\n            \n            let success = false;\n            \n            if (isSelected) {\n                // Release the seat via WebSocket\n                console.log(`Releasing seat ${seatId} via WebSocket`);\n                \n                // Immediately update the UI to show as released\n                // This prevents the seat from disappearing before backend response\n                setSeats(prevSeats => {\n                    return prevSeats.map(seat =>\n                        seat.id === seatId ? { ...seat, available: true } : seat\n                    );\n                });\n                \n                try {\n                    // Use WebSocket service directly\n                    success = await webSocketService.releaseSeat({\n                        seatId: seatId,\n                        flightId: flightId\n                    });\n                    \n                    if (success) {\n                        // Broadcast seat release to other tabs/windows\n                        broadcastSeatUpdate(seatId, 'release');\n                    }\n                    \n                    if (!success) {\n                        console.error(`WebSocket seat release failed for seat ${seatId}`);\n                        setError(`Failed to release seat ${seatNumber}. Please try again.`);\n                        \n                        // Revert the optimistic UI update since the operation failed\n                        setSeats(prevSeats => {\n                            return prevSeats.map(seat =>\n                                seat.id === seatId ? { ...seat, available: false } : seat\n                            );\n                        });\n                        \n                        setPendingOperations(prev => {\n                            const newSet = new Set(prev);\n                            newSet.delete(seatId);\n                            return newSet;\n                        });\n                        \n                        setIsProcessing(false);\n                        return; // Prevent calling onSeatSelect for failed operations\n                    }\n                    \n                    console.log(`Successfully released seat ${seatId} via WebSocket`);\n                } catch (err) {\n                    console.error('Error releasing seat:', err);\n                    setError(`Failed to release seat ${seatNumber}: ${err instanceof Error ? err.message : 'Unknown error'}`);\n                    \n                    // Revert the optimistic UI update since the operation failed\n                    setSeats(prevSeats => {\n                        return prevSeats.map(seat =>\n                            seat.id === seatId ? { ...seat, available: false } : seat\n                        );\n                    });\n                    \n                    setPendingOperations(prev => {\n                        const newSet = new Set(prev);\n                        newSet.delete(seatId);\n                        return newSet;\n                    });\n                    \n                    setIsProcessing(false);\n                    return; // Prevent calling onSeatSelect for failed operations\n                }\n            } else {\n                // Select the seat via WebSocket\n                console.log(`Selecting seat ${seatId} via WebSocket`);\n                \n                // Optimistically update UI first\n                setSeats(prevSeats => {\n                    return prevSeats.map(seat =>\n                        seat.id === seatId ? { ...seat, available: false } : seat\n                    );\n                });\n                \n                try {\n                    // Use WebSocket service directly, which uses holdSeat under the hood\n                    success = await webSocketService.selectSeat({\n                        seatId: seatId,\n                        flightId: flightId\n                    });\n                    \n                    if (success) {\n                        // Broadcast seat selection to other tabs/windows\n                        broadcastSeatUpdate(seatId, 'select');\n                    }\n                    \n                    if (!success) {\n                        console.error(`WebSocket seat selection failed for seat ${seatId}`);\n                        setError(`Failed to select seat ${seatNumber}. Please try again.`);\n                        \n                        // Revert the optimistic UI update since the operation failed\n                        setSeats(prevSeats => {\n                            return prevSeats.map(seat =>\n                                seat.id === seatId ? { ...seat, available: true } : seat\n                            );\n                        });\n                        \n                        setPendingOperations(prev => {\n                            const newSet = new Set(prev);\n                            newSet.delete(seatId);\n                            return newSet;\n                        });\n                        \n                        setIsProcessing(false);\n                        return; // Prevent calling onSeatSelect for failed operations\n                    }\n                    \n                    console.log(`Successfully selected seat ${seatId} via WebSocket`);\n                } catch (err) {\n                    console.error('Error selecting seat:', err);\n                    setError(`Failed to select seat ${seatNumber}: ${err instanceof Error ? err.message : 'Unknown error'}`);\n                    \n                    // Revert the optimistic UI update since the operation failed\n                    setSeats(prevSeats => {\n                        return prevSeats.map(seat =>\n                            seat.id === seatId ? { ...seat, available: true } : seat\n                        );\n                    });\n                    \n                    setPendingOperations(prev => {\n                        const newSet = new Set(prev);\n                        newSet.delete(seatId);\n                        return newSet;\n                    });\n                    \n                    setIsProcessing(false);\n                    return; // Prevent calling onSeatSelect for failed operations\n                }\n            }\n            \n            // Call the parent's handler to update selected seats list\n            if (onSeatSelect) {\n                onSeatSelect(seatId, seatNumber);\n            }\n            \n            // Force an immediate verification to ensure consistency\n            setLastVerificationTime(0);\n            \n        } catch (err) {\n            const errorMessage = err instanceof Error ? err.message : 'Failed to process seat';\n            setError(errorMessage);\n            console.error('Seat operation error:', err);\n        } finally {\n            // Remove this seat from pending operations\n            setPendingOperations(prev => {\n                const newSet = new Set(prev);\n                newSet.delete(seatId);\n                return newSet;\n            });\n            \n            setIsProcessing(false);\n        }\n    };\n\n    // Add this function after the handleSeatClick function\n    const findAndRestoreSeat = async (seatId: number, seatNumber: string) => {\n        try {\n            console.log(`Attempting to restore missing seat ${seatId} (${seatNumber})`);\n            const token = localStorage.getItem('token');\n            if (!token) return;\n            \n            // First check if the seat is already in our array\n            const seatExists = seats.some(seat => seat.id === seatId);\n            if (seatExists) {\n                console.log(`Seat ${seatId} already exists in array, no need to restore`);\n                return;\n            }\n            \n            // Fetch ALL seats to restore the missing one\n            const seatsData = await getAllSeatsForFlight(flightId.toString(), token);\n            \n            // Check if the seat exists in the fetched data\n            const restoredSeat = seatsData.find((seat: Seat) => seat.id === seatId);\n            if (restoredSeat) {\n                console.log(`Found missing seat ${seatId} in API response, restoring it`);\n                // Add just this seat back to our array\n                setSeats(prevSeats => [...prevSeats, restoredSeat]);\n            } else {\n                console.warn(`Seat ${seatId} not found in API response, cannot restore`);\n            }\n        } catch (err) {\n            console.error(`Error restoring seat ${seatId}:`, err);\n        }\n    };\n\n    const renderSeat = (seat: Seat) => {\n        const isSelected = selectedSeats.includes(seat.id);\n        const isPermanentlyBooked = seat.booked === true;\n        const isTemporarilySelected = isSelected || (!seat.available && !isPermanentlyBooked);\n        \n        // Determine status for styling and display\n        let status = 'available';\n        let statusText = '';\n        \n        if (isPermanentlyBooked) {\n            status = 'booked';\n            statusText = '';\n        } else if (!seat.available && !isSelected) {\n            // This is a seat that's unavailable but not in our selection\n            status = 'held';\n            statusText = '';\n        } else if (isTemporarilySelected) {\n            status = 'selected';\n            statusText = '';\n        }\n        \n        // Don't allow clicking on permanently booked or unavailable seats\n        const isClickable = seat.available || isSelected;\n        const handleClick = !isClickable \n            ? undefined \n            : () => handleSeatClick(seat.id, seat.seatNumber);\n        \n        return (\n            <Box\n                key={seat.id}\n                data-seat-id={seat.id}\n                onClick={handleClick}\n                sx={{\n                    width: { xs: 30, sm: 36, md: 40 },\n                    height: { xs: 30, sm: 36, md: 40 },\n                    m: { xs: 0.3, sm: 0.4, md: 0.5 },\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    cursor: isClickable ? 'pointer' : 'not-allowed',\n                    borderRadius: '4px 4px 0 0',\n                    transition: 'all 0.2s',\n                    backgroundColor: status === 'booked' \n                        ? 'error.light' \n                        : status === 'held'\n                            ? 'warning.light'\n                            : status === 'selected' \n                                ? 'primary.light' \n                                : 'background.paper',\n                    color: status === 'available' ? 'text.primary' : 'white',\n                    boxShadow: '0 2px 3px rgba(0,0,0,0.1)',\n                    position: 'relative',\n                    fontWeight: 'bold',\n                    fontSize: { xs: 11, sm: 12, md: 14 },\n                    '&:hover': {\n                        transform: isClickable ? 'translateY(-2px)' : 'none',\n                        boxShadow: isClickable ? '0 4px 6px rgba(0,0,0,0.15)' : '0 2px 3px rgba(0,0,0,0.1)',\n                    },\n                    '&:before': {\n                        content: '\"\"',\n                        position: 'absolute',\n                        bottom: -8,\n                        left: 0,\n                        width: '100%',\n                        height: 8,\n                        backgroundColor: status === 'booked' \n                            ? 'error.dark' \n                            : status === 'held'\n                                ? 'warning.dark'\n                                : status === 'selected' \n                                    ? 'primary.dark' \n                                    : 'grey.400',\n                        borderRadius: '0 0 4px 4px',\n                    },\n                    '&:after': {\n                        content: '\"\"',\n                        position: 'absolute',\n                        bottom: -3,\n                        left: '15%',\n                        width: '70%',\n                        height: 1,\n                        backgroundColor: 'rgba(255,255,255,0.5)',\n                    }\n                }}\n            >\n                {seat.seatNumber}\n                {statusText && (\n                    <Typography \n                        variant=\"caption\" \n                        component=\"div\" \n                        sx={{ \n                            fontSize: { xs: '6px', sm: '7px', md: '8px' }, \n                            position: 'absolute', \n                            bottom: -16,\n                            width: '100%',\n                            textAlign: 'center',\n                            fontWeight: 'bold',\n                            color: 'text.secondary'\n                        }}\n                    >\n                        {statusText}\n                    </Typography>\n                )}\n            </Box>\n        );\n    }\n\n    const renderSeatGrid = () => {\n        const groupedByRow = seats.reduce((acc: Record<string, Seat[]>, seat) => {\n            // Extract the row letter (assuming format like 'A1', 'B3', etc.)\n            const rowLetter = seat.seatNumber.charAt(0);\n            if (!acc[rowLetter]) {\n                acc[rowLetter] = [];\n            }\n            acc[rowLetter].push(seat);\n            return acc;\n        }, {});\n\n        // Sort rows by letter and sort seats within each row by number\n        return (\n            <Box sx={{ \n                display: 'flex', \n                flexDirection: 'column',\n                alignItems: 'center',\n                width: '100%',\n                overflowX: 'auto'\n            }}>\n                {/* Airplane nose */}\n                <Box \n                    sx={{ \n                        width: '60px', \n                        height: '80px', \n                        bgcolor: 'grey.300', \n                        borderRadius: '50% 50% 0 0', \n                        mb: 4,\n                        display: { xs: 'none', sm: 'block' }\n                    }} \n                />\n                \n                {/* Cabin section */}\n                <Box sx={{ \n                    bgcolor: 'grey.100', \n                    borderRadius: '10px',\n                    p: { xs: 1, sm: 2, md: 3 },\n                    width: { xs: '95%', sm: '90%', md: '80%' },\n                    maxWidth: '800px'\n                }}>\n                    {Object.keys(groupedByRow)\n                        .sort()\n                        .map(rowLetter => {\n                            // Sort seats by their number\n                            const sortedSeats = [...groupedByRow[rowLetter]].sort((a, b) => {\n                                const aNum = parseInt(a.seatNumber.substring(1));\n                                const bNum = parseInt(b.seatNumber.substring(1));\n                                return aNum - bNum;\n                            });\n                            \n                            // Create two groups for left and right sides of aisle\n                            const midPoint = Math.ceil(sortedSeats.length / 2);\n                            const leftSeats = sortedSeats.slice(0, midPoint);\n                            const rightSeats = sortedSeats.slice(midPoint);\n                            \n                            return (\n                                <Box key={rowLetter} sx={{ \n                                    display: 'flex', \n                                    alignItems: 'center', \n                                    mb: { xs: 2, sm: 3 }, \n                                    justifyContent: 'center',\n                                    width: '100%'\n                                }}>\n                                    <Typography variant=\"subtitle2\" sx={{ \n                                        width: { xs: 20, sm: 30 }, \n                                        textAlign: 'center', \n                                        mr: { xs: 0.5, sm: 1 },\n                                        fontWeight: 'bold'\n                                    }}>\n                                        {rowLetter}\n                                    </Typography>\n                                    \n                                    {/* Left side seats */}\n                                    <Box sx={{ display: 'flex' }}>\n                                        {leftSeats.map(seat => renderSeat(seat))}\n                                    </Box>\n                                    \n                                    {/* Aisle */}\n                                    <Box sx={{ \n                                        width: { xs: 12, sm: 16, md: 20 }, \n                                        mx: { xs: 0.5, sm: 1, md: 2 }, \n                                        height: 4, \n                                        bgcolor: 'grey.300',\n                                        alignSelf: 'center'\n                                    }} />\n                                    \n                                    {/* Right side seats */}\n                                    <Box sx={{ display: 'flex' }}>\n                                        {rightSeats.map(seat => renderSeat(seat))}\n                                    </Box>\n                                </Box>\n                            );\n                        })}\n                </Box>\n            </Box>\n        );\n    };\n\n    return (\n        <Paper elevation={3} sx={{ \n            p: { xs: 1, sm: 2, md: 3 }, \n            maxWidth: '100%', \n            margin: 'auto', \n            overflowX: 'auto'\n        }}>\n            <Typography variant=\"h5\" gutterBottom align=\"center\">\n                Select Your Seat\n            </Typography>\n            \n            {error && (\n                <Alert severity=\"error\" sx={{ mb: 2 }}>\n                    {error}\n                </Alert>\n            )}\n            \n            {holdExpirationMessage && (\n                <Snackbar\n                    open={!!holdExpirationMessage}\n                    autoHideDuration={6000}\n                    onClose={() => setHoldExpirationMessage(null)}\n                    message={holdExpirationMessage}\n                />\n            )}\n            \n            {loading ? (\n                <Box sx={{ display: 'flex', justifyContent: 'center', p: 3 }}>\n                    <CircularProgress />\n                </Box>\n            ) : (\n                <Box sx={{ \n                    width: '100%', \n                    overflowX: 'auto',\n                    display: 'flex',\n                    flexDirection: 'column',\n                    alignItems: 'center' \n                }}>\n                    <Typography variant=\"body2\" gutterBottom align=\"center\">\n                        Please select your preferred seat from the available options below.\n                    </Typography>\n                    \n                    {renderSeatGrid()}\n                    \n                    <Box sx={{ \n                        mt: 3, \n                        display: 'flex', \n                        justifyContent: 'center', \n                        flexWrap: 'wrap', \n                        gap: { xs: 1, sm: 2 }, \n                        maxWidth: '100%'\n                    }}>\n                        <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                            <Box sx={{ \n                                width: 16, \n                                height: 16, \n                                backgroundColor: 'background.paper', \n                                position: 'relative',\n                                borderRadius: '4px 4px 0 0',\n                                '&:before': {\n                                    content: '\"\"',\n                                    position: 'absolute',\n                                    bottom: -4,\n                                    left: 0,\n                                    width: '100%',\n                                    height: 4,\n                                    backgroundColor: 'grey.400',\n                                    borderRadius: '0 0 4px 4px',\n                                }\n                            }}></Box>\n                            <Typography variant=\"caption\" sx={{ ml: 1 }}>Available</Typography>\n                        </Box>\n                        <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                            <Box sx={{ \n                                width: 16, \n                                height: 16, \n                                backgroundColor: 'primary.light', \n                                position: 'relative',\n                                borderRadius: '4px 4px 0 0',\n                                '&:before': {\n                                    content: '\"\"',\n                                    position: 'absolute',\n                                    bottom: -4,\n                                    left: 0,\n                                    width: '100%',\n                                    height: 4,\n                                    backgroundColor: 'primary.dark',\n                                    borderRadius: '0 0 4px 4px',\n                                }\n                            }}></Box>\n                            <Typography variant=\"caption\" sx={{ ml: 1 }}>Selected</Typography>\n                        </Box>\n                        <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                            <Box sx={{ \n                                width: 16, \n                                height: 16, \n                                backgroundColor: 'warning.light', \n                                position: 'relative',\n                                borderRadius: '4px 4px 0 0',\n                                '&:before': {\n                                    content: '\"\"',\n                                    position: 'absolute',\n                                    bottom: -4,\n                                    left: 0,\n                                    width: '100%',\n                                    height: 4,\n                                    backgroundColor: 'warning.dark',\n                                    borderRadius: '0 0 4px 4px',\n                                }\n                            }}></Box>\n                            <Typography variant=\"caption\" sx={{ ml: 1 }}>Held (expires in 3 min)</Typography>\n                        </Box>\n                        <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                            <Box sx={{ \n                                width: 16, \n                                height: 16, \n                                backgroundColor: 'error.light',\n                                position: 'relative',\n                                borderRadius: '4px 4px 0 0',\n                                '&:before': {\n                                    content: '\"\"',\n                                    position: 'absolute',\n                                    bottom: -4,\n                                    left: 0,\n                                    width: '100%',\n                                    height: 4,\n                                    backgroundColor: 'error.dark',\n                                    borderRadius: '0 0 4px 4px',\n                                }\n                            }}></Box>\n                            <Typography variant=\"caption\" sx={{ ml: 1 }}>Booked</Typography>\n                        </Box>\n                    </Box>\n                    \n                    <Box sx={{ \n                        display: 'flex', \n                        justifyContent: 'center', \n                        mt: 3,\n                        flexWrap: { xs: 'wrap', sm: 'nowrap' },\n                        gap: 1\n                    }}>\n                        <Button \n                            variant=\"outlined\" \n                            color=\"primary\" \n                            onClick={refreshSeats}\n                            startIcon={<SyncIcon />}\n                            disabled={isProcessing}\n                            size=\"small\"\n                            sx={{ \n                                px: { xs: 1, sm: 2 },\n                                py: { xs: 0.5, sm: 1 }\n                            }}\n                        >\n                            Refresh Seats\n                        </Button>\n                        \n                        <Button \n                            variant=\"contained\" \n                            color=\"primary\"\n                            onClick={() => verifyAllSeats()}\n                            disabled={isProcessing}\n                            size=\"small\"\n                            sx={{ \n                                px: { xs: 1, sm: 2 },\n                                py: { xs: 0.5, sm: 1 }\n                            }}\n                        >\n                            Verify Selection\n                        </Button>\n                    </Box>\n                </Box>\n            )}\n        </Paper>\n    );\n};\n\nexport default SeatSelection;","import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { \n  Alert, Box, Container, Paper, Button, Typography, \n  Chip, CircularProgress, TextField, Dialog, DialogTitle, \n  DialogContent, DialogActions, Grid, Divider, Snackbar \n} from '@mui/material';\nimport SeatSelection from './SeatSelection';\nimport { bookSeat, createBooking, Passenger, Flight, saveApiFlightToDatabase } from '../../services/api';\nimport ErrorAlert from '../common/ErrorAlert';\nimport axios from 'axios';\n\n// Add a key for storing selected seats in sessionStorage to improve cross-browser synchronization\nconst SEAT_STORAGE_KEY = 'selected_seats_for_flight_';\n\ninterface Booking {\n    id: number;\n    flightId: string;\n    selectedSeats: number[];\n    timestamp: string;\n    status: 'confirmed' | 'completed' | 'cancelled';\n    passengers?: Passenger[];\n}\n\ninterface PassengerForm {\n    firstName: string;\n    lastName: string;\n    email: string;\n    phone: string;\n    age: string;\n    seatId: number;\n    seatNumber: string;\n}\n\nconst SeatSelectionWrapper: React.FC = () => {\n    const { flightId = '' } = useParams();\n    const navigate = useNavigate();\n    const [selectedSeats, setSelectedSeats] = useState<number[]>([]);\n    const [selectedSeatNumbers, setSelectedSeatNumbers] = useState<string[]>([]);\n    const [isLoading, setIsLoading] = useState<boolean>(true);\n    const [error, setError] = useState<string | null>(null);\n    const [successMessage, setSuccessMessage] = useState<string | null>(null);\n    const [passengerDialogOpen, setPassengerDialogOpen] = useState<boolean>(false);\n    const [passengers, setPassengers] = useState<PassengerForm[]>([]);\n    const [formErrors, setFormErrors] = useState<Record<string, string>>({});\n    const [flightData, setFlightData] = useState<Flight | null>(null);\n    const [isApiSourced, setIsApiSourced] = useState<boolean>(false);\n    const [isFlightSaved, setIsFlightSaved] = useState<boolean>(false);\n    const [lastSeatCheckTime, setLastSeatCheckTime] = useState<number>(Date.now());\n    \n    // Convert flightId to number for API calls\n    const flightIdNumber = parseInt(flightId, 10);\n    \n    // Define storage keys specific to this flight\n    const seatStorageKey = `${SEAT_STORAGE_KEY}${flightId}`;\n    const seatNumbersStorageKey = `${SEAT_STORAGE_KEY}${flightId}_numbers`;\n    \n    // Load initial seat selections from sessionStorage for this flight\n    useEffect(() => {\n        try {\n            const storedSeats = sessionStorage.getItem(seatStorageKey);\n            const storedSeatNumbers = sessionStorage.getItem(seatNumbersStorageKey);\n            \n            if (storedSeats) {\n                const parsedSeats = JSON.parse(storedSeats);\n                if (Array.isArray(parsedSeats)) {\n                    setSelectedSeats(parsedSeats);\n                    console.log('Loaded selected seats from storage:', parsedSeats);\n                }\n            }\n            \n            if (storedSeatNumbers) {\n                const parsedSeatNumbers = JSON.parse(storedSeatNumbers);\n                if (Array.isArray(parsedSeatNumbers)) {\n                    setSelectedSeatNumbers(parsedSeatNumbers);\n                    console.log('Loaded selected seat numbers from storage:', parsedSeatNumbers);\n                }\n            }\n        } catch (error) {\n            console.error('Error loading seats from sessionStorage:', error);\n        }\n    }, [flightId, seatStorageKey, seatNumbersStorageKey]);\n    \n    // Save seat selections to sessionStorage whenever they change\n    useEffect(() => {\n        try {\n            sessionStorage.setItem(seatStorageKey, JSON.stringify(selectedSeats));\n            sessionStorage.setItem(seatNumbersStorageKey, JSON.stringify(selectedSeatNumbers));\n            console.log('Saved selected seats to storage:', selectedSeats);\n        } catch (error) {\n            console.error('Error saving seats to sessionStorage:', error);\n        }\n    }, [selectedSeats, selectedSeatNumbers, seatStorageKey, seatNumbersStorageKey]);\n    \n    // Periodically check for updates from other tabs/windows\n    useEffect(() => {\n        const checkForUpdates = () => {\n            const now = Date.now();\n            // Only check every 2 seconds at most\n            if (now - lastSeatCheckTime < 2000) return;\n            \n            try {\n                const storedSeats = sessionStorage.getItem(seatStorageKey);\n                if (storedSeats) {\n                    const parsedSeats = JSON.parse(storedSeats);\n                    // Compare with current state and update if different\n                    if (JSON.stringify(parsedSeats) !== JSON.stringify(selectedSeats)) {\n                        console.log('Detected seat selection change from another tab, updating...');\n                        setSelectedSeats(parsedSeats);\n                    }\n                }\n                \n                const storedSeatNumbers = sessionStorage.getItem(seatNumbersStorageKey);\n                if (storedSeatNumbers) {\n                    const parsedSeatNumbers = JSON.parse(storedSeatNumbers);\n                    // Compare with current state and update if different\n                    if (JSON.stringify(parsedSeatNumbers) !== JSON.stringify(selectedSeatNumbers)) {\n                        setSelectedSeatNumbers(parsedSeatNumbers);\n                    }\n                }\n                \n                setLastSeatCheckTime(now);\n            } catch (error) {\n                console.error('Error checking for updates:', error);\n            }\n        };\n        \n        // Set up interval for periodic checks\n        const intervalId = setInterval(checkForUpdates, 1000);\n        \n        // Clean up\n        return () => clearInterval(intervalId);\n    }, [selectedSeats, selectedSeatNumbers, lastSeatCheckTime, seatStorageKey, seatNumbersStorageKey]);\n\n    // Check if this flight exists in database or if it's an API flight\n    useEffect(() => {\n        const checkFlight = async () => {\n            setIsLoading(true);\n            try {\n                const token = localStorage.getItem('token');\n                if (!token) {\n                    setError('Authentication required');\n                    navigate('/login');\n                    return;\n                }\n\n                // Try to fetch flight from database\n                const response = await axios.get(`http://localhost:8080/api/flights/${flightId}`, {\n                    headers: {\n                        'Authorization': `Bearer ${token}`\n                    }\n                });\n\n                setFlightData(response.data);\n                setIsApiSourced(response.data.apiSourced === true);\n                setIsFlightSaved(true);\n            } catch (err) {\n                console.error('Error checking flight:', err);\n                setError('Could not retrieve flight information. Please try again.');\n                \n                // Check if this is an API flight that wasn't saved properly\n                try {\n                    // Try to get flight from session storage (it might have been stored during search)\n                    const storedFlights = sessionStorage.getItem('searchResults');\n                    if (storedFlights) {\n                        const parsedFlights = JSON.parse(storedFlights);\n                        const apiFlight = parsedFlights.find((f: Flight) => f.id === flightIdNumber);\n                        \n                        if (apiFlight && apiFlight.apiSourced) {\n                            setFlightData(apiFlight);\n                            setIsApiSourced(true);\n                            setIsFlightSaved(false);\n                            setError(null); // Clear error as we found the flight\n                        }\n                    }\n                } catch (storageErr) {\n                    console.error('Error checking session storage:', storageErr);\n                }\n            } finally {\n                setIsLoading(false);\n            }\n        };\n\n        checkFlight();\n    }, [flightId, navigate, flightIdNumber]);\n\n    // Handle API-sourced flight that wasn't saved to DB\n    useEffect(() => {\n        const saveFlightIfNeeded = async () => {\n            if (flightData && isApiSourced && !isFlightSaved) {\n                setIsLoading(true);\n                setError(null);\n                \n                try {\n                    const token = localStorage.getItem('token');\n                    if (!token) {\n                        setError('Authentication required');\n                        navigate('/login');\n                        return;\n                    }\n                    \n                    // Save API flight to database\n                    const savedFlight = await saveApiFlightToDatabase(flightData, token);\n                    console.log('API flight saved or found in database:', savedFlight);\n                    \n                    if (savedFlight && savedFlight.id) {\n                        // Check if we're already on this flight's page\n                        if (savedFlight.id.toString() !== flightId) {\n                            console.log(`Redirecting from temporary ID ${flightId} to permanent flight ID ${savedFlight.id}`);\n                            // Redirect to the new flight's seat selection page\n                            navigate(`/flights/${savedFlight.id}/seats`, { replace: true });\n                        } else {\n                            console.log('Already on the correct flight page, no redirect needed');\n                            // Just update the state to show the flight is saved\n                            setIsFlightSaved(true);\n                            setFlightData(savedFlight);\n                        }\n                    } else {\n                        throw new Error('Failed to save flight to database');\n                    }\n                } catch (err) {\n                    console.error('Error saving API flight to database:', err);\n                    setError('Failed to prepare flight for booking. Please try searching again.');\n                } finally {\n                    setIsLoading(false);\n                }\n            }\n        };\n        \n        saveFlightIfNeeded();\n    }, [flightData, isApiSourced, isFlightSaved, navigate, flightId]);\n\n    // Initialize passengers when seats change\n    useEffect(() => {\n        if (selectedSeats.length > 0) {\n            // Create or update passenger entries for each selected seat\n            const updatedPassengers = selectedSeats.map((seatId, index) => {\n                // Try to find existing passenger for this seat\n                const existingPassenger = passengers.find(p => p.seatId === seatId);\n                if (existingPassenger) {\n                    return existingPassenger;\n                }\n                \n                // Create new passenger entry\n                return {\n                    firstName: '',\n                    lastName: '',\n                    email: '',\n                    phone: '',\n                    age: '',\n                    seatId: seatId,\n                    seatNumber: selectedSeatNumbers[index] || 'Unknown'\n                };\n            });\n            \n            // Remove passengers for seats that are no longer selected\n            setPassengers(updatedPassengers);\n        } else {\n            setPassengers([]);\n        }\n    }, [selectedSeats, selectedSeatNumbers]);\n\n    // Handle seat selection toggle with improved error recovery and cross-browser synchronization\n    const handleSeatSelect = (seatId: number, seatNumber: string) => {\n        try {\n            if (selectedSeats.includes(seatId)) {\n                // Deselect seat\n                const updatedSeats = selectedSeats.filter(id => id !== seatId);\n                const updatedSeatNumbers = selectedSeatNumbers.filter(num => num !== seatNumber);\n                \n                setSelectedSeats(updatedSeats);\n                setSelectedSeatNumbers(updatedSeatNumbers);\n                \n                // Update session storage immediately for cross-browser sync\n                sessionStorage.setItem(seatStorageKey, JSON.stringify(updatedSeats));\n                sessionStorage.setItem(seatNumbersStorageKey, JSON.stringify(updatedSeatNumbers));\n                \n                setSuccessMessage(`Seat ${seatNumber} removed from selection`);\n            } else {\n                // Check if we're at maximum seat selection (e.g., 10 seats)\n                if (selectedSeats.length >= 10) {\n                    setError(\"You can only select up to 10 seats at once.\");\n                    return;\n                }\n                \n                // Select seat\n                const updatedSeats = [...selectedSeats, seatId];\n                const updatedSeatNumbers = [...selectedSeatNumbers, seatNumber];\n                \n                setSelectedSeats(updatedSeats);\n                setSelectedSeatNumbers(updatedSeatNumbers);\n                \n                // Update session storage immediately for cross-browser sync\n                sessionStorage.setItem(seatStorageKey, JSON.stringify(updatedSeats));\n                sessionStorage.setItem(seatNumbersStorageKey, JSON.stringify(updatedSeatNumbers));\n                \n                setSuccessMessage(`Seat ${seatNumber} added to selection`);\n            }\n        } catch (err) {\n            console.error(\"Error handling seat selection:\", err);\n            setError(\"Failed to update seat selection. Please try again.\");\n        }\n    };\n\n    // Improved passenger info validation\n    const validatePassengerInfo = () => {\n        const errors: Record<string, string> = {};\n        let isValid = true;\n        \n        passengers.forEach((passenger, index) => {\n            const passengerPrefix = `passenger-${index}`;\n            \n            if (!passenger.firstName.trim()) {\n                errors[`${passengerPrefix}-firstName`] = \"First name is required\";\n                isValid = false;\n            }\n            \n            if (!passenger.lastName.trim()) {\n                errors[`${passengerPrefix}-lastName`] = \"Last name is required\";\n                isValid = false;\n            }\n            \n            // Email validation (optional field)\n            if (passenger.email && !passenger.email.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/)) {\n                errors[`${passengerPrefix}-email`] = \"Please enter a valid email address\";\n                isValid = false;\n            }\n            \n            // Phone validation (optional field)\n            if (passenger.phone && !passenger.phone.match(/^[0-9+\\-\\s()]{7,20}$/)) {\n                errors[`${passengerPrefix}-phone`] = \"Please enter a valid phone number\";\n                isValid = false;\n            }\n            \n            // Age validation (optional field)\n            if (passenger.age && (isNaN(Number(passenger.age)) || Number(passenger.age) < 0 || Number(passenger.age) > 120)) {\n                errors[`${passengerPrefix}-age`] = \"Please enter a valid age (0-120)\";\n                isValid = false;\n            }\n        });\n        \n        setFormErrors(errors);\n        return isValid;\n    };\n\n    // Handle passenger dialog close with confirmation if there are changes\n    const handlePassengerDialogClose = () => {\n        // Check if passenger info has been entered\n        const hasEnteredData = passengers.some(p => \n            p.firstName.trim() || p.lastName.trim() || p.email.trim() || p.phone.trim() || p.age\n        );\n        \n        if (hasEnteredData && Object.keys(formErrors).length === 0) {\n            if (window.confirm(\"Are you sure you want to close? Your passenger information will be saved.\")) {\n                setPassengerDialogOpen(false);\n            }\n        } else {\n            setPassengerDialogOpen(false);\n        }\n    };\n\n    // Enhanced booking confirmation with better error recovery\n    const handleBookingConfirmation = async () => {\n        try {\n            if (selectedSeats.length === 0) {\n                setError('Please select at least one seat to proceed.');\n                return;\n            }\n\n            // Open passenger info dialog if not already filled out or contains errors\n            if (!validatePassengerInfo()) {\n                setPassengerDialogOpen(true);\n                return;\n            }\n\n            // Show a loading indicator\n            setIsLoading(true);\n            setError(null);\n            \n            // Get authentication token\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('You must be logged in to book seats.');\n                setIsLoading(false);\n                return;\n            }\n            \n            try {\n                // Format passengers for API\n                const formattedPassengers = passengers.map(p => ({\n                    firstName: p.firstName.trim(),\n                    lastName: p.lastName.trim(),\n                    email: p.email.trim() || undefined,\n                    phone: p.phone.trim() || undefined,\n                    age: p.age ? parseInt(p.age, 10) : undefined,\n                    seatId: p.seatId\n                }));\n\n                // Create a booking on the server\n                console.log('Creating booking for seats:', selectedSeats);\n                const bookingResult = await createBooking(flightId, selectedSeats, token, formattedPassengers);\n                \n                if (bookingResult && bookingResult.id) {\n                    console.log('Booking created successfully:', bookingResult);\n                    \n                    // Navigate to confirmation page\n                    navigate(`/booking-confirmation/${bookingResult.id}`);\n                } else {\n                    throw new Error('Invalid booking response');\n                }\n            } catch (bookError: any) {\n                console.error('Error creating booking:', bookError);\n                \n                if (bookError.status === 400) {\n                    setError('One or more seats are no longer available. Please refresh and try again.');\n                } else if (bookError.status === 401) {\n                    setError('Your session has expired. Please log in again.');\n                    setTimeout(() => navigate('/login?expired=true'), 2000);\n                } else if (!navigator.onLine) {\n                    setError('No internet connection. Please check your network and try again.');\n                } else {\n                    setError(bookError.message || 'Failed to create booking. Please try again.');\n                }\n                \n                setIsLoading(false);\n            }\n        } catch (err: any) {\n            setError('Failed to process booking: ' + (err.message || 'Unknown error'));\n            console.error('Booking error:', err);\n            setIsLoading(false);\n        }\n    };\n    \n    // Field error helper\n    const getFieldError = (passengerIndex: number, field: string): string | undefined => {\n        return formErrors[`passenger-${passengerIndex}-${field}`];\n    };\n    \n    // Handle passenger information change with improved validation\n    const handlePassengerChange = (seatId: number, field: keyof PassengerForm, value: string) => {\n        setPassengers(prev => \n            prev.map((passenger, index) => {\n                if (passenger.seatId === seatId) {\n                    // Clear the specific error when the field is edited\n                    const errorKey = `passenger-${index}-${field}`;\n                    if (formErrors[errorKey]) {\n                        const updatedErrors = {...formErrors};\n                        delete updatedErrors[errorKey];\n                        setFormErrors(updatedErrors);\n                    }\n                    \n                    return { ...passenger, [field]: value };\n                }\n                return passenger;\n            })\n        );\n    };\n\n    // Open dialog to enter passenger information\n    const handlePassengerInfoClick = () => {\n        setPassengerDialogOpen(true);\n    };\n\n    return (\n        <Container maxWidth=\"md\">\n            <Paper sx={{ p: 3, mt: 3, position: 'relative' }}>\n                {/* Use the improved error component */}\n                <ErrorAlert \n                    error={error} \n                    onClose={() => setError(null)}\n                />\n\n                {/* Selected seats display */}\n                {selectedSeats.length > 0 && (\n                    <Box sx={{ mb: 3, p: 2, bgcolor: '#f5f5f5', borderRadius: 1 }}>\n                        <Typography variant=\"subtitle1\" gutterBottom>\n                            Selected Seats ({selectedSeats.length}):\n                        </Typography>\n                        <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1 }}>\n                            {selectedSeatNumbers.map((seatNum, index) => (\n                                <Chip \n                                    key={index} \n                                    label={seatNum} \n                                    color=\"primary\" \n                                    onDelete={() => handleSeatSelect(selectedSeats[index], seatNum)}\n                                />\n                            ))}\n                        </Box>\n                    </Box>\n                )}\n\n                <SeatSelection\n                    flightId={flightIdNumber}\n                    onSeatSelect={(seatId, seatNumber) => handleSeatSelect(seatId, seatNumber)}\n                    selectedSeats={selectedSeats}\n                />\n                \n                {/* Booking actions */}\n                <Box sx={{ mt: 3, display: 'flex', justifyContent: 'space-between' }}>\n                    <Button \n                        variant=\"outlined\" \n                        onClick={() => navigate(-1)}\n                        disabled={isLoading}\n                    >\n                        Back\n                    </Button>\n                    \n                    <Box sx={{ display: 'flex', gap: 2 }}>\n                        {selectedSeats.length > 0 && (\n                            <Button\n                                variant=\"outlined\"\n                                color=\"primary\"\n                                onClick={handlePassengerInfoClick}\n                                disabled={isLoading}\n                            >\n                                Enter Passenger Info\n                            </Button>\n                        )}\n                        \n                        <Button \n                            variant=\"contained\"\n                            color=\"primary\"\n                            disabled={selectedSeats.length === 0 || isLoading}\n                            onClick={handleBookingConfirmation}\n                        >\n                            {isLoading ? <CircularProgress size={24} /> : `Book ${selectedSeats.length} Seat${selectedSeats.length !== 1 ? 's' : ''}`}\n                        </Button>\n                    </Box>\n                </Box>\n\n                {/* Overlay loading indicator */}\n                {isLoading && (\n                    <Box sx={{ \n                        position: 'absolute', \n                        top: 0, \n                        left: 0, \n                        right: 0, \n                        bottom: 0, \n                        display: 'flex', \n                        alignItems: 'center', \n                        justifyContent: 'center',\n                        backgroundColor: 'rgba(255, 255, 255, 0.7)', \n                        zIndex: 10 \n                    }}>\n                        <CircularProgress />\n                    </Box>\n                )}\n                \n                {/* Enhanced Passenger Information Dialog */}\n                <Dialog \n                    open={passengerDialogOpen} \n                    onClose={handlePassengerDialogClose}\n                    maxWidth=\"md\"\n                    fullWidth\n                >\n                    <DialogTitle>\n                        <Typography variant=\"h6\">Passenger Information</Typography>\n                    </DialogTitle>\n                    <DialogContent>\n                        <Typography variant=\"subtitle2\" sx={{ mb: 2 }}>\n                            Please enter information for each passenger. Fields marked with * are required.\n                        </Typography>\n                        \n                        {passengers.map((passenger, index) => (\n                            <Box key={passenger.seatId} sx={{ mb: 3 }}>\n                                <Typography variant=\"subtitle1\" sx={{ fontWeight: 'bold', mb: 1 }}>\n                                    Passenger {index + 1} - Seat {passenger.seatNumber}\n                                </Typography>\n                                <Grid container spacing={2}>\n                                    <Grid item xs={12} sm={6}>\n                                        <TextField\n                                            fullWidth\n                                            required\n                                            label=\"First Name\"\n                                            value={passenger.firstName}\n                                            onChange={(e) => handlePassengerChange(passenger.seatId, 'firstName', e.target.value)}\n                                            error={!!getFieldError(index, 'firstName')}\n                                            helperText={getFieldError(index, 'firstName')}\n                                        />\n                                    </Grid>\n                                    <Grid item xs={12} sm={6}>\n                                        <TextField\n                                            fullWidth\n                                            required\n                                            label=\"Last Name\"\n                                            value={passenger.lastName}\n                                            onChange={(e) => handlePassengerChange(passenger.seatId, 'lastName', e.target.value)}\n                                            error={!!getFieldError(index, 'lastName')}\n                                            helperText={getFieldError(index, 'lastName')}\n                                        />\n                                    </Grid>\n                                    <Grid item xs={12} sm={6}>\n                                        <TextField\n                                            fullWidth\n                                            label=\"Email\"\n                                            type=\"email\"\n                                            value={passenger.email}\n                                            onChange={(e) => handlePassengerChange(passenger.seatId, 'email', e.target.value)}\n                                            error={!!getFieldError(index, 'email')}\n                                            helperText={getFieldError(index, 'email')}\n                                        />\n                                    </Grid>\n                                    <Grid item xs={12} sm={6}>\n                                        <TextField\n                                            fullWidth\n                                            label=\"Phone\"\n                                            value={passenger.phone}\n                                            onChange={(e) => handlePassengerChange(passenger.seatId, 'phone', e.target.value)}\n                                            error={!!getFieldError(index, 'phone')}\n                                            helperText={getFieldError(index, 'phone')}\n                                        />\n                                    </Grid>\n                                    <Grid item xs={12} sm={6}>\n                                        <TextField\n                                            fullWidth\n                                            label=\"Age\"\n                                            type=\"number\"\n                                            inputProps={{ min: 0, max: 120 }}\n                                            value={passenger.age}\n                                            onChange={(e) => handlePassengerChange(passenger.seatId, 'age', e.target.value)}\n                                            error={!!getFieldError(index, 'age')}\n                                            helperText={getFieldError(index, 'age')}\n                                        />\n                                    </Grid>\n                                </Grid>\n                                {index < passengers.length - 1 && <Divider sx={{ mt: 2 }} />}\n                            </Box>\n                        ))}\n                    </DialogContent>\n                    <DialogActions>\n                        <Button onClick={handlePassengerDialogClose}>Close</Button>\n                        <Button \n                            onClick={() => {\n                                if (validatePassengerInfo()) {\n                                    setPassengerDialogOpen(false);\n                                    handleBookingConfirmation();\n                                }\n                            }}\n                            color=\"primary\"\n                            variant=\"contained\"\n                        >\n                            Confirm & Book\n                        </Button>\n                    </DialogActions>\n                </Dialog>\n                \n                {/* Success message snackbar */}\n                <Snackbar \n                    open={!!successMessage} \n                    autoHideDuration={3000} \n                    onClose={() => setSuccessMessage(null)}\n                    anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n                >\n                    <Alert onClose={() => setSuccessMessage(null)} severity=\"success\">\n                        {successMessage}\n                    </Alert>\n                </Snackbar>\n            </Paper>\n        </Container>\n    );\n};\n\nexport default SeatSelectionWrapper;","import React from 'react';\r\nimport {\r\n    Container,\r\n    Typography,\r\n    Box,\r\n    Button,\r\n    Paper,\r\n    Grid\r\n} from '@mui/material';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport FlightTakeoffIcon from '@mui/icons-material/FlightTakeoff';\r\nimport PersonIcon from '@mui/icons-material/Person';\r\nimport HistoryIcon from '@mui/icons-material/History';\r\n\r\nconst Home = () => {\r\n    const navigate = useNavigate();\r\n\r\n    return (\r\n        <Container maxWidth=\"lg\" sx={{ mt: 4 }}>\r\n            <Box textAlign=\"center\" mb={4}>\r\n                <Typography variant=\"h3\" gutterBottom>\r\n                    Welcome to Ticket Booking\r\n                </Typography>\r\n                <Typography variant=\"h6\" color=\"textSecondary\">\r\n                    Book your flights with ease\r\n                </Typography>\r\n            </Box>\r\n\r\n            <Grid container spacing={3}>\r\n                <Grid item xs={12} md={4}>\r\n                    <Paper\r\n                        sx={{\r\n                            p: 3,\r\n                            textAlign: 'center',\r\n                            height: '100%',\r\n                            display: 'flex',\r\n                            flexDirection: 'column',\r\n                            alignItems: 'center'\r\n                        }}\r\n                    >\r\n                        <FlightTakeoffIcon sx={{ fontSize: 60, mb: 2, color: 'primary.main' }} />\r\n                        <Typography variant=\"h5\" gutterBottom>\r\n                            Search Flights\r\n                        </Typography>\r\n                        <Typography variant=\"body1\" sx={{ mb: 2 }}>\r\n                            Find the best flights for your journey\r\n                        </Typography>\r\n                        <Button\r\n                            variant=\"contained\"\r\n                            onClick={() => navigate('/flights')}\r\n                            sx={{ mt: 'auto' }}\r\n                        >\r\n                            Search Now\r\n                        </Button>\r\n                    </Paper>\r\n                </Grid>\r\n\r\n                <Grid item xs={12} md={4}>\r\n                    <Paper\r\n                        sx={{\r\n                            p: 3,\r\n                            textAlign: 'center',\r\n                            height: '100%',\r\n                            display: 'flex',\r\n                            flexDirection: 'column',\r\n                            alignItems: 'center'\r\n                        }}\r\n                    >\r\n                        <PersonIcon sx={{ fontSize: 60, mb: 2, color: 'primary.main' }} />\r\n                        <Typography variant=\"h5\" gutterBottom>\r\n                            My Profile\r\n                        </Typography>\r\n                        <Typography variant=\"body1\" sx={{ mb: 2 }}>\r\n                            Manage your account and preferences\r\n                        </Typography>\r\n                        <Button\r\n                            variant=\"contained\"\r\n                            onClick={() => navigate('/profile')}\r\n                            sx={{ mt: 'auto' }}\r\n                        >\r\n                            View Profile\r\n                        </Button>\r\n                    </Paper>\r\n                </Grid>\r\n\r\n                <Grid item xs={12} md={4}>\r\n                    <Paper\r\n                        sx={{\r\n                            p: 3,\r\n                            textAlign: 'center',\r\n                            height: '100%',\r\n                            display: 'flex',\r\n                            flexDirection: 'column',\r\n                            alignItems: 'center'\r\n                        }}\r\n                    >\r\n                        <HistoryIcon sx={{ fontSize: 60, mb: 2, color: 'primary.main' }} />\r\n                        <Typography variant=\"h5\" gutterBottom>\r\n                            Booking History\r\n                        </Typography>\r\n                        <Typography variant=\"body1\" sx={{ mb: 2 }}>\r\n                            View and manage your bookings\r\n                        </Typography>\r\n                        <Button\r\n                            variant=\"contained\"\r\n                            onClick={() => navigate('/bookings')}\r\n                            sx={{ mt: 'auto' }}\r\n                        >\r\n                            View Bookings\r\n                        </Button>\r\n                    </Paper>\r\n                </Grid>\r\n            </Grid>\r\n        </Container>\r\n    );\r\n};\r\n\r\nexport default Home;","import React, { useState, useEffect } from 'react';\r\nimport {\r\n    Container,\r\n    Paper,\r\n    Typography,\r\n    Box,\r\n    TextField,\r\n    Button,\r\n    Grid,\r\n    Avatar,\r\n    Divider,\r\n    CircularProgress,\r\n    Alert,\r\n    FormHelperText\r\n} from '@mui/material';\r\nimport PersonIcon from '@mui/icons-material/Person';\r\nimport { getUserProfile, updateUserProfile } from '../../services/api';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport jwt_decode from 'jwt-decode';\r\nimport axios from 'axios';\r\n\r\ninterface UserProfile {\r\n    firstName?: string;\r\n    lastName?: string;\r\n    email: string;\r\n    phone?: string;\r\n    address?: string;\r\n}\r\n\r\ninterface JwtPayload {\r\n    sub: string;\r\n    email: string;\r\n    role: string;\r\n    exp: number;\r\n    iat: number;\r\n}\r\n\r\nconst Profile = () => {\r\n    const [profile, setProfile] = useState<UserProfile | null>(null);\r\n    const [isEditing, setIsEditing] = useState(false);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n    const [success, setSuccess] = useState('');\r\n    const [apiAvailable, setApiAvailable] = useState(true);\r\n    const [emailChanged, setEmailChanged] = useState(false);\r\n    const { user, logout } = useAuth();\r\n\r\n    useEffect(() => {\r\n        const fetchProfile = async () => {\r\n            setError('');\r\n            setSuccess('');\r\n            setLoading(true);\r\n            try {\r\n                const token = localStorage.getItem('token');\r\n                if (!token) {\r\n                    throw new Error('User not authenticated.');\r\n                }\r\n\r\n                try {\r\n                    // Try to get profile from API with correct URL and headers\r\n                    const userData = await axios.get('http://localhost:8080/api/user/profile', {\r\n                        headers: {\r\n                            'Authorization': `Bearer ${token}`,\r\n                            'Content-Type': 'application/json'\r\n                        }\r\n                    });\r\n                    setProfile(userData.data);\r\n                    setApiAvailable(true);\r\n                } catch (apiError) {\r\n                    console.error(' Error fetching profile:', apiError);\r\n                    \r\n                    // Fallback to JWT data if API fails\r\n                    setApiAvailable(false);\r\n                    const decoded = jwt_decode<JwtPayload>(token);\r\n                    \r\n                    // Use user data from AuthContext if available\r\n                    if (user) {\r\n                        setProfile({\r\n                            email: user.email,\r\n                            firstName: user.firstName || '',\r\n                            lastName: user.lastName || ''\r\n                        });\r\n                    } else {\r\n                        // Or directly from JWT if AuthContext doesn't have it\r\n                        setProfile({\r\n                            email: decoded.email\r\n                        });\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error(' Error in profile component:', error);\r\n                setError('Failed to load profile.');\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchProfile();\r\n    }, [user]);\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (profile) {\r\n            const { name, value } = e.target;\r\n            if (name === 'email' && value !== profile.email) {\r\n                setEmailChanged(true);\r\n            }\r\n            setProfile({\r\n                ...profile,\r\n                [name]: value\r\n            });\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setSuccess('');\r\n        setLoading(true);\r\n\r\n        // If API is not available, just simulate success\r\n        if (!apiAvailable) {\r\n            setTimeout(() => {\r\n                setSuccess('Profile updated successfully! (Note: Changes are not saved to backend)');\r\n                setIsEditing(false);\r\n                setLoading(false);\r\n            }, 500);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const token = localStorage.getItem('token');\r\n            if (!token) {\r\n                throw new Error('User not authenticated.');\r\n            }\r\n            \r\n            // Use axios instead of the updateUserProfile function\r\n            const response = await axios.put('http://localhost:8080/api/user/update', profile, {\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`,\r\n                    'Content-Type': 'application/json'\r\n                }\r\n            });\r\n            \r\n            if (emailChanged) {\r\n                setSuccess('Email updated successfully! You will be logged out to apply changes.');\r\n                // Set a timeout to allow the user to see the success message before logout\r\n                setTimeout(() => {\r\n                    // Update localStorage with new email\r\n                    localStorage.setItem('userEmail', profile?.email || '');\r\n                    // Log the user out to refresh the token\r\n                    logout();\r\n                }, 3000);\r\n            } else {\r\n                setSuccess('Profile updated successfully!');\r\n                setIsEditing(false);\r\n            }\r\n        } catch (error: any) {\r\n            console.error(' Error updating profile:', error);\r\n            \r\n            // Check for specific error message about email already in use\r\n            if (error.response && error.response.data && error.response.data.message) {\r\n                setError(error.response.data.message);\r\n            } else {\r\n                setError('Failed to update profile. The API endpoint may not be available.');\r\n                setApiAvailable(false);\r\n            }\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" height=\"80vh\">\r\n                <CircularProgress />\r\n            </Box>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <Container maxWidth=\"md\" sx={{ mt: 4 }}>\r\n            <Paper elevation={3} sx={{ p: 4 }}>\r\n                <Box display=\"flex\" alignItems=\"center\" mb={4}>\r\n                    <Avatar sx={{ width: 80, height: 80, mr: 2, bgcolor: 'primary.main' }}>\r\n                        <PersonIcon sx={{ fontSize: 40 }} />\r\n                    </Avatar>\r\n                    <Typography variant=\"h4\">My Profile</Typography>\r\n                </Box>\r\n\r\n                <Divider sx={{ mb: 4 }} />\r\n\r\n                {!apiAvailable && (\r\n                    <Alert severity=\"warning\" sx={{ mb: 3 }}>\r\n                        Profile API is not available. Displaying information from your login credentials. \r\n                        Changes may not be saved to the backend.\r\n                    </Alert>\r\n                )}\r\n                \r\n                {error && <Alert severity=\"error\" sx={{ mb: 3 }}>{error}</Alert>}\r\n                {success && <Alert severity=\"success\" sx={{ mb: 3 }}>{success}</Alert>}\r\n\r\n                <Box component=\"form\" onSubmit={handleSubmit}>\r\n                    <Grid container spacing={3}>\r\n                        <Grid item xs={12} sm={6}>\r\n                            <TextField\r\n                                fullWidth\r\n                                label=\"First Name\"\r\n                                name=\"firstName\"\r\n                                value={profile?.firstName || ''}\r\n                                onChange={handleChange}\r\n                                disabled={!isEditing}\r\n                            />\r\n                        </Grid>\r\n                        <Grid item xs={12} sm={6}>\r\n                            <TextField\r\n                                fullWidth\r\n                                label=\"Last Name\"\r\n                                name=\"lastName\"\r\n                                value={profile?.lastName || ''}\r\n                                onChange={handleChange}\r\n                                disabled={!isEditing}\r\n                            />\r\n                        </Grid>\r\n                        <Grid item xs={12}>\r\n                            <TextField\r\n                                fullWidth\r\n                                label=\"Email\"\r\n                                name=\"email\"\r\n                                type=\"email\"\r\n                                value={profile?.email || ''}\r\n                                onChange={handleChange}\r\n                                disabled={!isEditing}\r\n                                required\r\n                                error={emailChanged}\r\n                            />\r\n                            {isEditing && emailChanged && (\r\n                                <FormHelperText sx={{ color: 'warning.main' }}>\r\n                                    Changing your email will require you to log in again.\r\n                                </FormHelperText>\r\n                            )}\r\n                            {isEditing && (\r\n                                <FormHelperText>\r\n                                    This email will be used for ticket notifications and account recovery.\r\n                                </FormHelperText>\r\n                            )}\r\n                        </Grid>\r\n                        <Grid item xs={12}>\r\n                            <TextField\r\n                                fullWidth\r\n                                label=\"Phone\"\r\n                                name=\"phone\"\r\n                                value={profile?.phone || ''}\r\n                                onChange={handleChange}\r\n                                disabled={!isEditing}\r\n                            />\r\n                        </Grid>\r\n                        <Grid item xs={12}>\r\n                            <TextField\r\n                                fullWidth\r\n                                label=\"Address\"\r\n                                name=\"address\"\r\n                                multiline\r\n                                rows={3}\r\n                                value={profile?.address || ''}\r\n                                onChange={handleChange}\r\n                                disabled={!isEditing}\r\n                            />\r\n                        </Grid>\r\n                    </Grid>\r\n\r\n                    <Box sx={{ mt: 4, display: 'flex', gap: 2, justifyContent: 'flex-end' }}>\r\n                        {isEditing ? (\r\n                            <>\r\n                                <Button variant=\"outlined\" onClick={() => {\r\n                                    setIsEditing(false);\r\n                                    setEmailChanged(false);\r\n                                }}>Cancel</Button>\r\n                                <Button type=\"submit\" variant=\"contained\">Save Changes</Button>\r\n                            </>\r\n                        ) : (\r\n                            <Button variant=\"contained\" onClick={() => setIsEditing(true)}>Edit Profile</Button>\r\n                        )}\r\n                    </Box>\r\n                </Box>\r\n            </Paper>\r\n        </Container>\r\n    );\r\n};\r\n\r\nexport default Profile;\r\n","import React, { useEffect, useState } from 'react';\nimport {\n    Container,\n    Paper,\n    Typography,\n    Box,\n    Chip,\n    Button,\n    Grid,\n    Card,\n    CardContent,\n    CardActions,\n    CircularProgress,\n    Alert,\n    Snackbar,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    TextField,\n    MenuItem,\n    Select,\n    FormControl,\n    InputLabel,\n    Pagination,\n    Stack,\n    IconButton,\n    Divider,\n    FormGroup,\n    InputAdornment\n} from '@mui/material';\nimport { AdapterMoment } from '@mui/x-date-pickers/AdapterMoment';\nimport { LocalizationProvider, DatePicker } from '@mui/x-date-pickers';\nimport FlightTakeoffIcon from '@mui/icons-material/FlightTakeoff';\nimport FlightLandIcon from '@mui/icons-material/FlightLand';\nimport AccessTimeIcon from '@mui/icons-material/AccessTime';\nimport EventIcon from '@mui/icons-material/Event';\nimport SearchIcon from '@mui/icons-material/Search';\nimport FilterListIcon from '@mui/icons-material/FilterList';\nimport ClearIcon from '@mui/icons-material/Clear';\nimport moment from 'moment';\nimport { cancelBooking, getUserBookings, getFilteredBookings, getSimpleFilteredBookings, BookingFilterOptions, Booking } from '../../services/api';\nimport { useNavigate } from 'react-router-dom';\n\n// Demo bookings for when the API isn't available\nconst demoBookings: Booking[] = [\n    {\n        id: 12345,\n        flightId: \"1\",\n        seatIds: [101, 102],\n        timestamp: moment().subtract(5, 'days').format(),\n        status: 'completed',\n        passengers: [\n            {\n                id: 1001,\n                firstName: \"John\",\n                lastName: \"Doe\",\n                email: \"john.doe@example.com\",\n                phone: \"9876543210\",\n                age: 35,\n                seatId: 101\n            },\n            {\n                id: 1002,\n                firstName: \"Jane\",\n                lastName: \"Doe\",\n                email: \"jane.doe@example.com\",\n                phone: \"9876543211\",\n                age: 32,\n                seatId: 102\n            }\n        ]\n    },\n    {\n        id: 12346,\n        flightId: \"2\",\n        seatIds: [204],\n        timestamp: moment().subtract(1, 'days').format(),\n        status: 'confirmed',\n        passengers: [\n            {\n                id: 1003,\n                firstName: \"Alice\",\n                lastName: \"Smith\",\n                email: \"alice.smith@example.com\",\n                phone: \"9876543212\",\n                age: 28,\n                seatId: 204\n            }\n        ]\n    },\n    {\n        id: 12347,\n        flightId: \"3\",\n        seatIds: [305, 306],\n        timestamp: moment().subtract(10, 'days').format(),\n        status: 'cancelled',\n        passengers: [\n            {\n                id: 1004,\n                firstName: \"Bob\",\n                lastName: \"Johnson\",\n                email: \"bob.johnson@example.com\",\n                phone: \"9876543213\",\n                age: 42,\n                seatId: 305\n            },\n            {\n                id: 1005,\n                firstName: \"Carol\",\n                lastName: \"Johnson\",\n                email: \"carol.johnson@example.com\",\n                phone: \"9876543214\",\n                age: 38,\n                seatId: 306\n            }\n        ]\n    }\n];\n\nconst BookingHistory = () => {\n    const [bookings, setBookings] = useState<Booking[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [successMessage, setSuccessMessage] = useState<string | null>(null);\n    const [confirmDialogOpen, setConfirmDialogOpen] = useState(false);\n    const [selectedBookingId, setSelectedBookingId] = useState<number | null>(null);\n    const [showFilters, setShowFilters] = useState(false);\n    const [apiAvailable, setApiAvailable] = useState(true);\n    \n    // Filter states\n    const [filters, setFilters] = useState<BookingFilterOptions>({\n        status: '',\n        bookingId: undefined,\n        flightDate: '',\n        page: 0,\n        size: 5,\n        sortBy: 'bookingTime',\n        direction: 'desc'\n    });\n    \n    // Pagination states\n    const [totalPages, setTotalPages] = useState(1);\n    const [totalItems, setTotalItems] = useState(0);\n    \n    // Date picker states\n    const [flightDateValue, setFlightDateValue] = useState<moment.Moment | null>(null);\n    \n    // Create a retry counter state to help with transaction issues\n    const [retryCount, setRetryCount] = useState(0);\n    const maxRetries = 2; // Maximum number of retries for transaction errors\n    \n    const navigate = useNavigate();\n\n    useEffect(() => {\n        fetchBookings();\n    }, [filters.page, filters.size, filters.sortBy, filters.direction]);\n\n    const fetchBookings = async () => {\n        setLoading(true);\n        setError(null);\n        console.log('[BookingHistory] Fetching bookings with filters:', JSON.stringify(filters));\n        \n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                console.error('[BookingHistory] No token found in localStorage');\n                setError('You must be logged in to view bookings');\n                navigate('/login');\n                return;\n            }\n            \n            console.log('[BookingHistory] Token from localStorage:', token.substring(0, 15) + '...');\n            \n            // Check if filters are active\n            const hasActiveFilters = \n                (filters.status && filters.status !== '') ||\n                (filters.bookingId !== undefined && filters.bookingId !== null) ||\n                (filters.flightDate && filters.flightDate !== '');\n            \n            try {\n                let response;\n                if (hasActiveFilters) {\n                    console.log('[BookingHistory] Using filtered endpoint with filters:', JSON.stringify(filters));\n                    \n                    // Ensure correct parameter types (convert empty strings to undefined)\n                    const cleanedFilters = {\n                        ...filters,\n                        bookingId: filters.bookingId || undefined,\n                        status: filters.status || undefined,\n                        flightDate: filters.flightDate || undefined\n                    };\n                    \n                    console.log('[BookingHistory] Cleaned filters:', JSON.stringify(cleanedFilters));\n                    response = await getFilteredBookings(token, cleanedFilters);\n                    console.log('[BookingHistory] Filtered bookings response:', response);\n                    \n                    if (response && response.bookings) {\n                        console.log(`[BookingHistory] Received ${response.bookings.length} bookings from API`);\n                        setBookings(response.bookings);\n                        setTotalPages(response.totalPages || 1);\n                        setTotalItems(response.totalItems || response.bookings.length);\n                        setApiAvailable(true);\n                    } else if (!apiAvailable) {\n                        // If API is unavailable but we have demo data, filter demo bookings\n                        console.log('[BookingHistory] API response missing bookings array, falling back to demo data');\n                        let filteredDemoBookings = [...demoBookings];\n                        \n                        if (filters.status) {\n                            filteredDemoBookings = filteredDemoBookings.filter(\n                                b => b.status.toLowerCase() === filters.status?.toLowerCase()\n                            );\n                        }\n                        \n                        if (filters.bookingId) {\n                            filteredDemoBookings = filteredDemoBookings.filter(\n                                b => b.id === filters.bookingId\n                            );\n                        }\n                        \n                        setBookings(filteredDemoBookings);\n                    } else {\n                        console.log('[BookingHistory] No bookings found in API response');\n                        setBookings([]);\n                    }\n                } else {\n                    // No filters, get all bookings\n                    console.log('[BookingHistory] Fetching all bookings without filters');\n                    response = await getUserBookings(token);\n                    console.log('[BookingHistory] All bookings response:', response);\n                    \n                    if (Array.isArray(response) && response.length > 0) {\n                        console.log(`[BookingHistory] Received ${response.length} bookings from API`);\n                        setBookings(response);\n                        setApiAvailable(true);\n                    } else if (response && typeof response === 'object' && response.bookings) {\n                        // Handle case where API returns an object with bookings array\n                        console.log(`[BookingHistory] Received ${response.bookings.length} bookings (object format)`);\n                        setBookings(response.bookings);\n                        setApiAvailable(true);\n                    } else if (!apiAvailable) {\n                        // Show demo bookings if API is unavailable\n                        console.log('[BookingHistory] API response format incorrect, using demo data');\n                        setBookings(demoBookings);\n                    } else {\n                        console.log('[BookingHistory] No bookings found in API response');\n                        setBookings([]);\n                    }\n                }\n            } catch (apiError: any) {\n                console.error('[BookingHistory] API Error in fetchBookings:', apiError);\n                console.error('[BookingHistory] Error details:', apiError.message);\n                \n                // If the filtered endpoint fails, try falling back to simple filtering\n                if (hasActiveFilters) {\n                    try {\n                        console.log('[BookingHistory] Falling back to simple filter with status:', filters.status);\n                        const simpleResponse = await getSimpleFilteredBookings(\n                            token, \n                            filters.status,\n                            filters.bookingId\n                        );\n                        \n                        if (simpleResponse && simpleResponse.bookings) {\n                            console.log(`[BookingHistory] Received ${simpleResponse.bookings.length} bookings from simple filter`);\n                            setBookings(simpleResponse.bookings);\n                            setTotalItems(simpleResponse.totalItems || simpleResponse.bookings.length);\n                            setTotalPages(1); // Simple filter doesn't support pagination\n                            setApiAvailable(true);\n                        } else {\n                            console.log('[BookingHistory] Simple filter returned no bookings, using demo data');\n                            setApiAvailable(false);\n                            setBookings(demoBookings);\n                        }\n                    } catch (fallbackError: any) {\n                        console.error('[BookingHistory] Fallback filter also failed:', fallbackError);\n                        console.error('[BookingHistory] Fallback error details:', fallbackError.message);\n                setApiAvailable(false);\n                        setBookings(demoBookings);\n                    }\n                } else {\n                    console.log('[BookingHistory] No fallback attempted, using demo data');\n                    setApiAvailable(false);\n                    setBookings(demoBookings);\n                }\n            }\n        } catch (err: any) {\n            console.error('[BookingHistory] Error in fetchBookings:', err);\n            console.error('[BookingHistory] Error stack:', err.stack);\n            setError('Failed to load bookings. Please try again later.');\n            setApiAvailable(false);\n            setBookings(demoBookings);\n        } finally {\n            setLoading(false);\n        }\n    };\n    \n    const handleFilterChange = (field: keyof BookingFilterOptions, value: any) => {\n        setFilters(prevFilters => ({\n            ...prevFilters,\n            [field]: value,\n            // Reset page when filters change\n            ...(field !== 'page' && { page: 0 })\n        }));\n    };\n    \n    const handleDateChange = (date: moment.Moment | null) => {\n        setFlightDateValue(date);\n        \n        if (date) {\n            // Ensure proper ISO format YYYY-MM-DD\n            const formattedDate = date.format('YYYY-MM-DD');\n            console.log(`Setting flightDate to: ${formattedDate}`);\n            handleFilterChange('flightDate', formattedDate);\n        } else {\n            handleFilterChange('flightDate', '');\n        }\n    };\n    \n    const handleApplyFilters = () => {\n        // Reset page to 0 when applying new filters\n        setFilters(prevFilters => ({\n            ...prevFilters,\n            page: 0\n        }));\n        \n        // Then fetch bookings with updated filters\n        fetchBookings();\n    };\n    \n    const handleResetFilters = () => {\n        // Reset all filters to their default values\n        setFilters({\n            status: '',\n            bookingId: undefined,\n            flightDate: '',\n            page: 0,\n            size: 5,\n            sortBy: 'bookingTime',\n            direction: 'desc'\n        });\n        \n        // Reset date picker state\n        setFlightDateValue(null);\n        \n        // Fetch bookings with reset filters - do this after a short delay to ensure state is updated\n        setTimeout(() => {\n        fetchBookings();\n        }, 0);\n    };\n    \n    const handlePageChange = (event: React.ChangeEvent<unknown>, page: number) => {\n        handleFilterChange('page', page - 1);\n    };\n\n    const handleCancelDialogOpen = (bookingId: number) => {\n        console.log(`Opening cancel dialog for booking ID: ${bookingId}, type: ${typeof bookingId}`);\n        setSelectedBookingId(bookingId);\n        setConfirmDialogOpen(true);\n    };\n    \n    const handleCancelDialogClose = () => {\n        console.log('Closing cancel dialog, selectedBookingId was:', selectedBookingId);\n        setSelectedBookingId(null);\n        setConfirmDialogOpen(false);\n    };\n    \n    const handleCancelBooking = async () => {\n        if (!selectedBookingId) {\n            console.error('Cannot cancel booking: No booking ID selected');\n            return;\n        }\n        \n        console.log(`Attempting to cancel booking ID: ${selectedBookingId}, type: ${typeof selectedBookingId}`);\n        \n        setLoading(true);\n        setError(null);\n        \n        try {\n            // If API is unavailable, simulate cancellation\n            if (!apiAvailable) {\n                console.log('API unavailable, simulating cancellation');\n                setTimeout(() => {\n                    // Update demo booking status\n                    const updatedBookings = bookings.map(booking => {\n                        if (booking.id === selectedBookingId) {\n                            return {\n                                ...booking,\n                                status: 'cancelled' as 'cancelled'\n                            };\n                        }\n                        return booking;\n                    });\n                    \n                    setBookings(updatedBookings);\n                    setSuccessMessage('Booking cancelled successfully! (Demo mode)');\n                    handleCancelDialogClose();\n                    setLoading(false);\n                }, 800);\n                return;\n            }\n            \n            // Real API call\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('You must be logged in to cancel bookings');\n                navigate('/login');\n                return;\n            }\n            \n            // Ensure we're using the correct type\n            const bookingIdToCancel = selectedBookingId;\n            console.log(`Sending cancellation request with ID: ${bookingIdToCancel}, type: ${typeof bookingIdToCancel}`);\n            \n            try {\n                const result = await cancelBooking(bookingIdToCancel.toString(), token);\n                console.log('Cancellation API response:', result);\n                \n                // Update the booking status in the UI without refetching\n                const updatedBookings = bookings.map(booking => {\n                    if (booking.id === selectedBookingId) {\n                        return {\n                            ...booking,\n                            status: 'cancelled' as 'cancelled'\n                        };\n                    }\n                    return booking;\n                });\n                \n                setBookings(updatedBookings);\n            setSuccessMessage('Booking cancelled successfully!');\n                handleCancelDialogClose();\n                setLoading(false);\n            \n                // Optionally refetch after a delay to ensure server state is synchronized\n                setTimeout(() => {\n            fetchBookings();\n                }, 1000);\n            } catch (apiError: any) {\n                console.error('API error details:', {\n                    message: apiError.message,\n                    stack: apiError.stack,\n                    status: apiError.status,\n                    response: apiError.response\n                });\n                \n                // More specific error message based on the error\n                let errorMessage = 'Failed to cancel booking. Please try again later.';\n                \n                if (apiError.message) {\n                    // Extract more detailed message if available\n                    if (apiError.message.includes('not found')) {\n                        errorMessage = 'Booking not found. It may have been already cancelled or deleted.';\n                    } else if (apiError.message.includes('already cancelled')) {\n                        errorMessage = 'This booking is already cancelled.';\n                    } else if (apiError.message.includes('permission')) {\n                        errorMessage = 'You do not have permission to cancel this booking.';\n                    } else {\n                        errorMessage = `Error: ${apiError.message}`;\n                    }\n                }\n                \n                setError(errorMessage);\n                setLoading(false);\n            }\n        } catch (err) {\n            console.error('Error cancelling booking:', err);\n            setError('Failed to cancel booking. Please try again later.');\n            setLoading(false);\n        }\n    };\n    \n    const renderFilters = () => {\n        return (\n            <Paper sx={{ p: 2, mb: 3, mt: 2 }}>\n                <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 2 }}>\n                    <Typography variant=\"h6\">Filters</Typography>\n                    <IconButton onClick={() => setShowFilters(false)} size=\"small\">\n                        <ClearIcon />\n                    </IconButton>\n                </Box>\n                \n                <Grid container spacing={2}>\n                    <Grid item xs={12} sm={6} md={4}>\n                        <FormControl fullWidth size=\"small\">\n                            <InputLabel>Status</InputLabel>\n                            <Select\n                                value={filters.status}\n                                label=\"Status\"\n                                onChange={(e) => handleFilterChange('status', e.target.value)}\n                            >\n                                <MenuItem value=\"\">All</MenuItem>\n                                <MenuItem value=\"confirmed\">Confirmed</MenuItem>\n                                <MenuItem value=\"completed\">Completed</MenuItem>\n                                <MenuItem value=\"cancelled\">Cancelled</MenuItem>\n                            </Select>\n                        </FormControl>\n                    </Grid>\n                    \n                    <Grid item xs={12} sm={6} md={4}>\n                        <TextField\n                            fullWidth\n                            size=\"small\"\n                            label=\"Booking ID\"\n                            type=\"number\"\n                            value={filters.bookingId || ''}\n                            onChange={(e) => handleFilterChange('bookingId', e.target.value ? parseInt(e.target.value) : undefined)}\n                        />\n                    </Grid>\n                    \n                    <Grid item xs={12} sm={6} md={4}>\n                        <LocalizationProvider dateAdapter={AdapterMoment}>\n                            <DatePicker\n                                label=\"Flight Date\"\n                                value={flightDateValue}\n                                onChange={handleDateChange}\n                                slotProps={{ textField: { size: 'small', fullWidth: true } }}\n                            />\n                        </LocalizationProvider>\n                    </Grid>\n                </Grid>\n                \n                <Box sx={{ display: 'flex', justifyContent: 'flex-end', mt: 2, gap: 1 }}>\n                    <Button \n                        variant=\"outlined\" \n                        onClick={handleResetFilters}\n                        startIcon={<ClearIcon />}\n                    >\n                        Reset\n                    </Button>\n                    <Button \n                        variant=\"contained\" \n                        onClick={handleApplyFilters}\n                        startIcon={<SearchIcon />}\n                    >\n                        Apply Filters\n                    </Button>\n                </Box>\n            </Paper>\n        );\n    };\n\n    // Render the booking history page\n    return (\n        <Container maxWidth=\"lg\" sx={{ mt: 4, mb: 4 }}>\n            <Paper \n                elevation={3} \n                sx={{ \n                    p: 3, \n                    borderRadius: '8px',\n                    boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n                }}\n            >\n                <Box \n                    sx={{ \n                        p: 2, \n                        mb: 3, \n                        background: 'linear-gradient(45deg, #E33069 30%, #9C27B0 90%)',\n                        color: 'white',\n                        borderRadius: '8px'\n                    }}\n                >\n                    <Typography variant=\"h5\" component=\"h1\" gutterBottom>\n                        Your Booking History\n                    </Typography>\n                    <Typography variant=\"body2\">\n                        View and manage all your flight bookings in one place\n                    </Typography>\n                </Box>\n\n                {error && (\n                    <Alert \n                        severity=\"error\" \n                        sx={{ \n                            mb: 3,\n                            borderRadius: '8px'\n                        }}\n                    >\n                        {error}\n                    </Alert>\n                )}\n            \n            {loading ? (\n                <Box sx={{ display: 'flex', justifyContent: 'center', my: 4 }}>\n                    <CircularProgress />\n                </Box>\n            ) : bookings.length === 0 ? (\n                <Paper sx={{ p: 4, textAlign: 'center' }}>\n                    <Typography variant=\"h6\" color=\"textSecondary\">\n                        No bookings found\n                    </Typography>\n                    <Typography color=\"textSecondary\" sx={{ mt: 1 }}>\n                        You haven't made any bookings yet or none match your current filters.\n                    </Typography>\n                </Paper>\n            ) : (\n                <>\n                        <Box sx={{ mb: 4, p: 2, backgroundColor: '#F5F8FA', borderRadius: '8px' }}>\n                            <Typography variant=\"h6\" gutterBottom>\n                                Filter Bookings\n                            </Typography>\n                            <Grid container spacing={2}>\n                                <Grid item xs={12} sm={4} md={3}>\n                                    <TextField\n                                        select\n                                        label=\"Booking Status\"\n                                        value={filters.status}\n                                        onChange={(e) => handleFilterChange('status', e.target.value)}\n                                        fullWidth\n                                        margin=\"normal\"\n                                        size=\"small\"\n                                        sx={{\n                                            '& .MuiOutlinedInput-root': {\n                                                borderRadius: '8px',\n                                                bgcolor: '#FFFFFF'\n                                            }\n                                        }}\n                                    >\n                                        <MenuItem value=\"\">All</MenuItem>\n                                        <MenuItem value=\"confirmed\">Confirmed</MenuItem>\n                                        <MenuItem value=\"completed\">Completed</MenuItem>\n                                        <MenuItem value=\"cancelled\">Cancelled</MenuItem>\n                                    </TextField>\n                                </Grid>\n                                <Grid item xs={12} sm={4} md={3}>\n                                    <TextField\n                                        label=\"Booking ID\"\n                                        value={filters.bookingId || ''}\n                                        onChange={(e) => handleFilterChange('bookingId', e.target.value ? parseInt(e.target.value) : undefined)}\n                                        fullWidth\n                                        margin=\"normal\"\n                                        size=\"small\"\n                                        type=\"number\"\n                                        sx={{\n                                            '& .MuiOutlinedInput-root': {\n                                                borderRadius: '8px',\n                                                bgcolor: '#FFFFFF'\n                                            }\n                                        }}\n                                    />\n                                </Grid>\n                                <Grid item xs={12} sm={4} md={3}>\n                                    <LocalizationProvider dateAdapter={AdapterMoment}>\n                                        <DatePicker\n                                            label=\"Flight Date\"\n                                            value={flightDateValue}\n                                            onChange={handleDateChange}\n                                            slotProps={{ \n                                                textField: { \n                                                    fullWidth: true, \n                                                    margin: 'normal', \n                                                    size: 'small',\n                                                    sx: {\n                                                        '& .MuiOutlinedInput-root': {\n                                                            borderRadius: '8px',\n                                                            bgcolor: '#FFFFFF'\n                                                        }\n                                                    }\n                                                } \n                                            }}\n                                        />\n                                    </LocalizationProvider>\n                                </Grid>\n                                <Grid item xs={12} sm={12} md={3}>\n                                    <Box sx={{ display: 'flex', gap: 1, mt: 2 }}>\n                                        <Button \n                                            variant=\"contained\" \n                                            onClick={handleApplyFilters}\n                                            sx={{ \n                                                bgcolor: '#FF7F23',\n                                                '&:hover': {\n                                                    bgcolor: '#E67D2E'\n                                                },\n                                                borderRadius: '8px',\n                                                flexGrow: 1\n                                            }}\n                                        >\n                                            Apply Filters\n                                        </Button>\n                                        <Button \n                                            variant=\"outlined\" \n                                            onClick={handleResetFilters}\n                                            sx={{\n                                                borderRadius: '8px',\n                                                borderColor: '#9C27B0',\n                                                color: '#9C27B0',\n                                                '&:hover': {\n                                                    borderColor: '#7B1FA2',\n                                                    backgroundColor: 'rgba(156, 39, 176, 0.04)'\n                                                }\n                                            }}\n                                        >\n                                            Reset\n                                        </Button>\n                                    </Box>\n                                </Grid>\n                            </Grid>\n                        </Box>\n\n                    <Grid container spacing={3}>\n                        {bookings.map(booking => (\n                            <Grid item xs={12} key={booking.id}>\n                                    <Card \n                                        sx={{ \n                                            mb: 3, \n                                            borderRadius: '8px',\n                                            boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n                                        }}\n                                    >\n                                        <CardContent sx={{ p: '1.25rem' }}>\n                                        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', mb: 2 }}>\n                                            <Typography variant=\"h6\">\n                                                Booking #{booking.id}\n                                            </Typography>\n                                            <Chip \n                                                label={booking.status.charAt(0).toUpperCase() + booking.status.slice(1)}\n                                                color={\n                                                    booking.status === 'confirmed' ? 'primary' :\n                                                    booking.status === 'completed' ? 'success' :\n                                                    'error'\n                                                }\n                                                size=\"small\"\n                                            />\n                                        </Box>\n                                        \n                                        <Grid container spacing={2}>\n                                            <Grid item xs={12} md={6}>\n                                                <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                                                    <FlightTakeoffIcon color=\"primary\" sx={{ mr: 1 }} />\n                                                        <Typography>\n                                                            {booking.flightNumber \n                                                                ? `Flight ${booking.flightNumber}` \n                                                                : `Flight ID: ${booking.flightId}`}\n                                                        </Typography>\n                                                </Box>\n                                                    \n                                                    {booking.origin && booking.destination && (\n                                                        <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                                                            <FlightLandIcon color=\"primary\" sx={{ mr: 1 }} />\n                                                            <Typography>\n                                                                {`${booking.origin}  ${booking.destination}`}\n                                                            </Typography>\n                                                        </Box>\n                                                    )}\n                                                    \n                                                    {booking.departureTime && (\n                                                        <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                                                            <EventIcon color=\"primary\" sx={{ mr: 1 }} />\n                                                            <Typography>\n                                                                {new Date(booking.departureTime).toLocaleString()}\n                                                            </Typography>\n                                                        </Box>\n                                                    )}\n                                                    \n                                                    {booking.airline && (\n                                                        <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                                                            <FlightTakeoffIcon color=\"primary\" sx={{ mr: 1 }} />\n                                                            <Typography>{booking.airline}</Typography>\n                                                        </Box>\n                                                    )}\n                                                \n                                                <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                                                    <AccessTimeIcon color=\"primary\" sx={{ mr: 1 }} />\n                                                    <Typography>\n                                                        Booked on: {moment(booking.timestamp).format('MMMM D, YYYY [at] h:mm A')}\n                                                    </Typography>\n                                                </Box>\n                                            </Grid>\n                                            \n                                            <Grid item xs={12} md={6}>\n                                                <Typography variant=\"subtitle2\" gutterBottom>\n                                                    Passengers:\n                                                </Typography>\n                                                {booking.passengers ? (\n                                                    <ul style={{ margin: 0, paddingLeft: '1.5rem' }}>\n                                                        {booking.passengers.map((passenger, index) => (\n                                                            <li key={index}>\n                                                                {passenger.firstName} {passenger.lastName} \n                                                                {passenger.seatId && ` - Seat ${passenger.seatId}`}\n                                                            </li>\n                                                        ))}\n                                                    </ul>\n                                                ) : (\n                                                    <Typography variant=\"body2\" color=\"textSecondary\">\n                                                        {booking.seatIds.length} seat(s) booked\n                                                    </Typography>\n                                                )}\n                                            </Grid>\n                                        </Grid>\n                                    </CardContent>\n                                    \n                                        <CardActions sx={{ justifyContent: 'flex-end', p: '1.25rem', pt: 0 }}>\n                                        <Button \n                                            size=\"small\" \n                                            onClick={() => navigate(`/booking-confirmation/${booking.id}`)}\n                                                sx={{\n                                                    borderRadius: '8px',\n                                                    borderColor: '#9C27B0',\n                                                    color: '#9C27B0',\n                                                    '&:hover': {\n                                                        borderColor: '#7B1FA2',\n                                                        backgroundColor: 'rgba(156, 39, 176, 0.04)'\n                                                    }\n                                                }}\n                                        >\n                                            View Details\n                                        </Button>\n                                        \n                                        {booking.status === 'confirmed' && (\n                                            <Button \n                                                size=\"small\" \n                                                color=\"error\" \n                                                onClick={() => handleCancelDialogOpen(booking.id)}\n                                                    sx={{ borderRadius: '8px' }}\n                                            >\n                                                Cancel Booking\n                                            </Button>\n                                        )}\n                                    </CardActions>\n                                </Card>\n                            </Grid>\n                        ))}\n                    </Grid>\n                    \n                    {/* Pagination controls */}\n                    {totalPages > 1 && (\n                        <Box sx={{ display: 'flex', justifyContent: 'center', mt: 4 }}>\n                            <Pagination \n                                count={totalPages} \n                                page={filters.page ? filters.page + 1 : 1}\n                                onChange={handlePageChange}\n                                color=\"primary\"\n                            />\n                        </Box>\n                    )}\n                </>\n            )}\n            \n            {/* Confirmation dialog for cancellation */}\n            <Dialog\n                open={confirmDialogOpen}\n                onClose={handleCancelDialogClose}\n                    PaperProps={{\n                        sx: {\n                            borderRadius: '8px',\n                            boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n                        }\n                    }}\n            >\n                    <DialogTitle>Confirm Cancellation</DialogTitle>\n                <DialogContent>\n                    <DialogContentText>\n                        Are you sure you want to cancel this booking? This action cannot be undone.\n                    </DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                        <Button \n                            onClick={handleCancelDialogClose}\n                            sx={{ color: '#9C27B0' }}\n                        >\n                        No, Keep Booking\n                    </Button>\n                        <Button \n                            onClick={handleCancelBooking} \n                            variant=\"contained\" \n                            color=\"error\"\n                            sx={{ borderRadius: '8px' }}\n                        >\n                            Yes, Cancel Booking\n                    </Button>\n                </DialogActions>\n            </Dialog>\n            \n            {/* Success message snackbar */}\n            <Snackbar\n                open={!!successMessage}\n                autoHideDuration={6000}\n                onClose={() => setSuccessMessage(null)}\n                message={successMessage}\n            />\n            </Paper>\n        </Container>\n    );\n};\n\nexport default BookingHistory;","import React, { useEffect, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport {\n    Container, Paper, Typography, Box, Button, Divider, Chip,\n    Stepper, Step, StepLabel, Grid, Card, CardContent,\n    Dialog, DialogTitle, DialogContent, DialogActions,\n    CircularProgress, Alert, List, ListItem, ListItemText,\n    Snackbar\n} from '@mui/material';\nimport CheckCircleIcon from '@mui/icons-material/CheckCircle';\nimport FlightTakeoffIcon from '@mui/icons-material/FlightTakeoff';\nimport AirlineSeatReclineNormalIcon from '@mui/icons-material/AirlineSeatReclineNormal';\nimport PersonIcon from '@mui/icons-material/Person';\nimport ShareIcon from '@mui/icons-material/Share';\nimport DownloadIcon from '@mui/icons-material/Download';\nimport EmailIcon from '@mui/icons-material/Email';\nimport PhoneIcon from '@mui/icons-material/Phone';\nimport { Booking, getBookingById, downloadTicket, emailTicket } from '../../services/api';\nimport CalendarTodayIcon from '@mui/icons-material/CalendarToday';\nimport AccessTimeIcon from '@mui/icons-material/AccessTime';\nimport AirplanemodeActiveIcon from '@mui/icons-material/AirplanemodeActive';\nimport LocalOfferIcon from '@mui/icons-material/LocalOffer';\nimport FlightIcon from '@mui/icons-material/Flight';\nimport ConfirmationNumberIcon from '@mui/icons-material/ConfirmationNumber';\nimport InfoIcon from '@mui/icons-material/Info';\n\nconst BookingConfirmation = () => {\n    const { bookingId } = useParams();\n    const navigate = useNavigate();\n    const [booking, setBooking] = useState<Booking | null>(null);\n    const [shareDialogOpen, setShareDialogOpen] = useState(false);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [successMessage, setSuccessMessage] = useState<string | null>(null);\n\n    // Format date to display in a user-friendly format\n    const formatDate = (dateString?: string) => {\n        if (!dateString) return 'N/A';\n        const date = new Date(dateString);\n        return date.toLocaleDateString('en-US', {\n            weekday: 'short',\n            year: 'numeric',\n            month: 'short',\n            day: 'numeric'\n        });\n    };\n\n    // Format time to display in a user-friendly format\n    const formatTime = (dateString?: string) => {\n        if (!dateString) return 'N/A';\n        const date = new Date(dateString);\n        return date.toLocaleTimeString('en-US', {\n            hour: '2-digit',\n            minute: '2-digit',\n            hour12: true\n        });\n    };\n\n    const calculateDuration = (departureTimeStr?: string, arrivalTimeStr?: string) => {\n        if (!departureTimeStr || !arrivalTimeStr) return 'N/A';\n        \n        const departureTime = new Date(departureTimeStr);\n        const arrivalTime = new Date(arrivalTimeStr);\n        \n        const durationMs = arrivalTime.getTime() - departureTime.getTime();\n        const hours = Math.floor(durationMs / (1000 * 60 * 60));\n        const minutes = Math.floor((durationMs % (1000 * 60 * 60)) / (1000 * 60));\n        \n        return `${hours}h ${minutes}m`;\n    };\n\n    useEffect(() => {\n        const fetchBookingDetails = async () => {\n            setLoading(true);\n            try {\n                const token = localStorage.getItem('token');\n                if (!token) {\n                    setError('You must be logged in to view booking details');\n                    navigate('/login');\n                    return;\n                }\n                \n                // Fetch booking from API\n                const bookingData = await getBookingById(bookingId || '', token);\n                if (bookingData) {\n                    console.log('Booking details fetched:', bookingData);\n                    setBooking(bookingData);\n                } else {\n                setError('Booking not found');\n            }\n        } catch (err) {\n                console.error('Failed to load booking details:', err);\n                setError('Could not load booking details. Please try again.');\n        } finally {\n            setLoading(false);\n        }\n        };\n        \n        fetchBookingDetails();\n    }, [bookingId, navigate]);\n\n    const steps = [\n        'Flight Selected',\n        'Seats Booked',\n        'Booking Confirmed'\n    ];\n\n    const handleDownloadTicket = async () => {\n        try {\n            setLoading(true);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('You must be logged in to download a ticket');\n                return;\n            }\n            \n            await downloadTicket(bookingId || '', token);\n            setSuccessMessage('Ticket downloaded successfully');\n        } catch (err) {\n            console.error('Download error:', err);\n            setError('Failed to download ticket. Please try again.');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleEmailTicket = async () => {\n        try {\n            setLoading(true);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('You must be logged in to email a ticket');\n                return;\n            }\n            const response = await emailTicket(bookingId || '', token);\n            setSuccessMessage(response.message || 'Ticket has been sent to your email');\n        } catch (err: any) {\n            console.error('Email error:', err);\n            // Show specific backend error message if available\n            if (err && err.message) {\n                setError(err.message);\n            } else if (err && err.status === 403) {\n                setError('You do not have permission to email this ticket.');\n            } else if (err && err.status === 404) {\n                setError('Booking not found.');\n            } else {\n                setError('Failed to send email. Please try again.');\n            }\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    // Function to render flight status chip based on status string\n    const getFlightStatusChip = (status?: string) => {\n        if (!status) return null;\n        \n        switch (status.toUpperCase()) {\n            case 'SCHEDULED':\n                return <Chip label=\"Scheduled\" color=\"primary\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n            case 'IN_FLIGHT':\n                return <Chip label=\"In Flight\" color=\"info\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n            case 'ARRIVED':\n                return <Chip label=\"Arrived\" color=\"success\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n            case 'DELAYED':\n                return <Chip label=\"Delayed\" color=\"warning\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n            case 'CANCELLED':\n                return <Chip label=\"Cancelled\" color=\"error\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n            default:\n                return <Chip label={status} color=\"default\" size=\"small\" />;\n        }\n    };\n\n    // Function to determine booking status chip\n    const getBookingStatusChip = (status?: string) => {\n        if (!status) return null;\n        \n        switch (status.toLowerCase()) {\n            case 'confirmed':\n                return <Chip label=\"Confirmed\" color=\"success\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n            case 'completed':\n                return <Chip label=\"Completed\" color=\"info\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n            case 'cancelled':\n                return <Chip label=\"Cancelled\" color=\"error\" size=\"small\" sx={{ fontWeight: 'bold' }} />;\n            default:\n                return <Chip label={status} color=\"default\" size=\"small\" />;\n        }\n    };\n\n    if (loading) {\n        return (\n            <Container maxWidth=\"sm\" sx={{ mt: 4, textAlign: 'center' }}>\n                <CircularProgress />\n            </Container>\n        );\n    }\n\n    if (error || !booking) {\n        return (\n            <Container maxWidth=\"sm\" sx={{ mt: 4 }}>\n                <Paper sx={{ p: 4, textAlign: 'center' }}>\n                    <Typography variant=\"h5\" color=\"error\" gutterBottom>\n                        {error || 'Booking Not Found'}\n                    </Typography>\n                    <Button\n                        variant=\"contained\"\n                        onClick={() => navigate('/flights')}\n                        sx={{ mt: 2 }}\n                    >\n                        Return to Flights\n                    </Button>\n                </Paper>\n            </Container>\n        );\n    }\n\n    // Check if this booking has passenger information (safe to access as we've checked booking is not null)\n    const hasPassengerInfo = booking.passengers && booking.passengers.length > 0;\n    const hasFlightInfo = booking.flightId && booking.origin && booking.destination;\n\n    return (\n        <Container maxWidth=\"md\" sx={{ mt: 4 }}>\n            <Paper sx={{ \n                p: 4, \n                borderRadius: '8px',\n                boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n            }}>\n                <Stepper activeStep={2} alternativeLabel sx={{ mb: 4 }}>\n                    {steps.map((label) => (\n                        <Step key={label}>\n                            <StepLabel>{label}</StepLabel>\n                        </Step>\n                    ))}\n                </Stepper>\n\n                {/* Success message */}\n                <Snackbar\n                    open={!!successMessage}\n                    autoHideDuration={6000}\n                    onClose={() => setSuccessMessage(null)}\n                    message={successMessage}\n                    anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\n                    sx={{\n                        '& .MuiSnackbarContent-root': {\n                            backgroundColor: '#4caf50',\n                            color: 'white'\n                        }\n                    }}\n                />\n\n                <Box sx={{ \n                    textAlign: 'center', \n                    mb: 4, \n                    p: 3,\n                    background: 'linear-gradient(45deg, #E33069 30%, #9C27B0 90%)',\n                    borderRadius: '8px',\n                    color: 'white'\n                }}>\n                    <CheckCircleIcon sx={{ fontSize: 60, mb: 2, color: 'white' }} />\n                    <Typography variant=\"h4\" gutterBottom>\n                        Booking Confirmed!\n                    </Typography>\n                    <Typography>\n                        Your booking has been successfully completed\n                    </Typography>\n                </Box>\n\n                <Divider sx={{ my: 3 }} />\n\n                <Grid container spacing={3}>\n                    <Grid item xs={12} md={6}>\n                        <Card sx={{ \n                            borderRadius: '8px',\n                            boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n                        }}>\n                            <CardContent sx={{ p: '1.25rem' }}>\n                                <Typography variant=\"h6\" gutterBottom>\n                                    <FlightTakeoffIcon sx={{ mr: 1, verticalAlign: 'middle', color: '#9C27B0' }} />\n                                    Flight Information\n                                </Typography>\n                                {hasFlightInfo ? (\n                                    <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\n                                        <Grid container spacing={2}>\n                                            <Grid item xs={12} md={6}>\n                                                <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                                                    <AirplanemodeActiveIcon sx={{ mr: 1, color: 'primary.main' }} />\n                                                    <Typography variant=\"h6\">Departure</Typography>\n                                                </Box>\n                                                <Typography variant=\"body1\">\n                                                    <b>From:</b> {booking?.origin || 'N/A'}\n                                                </Typography>\n                                                <Box sx={{ display: 'flex', alignItems: 'center', mt: 1 }}>\n                                                    <CalendarTodayIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                                                    <Typography variant=\"body2\">\n                                                        {formatDate(booking?.departureTime)}\n                                                    </Typography>\n                                                </Box>\n                                                <Box sx={{ display: 'flex', alignItems: 'center', mt: 1 }}>\n                                                    <AccessTimeIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                                                    <Typography variant=\"body2\">\n                                                        {formatTime(booking?.departureTime)}\n                                                    </Typography>\n                                                </Box>\n                                            </Grid>\n                                            <Grid item xs={12} md={6}>\n                                                <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                                                    <FlightIcon sx={{ mr: 1, color: 'primary.main' }} />\n                                                    <Typography variant=\"h6\">Arrival</Typography>\n                                                </Box>\n                                                <Typography variant=\"body1\">\n                                                    <b>To:</b> {booking?.destination || 'N/A'}\n                                                </Typography>\n                                                <Box sx={{ display: 'flex', alignItems: 'center', mt: 1 }}>\n                                                    <CalendarTodayIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                                                    <Typography variant=\"body2\">\n                                                        {formatDate(booking?.arrivalTime)}\n                                                    </Typography>\n                                                </Box>\n                                                <Box sx={{ display: 'flex', alignItems: 'center', mt: 1 }}>\n                                                    <AccessTimeIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                                                    <Typography variant=\"body2\">\n                                                        {formatTime(booking?.arrivalTime)}\n                                                    </Typography>\n                                                </Box>\n                                            </Grid>\n                                        </Grid>\n                                <Box sx={{ mt: 2 }}>\n                                            <Divider sx={{ mb: 2 }} />\n                                            <Grid container spacing={2}>\n                                                <Grid item xs={12} sm={6}>\n                                                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                                                        <AirplanemodeActiveIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                                                        <Typography variant=\"body2\">\n                                                            <b>Flight:</b> {booking?.airline} {booking?.flightNumber}\n                                                        </Typography>\n                                                    </Box>\n                                                </Grid>\n                                                <Grid item xs={12} sm={6}>\n                                                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                                                        <LocalOfferIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                                                        <Typography variant=\"body2\">\n                                                            <b>Class:</b> {booking?.seatClass || 'Economy'}\n                                                        </Typography>\n                                                    </Box>\n                                                </Grid>\n                                                <Grid item xs={12} sm={6}>\n                                                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                                                        <AccessTimeIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                                                        <Typography variant=\"body2\">\n                                                            <b>Duration:</b> {calculateDuration(booking?.departureTime, booking?.arrivalTime)}\n                                    </Typography>\n                                                    </Box>\n                                                </Grid>\n                                                <Grid item xs={12} sm={6}>\n                                                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                                                        <ConfirmationNumberIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                                                        <Typography variant=\"body2\">\n                                                            <b>Booking ID:</b> {booking?.id}\n                                    </Typography>\n                                                    </Box>\n                                                </Grid>\n                                                <Grid item xs={12}>\n                                                    <Box sx={{ display: 'flex', alignItems: 'center', mt: 1 }}>\n                                                        <InfoIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                                                        <Typography variant=\"body2\" sx={{ mr: 1 }}>\n                                                            <b>Booking Status:</b>\n                                    </Typography>\n                                                        {getBookingStatusChip(booking?.status)}\n                                                    </Box>\n                                                </Grid>\n                                                {booking?.flightStatus && (\n                                                    <Grid item xs={12}>\n                                                        <Box sx={{ display: 'flex', alignItems: 'center', mt: 1 }}>\n                                                            <FlightIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                                                            <Typography variant=\"body2\" sx={{ mr: 1 }}>\n                                                                <b>Flight Status:</b>\n                                    </Typography>\n                                                            {getFlightStatusChip(booking?.flightStatus)}\n                                                        </Box>\n                                                    </Grid>\n                                                )}\n                                            </Grid>\n                                        </Box>\n                                </Box>\n                                ) : (\n                                    <Alert severity=\"info\" sx={{ mt: 2, borderRadius: '8px' }}>\n                                        Flight details not available\n                                    </Alert>\n                                )}\n                            </CardContent>\n                        </Card>\n                    </Grid>\n\n                    <Grid item xs={12} md={6}>\n                        <Card sx={{ \n                            borderRadius: '8px',\n                            boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n                        }}>\n                            <CardContent sx={{ p: '1.25rem' }}>\n                                <Typography variant=\"h6\" gutterBottom>\n                                    <AirlineSeatReclineNormalIcon sx={{ mr: 1, verticalAlign: 'middle', color: '#9C27B0' }} />\n                                    Seat Information\n                                </Typography>\n                                <Box sx={{ mt: 2 }}>\n                                    <Typography variant=\"subtitle2\" color=\"text.secondary\">\n                                        Number of Seats\n                                    </Typography>\n                                    <Typography variant=\"body1\" gutterBottom>\n                                        {booking.seatIds.length}\n                                    </Typography>\n                                    \n                                    <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n                                        Seat IDs\n                                    </Typography>\n                                    <Typography variant=\"body1\" gutterBottom>\n                                        {booking.seatIds.join(', ')}\n                                    </Typography>\n                                    \n                                    {booking.price && (\n                                        <>\n                                            <Typography variant=\"subtitle2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n                                                Fare Details\n                                            </Typography>\n                                            <Typography variant=\"body2\" gutterBottom>\n                                                Base fare (per seat): {booking.price.toLocaleString()}\n                                            </Typography>\n                                            <Typography variant=\"body2\" gutterBottom>\n                                                Number of seats: {booking.seatIds.length}\n                                            </Typography>\n                                            <Typography variant=\"body1\" fontWeight=\"bold\" sx={{ mt: 1 }}>\n                                                Total amount: {(booking.price * booking.seatIds.length).toLocaleString()}\n                                            </Typography>\n                                        </>\n                                    )}\n                                </Box>\n                            </CardContent>\n                        </Card>\n                    </Grid>\n\n                    <Grid item xs={12} md={6}>\n                        <Card sx={{ \n                            borderRadius: '8px',\n                            boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n                        }}>\n                            <CardContent sx={{ p: '1.25rem' }}>\n                                    <Typography variant=\"h6\" gutterBottom>\n                                    <PersonIcon sx={{ mr: 1, verticalAlign: 'middle', color: '#9C27B0' }} />\n                                        Passenger Information\n                                    </Typography>\n                                {hasPassengerInfo ? (\n                                    <List>\n                                        {booking.passengers?.map((passenger, index) => (\n                                            <ListItem \n                                                key={index}\n                                                divider={index < (booking.passengers?.length || 0) - 1}\n                                                sx={{ flexDirection: 'column', alignItems: 'flex-start', py: 2 }}\n                                            >\n                                                <Box sx={{ display: 'flex', width: '100%', mb: 1, alignItems: 'center' }}>\n                                                    <Typography variant=\"subtitle1\" sx={{ fontWeight: 'bold', mr: 1 }}>\n                                                            {passenger.firstName} {passenger.lastName}\n                                                        </Typography>\n                                                    {index === 0 && (\n                                                        <Chip \n                                                            label=\"Primary\" \n                                                            size=\"small\" \n                                                            color=\"primary\" \n                                                            sx={{ ml: 1 }}\n                                                        />\n                                                    )}\n                                                </Box>\n                                                \n                                                <Grid container spacing={1} sx={{ mt: 0.5 }}>\n                                                        {passenger.email && (\n                                                        <Grid item xs={12} sm={6}>\n                                                            <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                                                                <EmailIcon fontSize=\"small\" sx={{ mr: 0.5, color: 'text.secondary' }} />\n                                                                <Typography variant=\"body2\">{passenger.email}</Typography>\n                                                            </Box>\n                                                        </Grid>\n                                                        )}\n                                                    \n                                                        {passenger.phone && (\n                                                        <Grid item xs={12} sm={6}>\n                                                            <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                                                                <PhoneIcon fontSize=\"small\" sx={{ mr: 0.5, color: 'text.secondary' }} />\n                                                                <Typography variant=\"body2\">{passenger.phone}</Typography>\n                                                            </Box>\n                                                        </Grid>\n                                                        )}\n                                                    \n                                                    {passenger.age && (\n                                                        <Grid item xs={12} sm={6}>\n                                                            <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                                                                <PersonIcon fontSize=\"small\" sx={{ mr: 0.5, color: 'text.secondary' }} />\n                                                                <Typography variant=\"body2\">Age: {passenger.age}</Typography>\n                                                            </Box>\n                                                        </Grid>\n                                                    )}\n                                                    \n                                                    {passenger.seatId && (\n                                                        <Grid item xs={12} sm={6}>\n                                                            <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                                                                <AirlineSeatReclineNormalIcon fontSize=\"small\" sx={{ mr: 0.5, color: 'text.secondary' }} />\n                                                                <Typography variant=\"body2\">Seat: {passenger.seatId}</Typography>\n                                                            </Box>\n                                                    </Grid>\n                                                    )}\n                                                </Grid>\n                                            </ListItem>\n                                        ))}\n                                    </List>\n                                ) : (\n                                    <Alert severity=\"info\" sx={{ mt: 2, borderRadius: '8px' }}>\n                                        Passenger details not available\n                                    </Alert>\n                                )}\n                                </CardContent>\n                            </Card>\n                        </Grid>\n                </Grid>\n\n                <Box sx={{ mt: 4, display: 'flex', gap: 2, justifyContent: 'center' }}>\n                    <Button\n                        variant=\"outlined\"\n                        startIcon={<DownloadIcon />}\n                        onClick={handleDownloadTicket}\n                        sx={{\n                            borderRadius: '8px',\n                            borderColor: '#9C27B0',\n                            color: '#9C27B0',\n                            '&:hover': {\n                                borderColor: '#7B1FA2',\n                                backgroundColor: 'rgba(156, 39, 176, 0.04)'\n                            }\n                        }}\n                    >\n                        Download Ticket\n                    </Button>\n                    <Button\n                        variant=\"outlined\"\n                        startIcon={<EmailIcon />}\n                        onClick={handleEmailTicket}\n                        sx={{\n                            borderRadius: '8px',\n                            borderColor: '#9C27B0',\n                            color: '#9C27B0',\n                            '&:hover': {\n                                borderColor: '#7B1FA2',\n                                backgroundColor: 'rgba(156, 39, 176, 0.04)'\n                            }\n                        }}\n                    >\n                        Email Ticket\n                    </Button>\n                    <Button\n                        variant=\"outlined\"\n                        startIcon={<ShareIcon />}\n                        onClick={() => setShareDialogOpen(true)}\n                        sx={{\n                            borderRadius: '8px',\n                            borderColor: '#9C27B0',\n                            color: '#9C27B0',\n                            '&:hover': {\n                                borderColor: '#7B1FA2',\n                                backgroundColor: 'rgba(156, 39, 176, 0.04)'\n                            }\n                        }}\n                    >\n                        Share\n                    </Button>\n                </Box>\n\n                <Box sx={{ display: 'flex', gap: 2, justifyContent: 'center', mt: 2 }}>\n                    <Button\n                        variant=\"outlined\"\n                        onClick={() => navigate('/bookings')}\n                        sx={{\n                            borderRadius: '8px',\n                            borderColor: '#9C27B0',\n                            color: '#9C27B0',\n                            '&:hover': {\n                                borderColor: '#7B1FA2',\n                                backgroundColor: 'rgba(156, 39, 176, 0.04)'\n                            }\n                        }}\n                    >\n                        View All Bookings\n                    </Button>\n                    <Button\n                        variant=\"contained\"\n                        onClick={() => navigate('/flights')}\n                        sx={{ \n                            bgcolor: '#FF7F23',\n                            '&:hover': {\n                                bgcolor: '#E67D2E'\n                            },\n                            borderRadius: '8px'\n                        }}\n                    >\n                        Book Another Flight\n                    </Button>\n                </Box>\n\n                <Dialog\n                    open={shareDialogOpen}\n                    onClose={() => setShareDialogOpen(false)}\n                    PaperProps={{\n                        sx: {\n                            borderRadius: '8px',\n                            boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.1)'\n                        }\n                    }}\n                >\n                    <DialogTitle>Share Booking Details</DialogTitle>\n                    <DialogContent>\n                        <Typography>\n                            Share your booking confirmation via:\n                        </Typography>\n                        <Box sx={{ mt: 2, display: 'flex', gap: 2 }}>\n                            <Button \n                                variant=\"outlined\" \n                                startIcon={<EmailIcon />}\n                                sx={{\n                                    borderRadius: '8px',\n                                    borderColor: '#9C27B0',\n                                    color: '#9C27B0',\n                                    '&:hover': {\n                                        borderColor: '#7B1FA2',\n                                        backgroundColor: 'rgba(156, 39, 176, 0.04)'\n                                    }\n                                }}\n                            >\n                                Email\n                            </Button>\n                        </Box>\n                    </DialogContent>\n                    <DialogActions>\n                        <Button \n                            onClick={() => setShareDialogOpen(false)}\n                            sx={{\n                                color: '#9C27B0',\n                            }}\n                        >\n                            Close\n                        </Button>\n                    </DialogActions>\n                </Dialog>\n            </Paper>\n        </Container>\n    );\n};\n\nexport default BookingConfirmation;","import React, { useEffect, useState } from 'react';\r\nimport { Navigate, useLocation } from 'react-router-dom';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { CircularProgress, Box } from '@mui/material';\r\n\r\ninterface ProtectedRouteProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst ProtectedRoute: React.FC<ProtectedRouteProps> = ({ children }) => {\r\n  const location = useLocation();\r\n  const { isAuthenticated, loading, checkAuth } = useAuth();\r\n  const [isChecking, setIsChecking] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // Quick check for authentication state\r\n    const timer = setTimeout(() => {\r\n      const isValid = checkAuth(); \r\n      console.log('ProtectedRoute - Auth state:', { \r\n        isAuthenticated, \r\n        isValid,\r\n        path: location.pathname,\r\n        token: localStorage.getItem('token') ? 'exists' : 'none'\r\n      });\r\n      setIsChecking(false);\r\n    }, 300); // Short timeout to ensure auth state is processed\r\n    \r\n    return () => clearTimeout(timer);\r\n  }, [isAuthenticated, checkAuth, location.pathname]);\r\n\r\n  // Only show loading briefly if auth system is still initializing \r\n  if (loading && isChecking) {\r\n    return (\r\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '50vh' }}>\r\n        <CircularProgress />\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  // Don't wait forever - use whatever auth state we have after checking\r\n  if (!isAuthenticated) {\r\n    console.log('ProtectedRoute - User not authenticated, redirecting to login');\r\n    // Save the location they tried to access for redirecting after login\r\n    return <Navigate to=\"/login\" state={{ from: location.pathname }} replace />;\r\n  }\r\n\r\n  return <>{children}</>;\r\n};\r\n\r\nexport default ProtectedRoute; ","import React, { useState, useEffect } from 'react';\nimport {\n  Box,\n  Typography,\n  Paper,\n  Switch,\n  FormControlLabel,\n  Grid,\n  Card,\n  CardContent,\n  Divider,\n  Alert,\n  CircularProgress,\n  Button\n} from '@mui/material';\nimport { \n  BarChart, Bar, XAxis, YAxis, Tooltip, Legend, CartesianGrid,\n  LineChart, Line, ResponsiveContainer \n} from 'recharts';\nimport axios from 'axios';\n\ninterface ApiStatistics {\n  totalCalls: number;\n  successRate: number;\n  failureRate: number;\n  avgResponseTime: number;\n  callsByEndpoint: Record<string, number>;\n  callsByDay: Array<{\n    date: string;\n    calls: number;\n    successRate: number;\n  }>;\n}\n\nconst ApiManagement: React.FC = () => {\n  const [apiEnabled, setApiEnabled] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [statsLoading, setStatsLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [statistics, setStatistics] = useState<ApiStatistics | null>(null);\n\n  useEffect(() => {\n    fetchApiStatus();\n  }, []);\n\n  const fetchApiStatus = async () => {\n    setLoading(true);\n    try {\n      // Use the actual backend endpoint for API status\n      const response = await axios.get('http://localhost:8080/api/flights/api-status', {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setApiEnabled(response.data.enabled);\n      setError('');\n      // After fetching status, get the statistics\n      fetchApiStatistics();\n    } catch (err) {\n      console.error('Error fetching API status:', err);\n      setError('Failed to fetch API status. Please try again later.');\n      // For demo purposes, set some default values\n      setApiEnabled(true);\n      // Generate mock statistics\n      generateMockStatistics();\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchApiStatistics = async () => {\n    setStatsLoading(true);\n    try {\n      // Use the actual backend endpoint for API usage\n      const response = await axios.get('http://localhost:8080/api/flights/api-usage', {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      \n      // Parse the raw string response from backend or use mock data\n      try {\n        const stats = typeof response.data === 'string' \n          ? parseApiUsageString(response.data) \n          : response.data;\n        setStatistics(stats);\n      } catch (parseErr) {\n        console.error('Error parsing API statistics:', parseErr);\n        generateMockStatistics();\n      }\n    } catch (err) {\n      console.error('Error fetching API statistics:', err);\n      // Generate mock statistics for demonstration\n      generateMockStatistics();\n    } finally {\n      setStatsLoading(false);\n    }\n  };\n\n  // Parse the raw string from the API usage endpoint\n  const parseApiUsageString = (usageString: string): ApiStatistics => {\n    // Example string: \"API calls this month: 150 / Max: 2000 (7%)\"\n    const callsMatch = usageString.match(/API calls this month: (\\d+)/);\n    const maxMatch = usageString.match(/Max: (\\d+)/);\n    const percentMatch = usageString.match(/\\((\\d+)%\\)/);\n    \n    const calls = callsMatch ? parseInt(callsMatch[1]) : 0;\n    const max = maxMatch ? parseInt(maxMatch[1]) : 2000;\n    \n    // Generate mock data for the rest of the statistics\n    return {\n      totalCalls: calls,\n      successRate: 94.7,\n      failureRate: 5.3,\n      avgResponseTime: 231,\n      callsByEndpoint: {\n        '/flights/search': Math.floor(calls * 0.6),\n        '/flights/details': Math.floor(calls * 0.2),\n        '/pricing': Math.floor(calls * 0.15),\n        '/availability': Math.floor(calls * 0.05)\n      },\n      callsByDay: Array.from({ length: 7 }, (_, i) => {\n        const date = new Date();\n        date.setDate(date.getDate() - (6 - i));\n        \n        const dailyCalls = Math.floor(calls / 7) + Math.floor(Math.random() * 20) - 10;\n        \n        return {\n          date: date.toISOString().split('T')[0],\n          calls: Math.max(0, dailyCalls),\n          successRate: 90 + Math.random() * 10\n        };\n      })\n    };\n  };\n\n  const generateMockStatistics = () => {\n    const mockStats: ApiStatistics = {\n      totalCalls: 12458,\n      successRate: 94.7,\n      failureRate: 5.3,\n      avgResponseTime: 231, // ms\n      callsByEndpoint: {\n        '/flights/search': 7834,\n        '/flights/details': 2304,\n        '/pricing': 1562,\n        '/availability': 758\n      },\n      callsByDay: Array.from({ length: 7 }, (_, i) => {\n        const date = new Date();\n        date.setDate(date.getDate() - (6 - i));\n        \n        return {\n          date: date.toISOString().split('T')[0],\n          calls: Math.floor(Math.random() * 300) + 100,\n          successRate: 90 + Math.random() * 10\n        };\n      })\n    };\n    \n    setStatistics(mockStats);\n  };\n\n  const handleToggleChange = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const newStatus = event.target.checked;\n    try {\n      // Use the actual backend endpoint for toggle API mode\n      await axios.post('http://localhost:8080/api/flights/toggle-api-mode', \n        null,\n        {\n          params: { enableApi: newStatus },\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('token')}`\n          }\n        }\n      );\n      setApiEnabled(newStatus);\n      setError('');\n    } catch (err) {\n      console.error('Error updating API status:', err);\n      setError('Failed to update API status. Please try again.');\n      // For demo purposes, update the UI anyway\n      setApiEnabled(newStatus);\n    }\n  };\n\n  const formatEndpointData = () => {\n    if (!statistics) return [];\n    \n    return Object.entries(statistics.callsByEndpoint).map(([endpoint, calls]) => ({\n      endpoint,\n      calls\n    }));\n  };\n\n  if (loading) {\n    return (\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '300px' }}>\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  return (\n    <Box sx={{ p: 3 }}>\n      <Typography variant=\"h5\" component=\"h2\" gutterBottom>\n        External Flight API Management\n      </Typography>\n      \n      {error && (\n        <Alert severity=\"error\" sx={{ mb: 2 }}>\n          {error}\n        </Alert>\n      )}\n      \n      <Paper sx={{ p: 3, mb: 3 }}>\n        <FormControlLabel\n          control={\n            <Switch\n              checked={apiEnabled}\n              onChange={handleToggleChange}\n              color=\"primary\"\n            />\n          }\n          label={\n            <Typography variant=\"h6\">\n              {apiEnabled ? 'API Mode: ENABLED' : 'API Mode: DISABLED'}\n            </Typography>\n          }\n        />\n        <Typography variant=\"body1\" sx={{ mt: 1 }}>\n          {apiEnabled \n            ? 'The system is currently fetching flight data from the external API.'\n            : 'The system is using the local database for flight information.'}\n        </Typography>\n      </Paper>\n      \n      <Typography variant=\"h6\" sx={{ mb: 2, mt: 4 }}>\n        API Performance Statistics\n      </Typography>\n      \n      {statsLoading ? (\n        <Box sx={{ display: 'flex', justifyContent: 'center', p: 3 }}>\n          <CircularProgress />\n        </Box>\n      ) : (\n        <>\n          <Grid container spacing={3} sx={{ mb: 4 }}>\n            <Grid item xs={12} sm={6} md={3}>\n              <Card>\n                <CardContent>\n                  <Typography color=\"textSecondary\" gutterBottom>\n                    Total API Calls\n                  </Typography>\n                  <Typography variant=\"h4\">\n                    {statistics?.totalCalls.toLocaleString()}\n                  </Typography>\n                </CardContent>\n              </Card>\n            </Grid>\n            <Grid item xs={12} sm={6} md={3}>\n              <Card>\n                <CardContent>\n                  <Typography color=\"textSecondary\" gutterBottom>\n                    Success Rate\n                  </Typography>\n                  <Typography variant=\"h4\">\n                    {statistics?.successRate.toFixed(1)}%\n                  </Typography>\n                </CardContent>\n              </Card>\n            </Grid>\n            <Grid item xs={12} sm={6} md={3}>\n              <Card>\n                <CardContent>\n                  <Typography color=\"textSecondary\" gutterBottom>\n                    Failure Rate\n                  </Typography>\n                  <Typography variant=\"h4\">\n                    {statistics?.failureRate.toFixed(1)}%\n                  </Typography>\n                </CardContent>\n              </Card>\n            </Grid>\n            <Grid item xs={12} sm={6} md={3}>\n              <Card>\n                <CardContent>\n                  <Typography color=\"textSecondary\" gutterBottom>\n                    Avg Response Time\n                  </Typography>\n                  <Typography variant=\"h4\">\n                    {statistics?.avgResponseTime}ms\n                  </Typography>\n                </CardContent>\n              </Card>\n            </Grid>\n          </Grid>\n          \n          <Grid container spacing={3}>\n            <Grid item xs={12} md={6}>\n              <Paper sx={{ p: 2 }}>\n                <Typography variant=\"h6\" gutterBottom>\n                  API Calls by Endpoint\n                </Typography>\n                <Divider sx={{ mb: 2 }} />\n                <ResponsiveContainer width=\"100%\" height={300}>\n                  <BarChart data={formatEndpointData()} margin={{ top: 20, right: 30, left: 20, bottom: 70 }}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis dataKey=\"endpoint\" angle={-45} textAnchor=\"end\" height={70} />\n                    <YAxis />\n                    <Tooltip />\n                    <Bar dataKey=\"calls\" fill=\"#8884d8\" name=\"Number of Calls\" />\n                  </BarChart>\n                </ResponsiveContainer>\n              </Paper>\n            </Grid>\n            <Grid item xs={12} md={6}>\n              <Paper sx={{ p: 2 }}>\n                <Typography variant=\"h6\" gutterBottom>\n                  API Calls by Day\n                </Typography>\n                <Divider sx={{ mb: 2 }} />\n                <ResponsiveContainer width=\"100%\" height={300}>\n                  <LineChart data={statistics?.callsByDay} margin={{ top: 20, right: 30, left: 20, bottom: 20 }}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis dataKey=\"date\" />\n                    <YAxis yAxisId=\"left\" />\n                    <YAxis yAxisId=\"right\" orientation=\"right\" domain={[0, 100]} />\n                    <Tooltip />\n                    <Legend />\n                    <Line yAxisId=\"left\" type=\"monotone\" dataKey=\"calls\" stroke=\"#8884d8\" name=\"Number of Calls\" />\n                    <Line yAxisId=\"right\" type=\"monotone\" dataKey=\"successRate\" stroke=\"#82ca9d\" name=\"Success Rate (%)\" />\n                  </LineChart>\n                </ResponsiveContainer>\n              </Paper>\n            </Grid>\n          </Grid>\n          \n          <Box sx={{ mt: 3, display: 'flex', justifyContent: 'center' }}>\n            <Button \n              variant=\"contained\" \n              onClick={fetchApiStatistics} \n              disabled={statsLoading}\n            >\n              Refresh Statistics\n            </Button>\n          </Box>\n        </>\n      )}\n    </Box>\n  );\n};\n\nexport default ApiManagement; ","import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Container, Paper, Typography, Table, TableBody, TableCell, TableContainer,\r\n  TableHead, TableRow, Button, IconButton, Box, TextField, Dialog,\r\n  DialogActions, DialogContent, DialogContentText, DialogTitle,\r\n  Grid, FormControl, InputLabel, Select, MenuItem, Alert, CircularProgress,\r\n  Snackbar, SelectChangeEvent\r\n} from '@mui/material';\r\nimport AddIcon from '@mui/icons-material/Add';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport RefreshIcon from '@mui/icons-material/Refresh';\r\nimport axios from 'axios';\r\n\r\n// Define user interface\r\ninterface User {\r\n  id: string;\r\n  email: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  role: string;\r\n  registrationDate: string;\r\n}\r\n\r\nconst UserManagement: React.FC = () => {\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [openDialog, setOpenDialog] = useState(false);\r\n  const [openDeleteDialog, setOpenDeleteDialog] = useState(false);\r\n  const [selectedUserId, setSelectedUserId] = useState<string | null>(null);\r\n  const [formData, setFormData] = useState({\r\n    email: '',\r\n    firstName: '',\r\n    lastName: '',\r\n    password: '',\r\n    role: 'CUSTOMER'\r\n  });\r\n  const [snackbar, setSnackbar] = useState({\r\n    open: false,\r\n    message: '',\r\n    severity: 'success' as 'success' | 'error' | 'info' | 'warning'\r\n  });\r\n\r\n  // Generate mock users for offline mode\r\n  const getMockUsers = (): User[] => {\r\n    return [\r\n      {\r\n        id: 'mock-1',\r\n        email: 'admin@example.com',\r\n        firstName: 'Admin',\r\n        lastName: 'User',\r\n        role: 'ADMIN',\r\n        registrationDate: '2023-01-01T10:00:00Z'\r\n      },\r\n      {\r\n        id: 'mock-2',\r\n        email: 'john.doe@example.com',\r\n        firstName: 'John',\r\n        lastName: 'Doe',\r\n        role: 'CUSTOMER',\r\n        registrationDate: '2023-02-15T14:30:00Z'\r\n      },\r\n      {\r\n        id: 'mock-3',\r\n        email: 'jane.smith@example.com',\r\n        firstName: 'Jane',\r\n        lastName: 'Smith',\r\n        role: 'CUSTOMER',\r\n        registrationDate: '2023-03-22T09:15:00Z'\r\n      }\r\n    ];\r\n  };\r\n\r\n  // Check if server is available\r\n  const isServerAvailable = async (): Promise<boolean> => {\r\n    try {\r\n      // Use the known working endpoint instead\r\n      const response = await axios.get('http://localhost:8080/api/flights/test', { timeout: 5000 });\r\n      return response.status === 200;\r\n    } catch (error) {\r\n      console.error('Server health check failed:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  // Fetch Users\r\n  const fetchUsers = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      // Check if server is available\r\n      const serverAvailable = await isServerAvailable();\r\n      if (!serverAvailable) {\r\n        throw new Error('Server is currently unavailable');\r\n      }\r\n      \r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        throw new Error('Authentication required');\r\n      }\r\n      \r\n      const response = await axios.get('http://localhost:8080/api/admin/users', {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      // Convert backend format to frontend format\r\n      const mappedUsers = response.data.map((user: any) => ({\r\n        id: user.id.toString(),\r\n        email: user.email,\r\n        firstName: user.firstName || '',\r\n        lastName: user.lastName || '',\r\n        role: user.role,\r\n        registrationDate: user.registrationDate || new Date().toISOString()\r\n      }));\r\n      \r\n      setUsers(mappedUsers);\r\n    } catch (err: any) {\r\n      console.error('Error fetching users:', err);\r\n      \r\n      // If the server is down, use mock data\r\n      if (err.message === 'Server is currently unavailable') {\r\n        setUsers(getMockUsers());\r\n        setError('Server is offline. Showing mock data.');\r\n      } else {\r\n        setError(`Failed to fetch users: ${err.message || 'Unknown error'}`);\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Add User\r\n  const addUser = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        throw new Error('Authentication required');\r\n      }\r\n      \r\n      // Check if server is available\r\n      const serverAvailable = await isServerAvailable();\r\n      if (!serverAvailable) {\r\n        // If server is down, just add to local state\r\n        const mockUser: User = {\r\n          id: `mock-${Date.now()}`,\r\n          email: formData.email,\r\n          firstName: formData.firstName,\r\n          lastName: formData.lastName,\r\n          role: formData.role,\r\n          registrationDate: new Date().toISOString()\r\n        };\r\n        \r\n        setUsers(prev => [...prev, mockUser]);\r\n        showSnackbar('User added (mock - server offline)', 'warning');\r\n        setOpenDialog(false);\r\n        resetForm();\r\n        return;\r\n      }\r\n      \r\n      const response = await axios.post(\r\n        'http://localhost:8080/api/admin/users',\r\n        formData,\r\n        { headers: { Authorization: `Bearer ${token}` }}\r\n      );\r\n      \r\n      // Convert backend format to frontend format\r\n      const newUser: User = {\r\n        id: response.data.id.toString(),\r\n        email: response.data.email,\r\n        firstName: response.data.firstName || '',\r\n        lastName: response.data.lastName || '',\r\n        role: response.data.role,\r\n        registrationDate: response.data.registrationDate || new Date().toISOString()\r\n      };\r\n      \r\n      setUsers(prev => [...prev, newUser]);\r\n      showSnackbar('User added successfully', 'success');\r\n      setOpenDialog(false);\r\n      resetForm();\r\n    } catch (err: any) {\r\n      console.error('Error adding user:', err);\r\n      showSnackbar(`Failed to add user: ${err.message || 'Unknown error'}`, 'error');\r\n    }\r\n  };\r\n\r\n  // Delete User\r\n  const deleteUser = async () => {\r\n    if (!selectedUserId) return;\r\n    \r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        throw new Error('Authentication required');\r\n      }\r\n      \r\n      // Check if server is available\r\n      const serverAvailable = await isServerAvailable();\r\n      if (!serverAvailable) {\r\n        // If server is down, just remove from local state\r\n        setUsers(prev => prev.filter(user => user.id !== selectedUserId));\r\n        showSnackbar('User deleted (mock - server offline)', 'warning');\r\n        setOpenDeleteDialog(false);\r\n        setSelectedUserId(null);\r\n        return;\r\n      }\r\n      \r\n      await axios.delete(\r\n        `http://localhost:8080/api/admin/users/${selectedUserId}`,\r\n        { headers: { Authorization: `Bearer ${token}` }}\r\n      );\r\n      \r\n      setUsers(prev => prev.filter(user => user.id !== selectedUserId));\r\n      showSnackbar('User deleted successfully', 'success');\r\n      setOpenDeleteDialog(false);\r\n      setSelectedUserId(null);\r\n    } catch (err: any) {\r\n      console.error('Error deleting user:', err);\r\n      showSnackbar(`Failed to delete user: ${err.message || 'Unknown error'}`, 'error');\r\n    }\r\n  };\r\n\r\n  // Form handling\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement> | SelectChangeEvent) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [name]: value\r\n    }));\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFormData({\r\n      email: '',\r\n      firstName: '',\r\n      lastName: '',\r\n      password: '',\r\n      role: 'CUSTOMER'\r\n    });\r\n  };\r\n\r\n  // Dialog handling\r\n  const handleOpenDialog = () => {\r\n    resetForm();\r\n    setOpenDialog(true);\r\n  };\r\n\r\n  const handleCloseDialog = () => {\r\n    setOpenDialog(false);\r\n  };\r\n\r\n  const handleOpenDeleteDialog = (userId: string) => {\r\n    setSelectedUserId(userId);\r\n    setOpenDeleteDialog(true);\r\n  };\r\n\r\n  const handleCloseDeleteDialog = () => {\r\n    setOpenDeleteDialog(false);\r\n    setSelectedUserId(null);\r\n  };\r\n\r\n  // Snackbar handling\r\n  const showSnackbar = (message: string, severity: 'success' | 'error' | 'info' | 'warning') => {\r\n    setSnackbar({\r\n      open: true,\r\n      message,\r\n      severity\r\n    });\r\n  };\r\n\r\n  const handleCloseSnackbar = () => {\r\n    setSnackbar(prev => ({ ...prev, open: false }));\r\n  };\r\n\r\n  // Initial fetch\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, []);\r\n\r\n  // Render\r\n  return (\r\n    <Container maxWidth=\"xl\" sx={{ mt: 3 }}>\r\n      <Box sx={{ mb: 4 }}>\r\n        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\r\n          <Typography variant=\"h5\" component=\"h2\">User Management</Typography>\r\n          \r\n          <Box sx={{ display: 'flex', gap: 2 }}>\r\n            <Button\r\n              variant=\"contained\"\r\n              startIcon={<RefreshIcon />}\r\n              onClick={fetchUsers}\r\n              disabled={loading}\r\n            >\r\n              Refresh\r\n            </Button>\r\n            \r\n            <Button\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              startIcon={<AddIcon />}\r\n              onClick={handleOpenDialog}\r\n            >\r\n              Add User\r\n            </Button>\r\n          </Box>\r\n        </Box>\r\n\r\n        <Paper sx={{ width: '100%', p: 2 }}>\r\n          {error && <Alert severity=\"error\" sx={{ mb: 2 }}>{error}</Alert>}\r\n          \r\n          {loading ? (\r\n            <Box sx={{ display: 'flex', justifyContent: 'center', p: 3 }}>\r\n              <CircularProgress />\r\n            </Box>\r\n          ) : users.length > 0 ? (\r\n            <TableContainer>\r\n              <Table>\r\n                <TableHead>\r\n                  <TableRow>\r\n                    <TableCell>ID</TableCell>\r\n                    <TableCell>Email</TableCell>\r\n                    <TableCell>Name</TableCell>\r\n                    <TableCell>Role</TableCell>\r\n                    <TableCell>Registered</TableCell>\r\n                    <TableCell>Actions</TableCell>\r\n                  </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                  {users.map((user) => (\r\n                    <TableRow key={user.id}>\r\n                      <TableCell>{user.id}</TableCell>\r\n                      <TableCell>{user.email}</TableCell>\r\n                      <TableCell>{`${user.firstName} ${user.lastName}`.trim()}</TableCell>\r\n                      <TableCell>{user.role}</TableCell>\r\n                      <TableCell>\r\n                        {new Date(user.registrationDate).toLocaleDateString()}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <IconButton\r\n                          size=\"small\"\r\n                          color=\"error\"\r\n                          onClick={() => handleOpenDeleteDialog(user.id)}\r\n                          disabled={user.role === 'ADMIN'}\r\n                          aria-label=\"delete user\"\r\n                        >\r\n                          <DeleteIcon />\r\n                        </IconButton>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n            </TableContainer>\r\n          ) : (\r\n            <Box sx={{ p: 3, textAlign: 'center' }}>\r\n              <Typography variant=\"body1\" gutterBottom>No users available</Typography>\r\n              <Button \r\n                variant=\"outlined\" \r\n                startIcon={<AddIcon />} \r\n                onClick={handleOpenDialog}\r\n              >\r\n                Add User\r\n              </Button>\r\n            </Box>\r\n          )}\r\n        </Paper>\r\n      </Box>\r\n\r\n      {/* Add User Dialog */}\r\n      <Dialog open={openDialog} onClose={handleCloseDialog} maxWidth=\"sm\" fullWidth>\r\n        <DialogTitle>Add New User</DialogTitle>\r\n        <DialogContent>\r\n          <Grid container spacing={2} sx={{ mt: 1 }}>\r\n            <Grid item xs={12}>\r\n              <TextField\r\n                label=\"Email\"\r\n                name=\"email\"\r\n                type=\"email\"\r\n                value={formData.email}\r\n                onChange={handleInputChange}\r\n                fullWidth\r\n                required\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12} sm={6}>\r\n              <TextField\r\n                label=\"First Name\"\r\n                name=\"firstName\"\r\n                value={formData.firstName}\r\n                onChange={handleInputChange}\r\n                fullWidth\r\n                required\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12} sm={6}>\r\n              <TextField\r\n                label=\"Last Name\"\r\n                name=\"lastName\"\r\n                value={formData.lastName}\r\n                onChange={handleInputChange}\r\n                fullWidth\r\n                required\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <TextField\r\n                label=\"Password\"\r\n                name=\"password\"\r\n                type=\"password\"\r\n                value={formData.password}\r\n                onChange={handleInputChange}\r\n                fullWidth\r\n                required\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <FormControl fullWidth>\r\n                <InputLabel id=\"role-label\">Role</InputLabel>\r\n                <Select\r\n                  labelId=\"role-label\"\r\n                  name=\"role\"\r\n                  value={formData.role}\r\n                  label=\"Role\"\r\n                  onChange={handleInputChange}\r\n                >\r\n                  <MenuItem value=\"CUSTOMER\">Customer</MenuItem>\r\n                  <MenuItem value=\"ADMIN\">Admin</MenuItem>\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n          </Grid>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleCloseDialog}>Cancel</Button>\r\n          <Button \r\n            onClick={addUser} \r\n            variant=\"contained\" \r\n            color=\"primary\"\r\n          >\r\n            Add User\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      {/* Delete Confirmation Dialog */}\r\n      <Dialog open={openDeleteDialog} onClose={handleCloseDeleteDialog}>\r\n        <DialogTitle>Delete User</DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText>\r\n            Are you sure you want to delete this user? This action cannot be undone.\r\n          </DialogContentText>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleCloseDeleteDialog}>Cancel</Button>\r\n          <Button onClick={deleteUser} color=\"error\" variant=\"contained\">\r\n            Delete\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      {/* Snackbar for notifications */}\r\n      <Snackbar \r\n        open={snackbar.open} \r\n        autoHideDuration={6000} \r\n        onClose={handleCloseSnackbar}\r\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\r\n      >\r\n        <Alert \r\n          onClose={handleCloseSnackbar} \r\n          severity={snackbar.severity}\r\n          variant=\"filled\"\r\n          sx={{ width: '100%' }}\r\n        >\r\n          {snackbar.message}\r\n        </Alert>\r\n      </Snackbar>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default UserManagement; ","import React, { useState } from 'react';\r\nimport { \r\n  Box, \r\n  Container, \r\n  Tab, \r\n  Tabs, \r\n  Typography, \r\n  Paper,\r\n  Divider\r\n} from '@mui/material';\r\nimport ApiManagement from './ApiManagement';\r\nimport UserManagement from './UserManagement';\r\nimport EmailIcon from '@mui/icons-material/Email';\r\nimport PeopleIcon from '@mui/icons-material/People';\r\nimport ApiIcon from '@mui/icons-material/Api';\r\n\r\ninterface TabPanelProps {\r\n  children?: React.ReactNode;\r\n  index: number;\r\n  value: number;\r\n}\r\n\r\nfunction TabPanel(props: TabPanelProps) {\r\n  const { children, value, index, ...other } = props;\r\n  \r\n  return (\r\n    <div\r\n      role=\"tabpanel\"\r\n      hidden={value !== index}\r\n      id={`admin-dashboard-tabpanel-${index}`}\r\n      aria-labelledby={`admin-dashboard-tab-${index}`}\r\n      {...other}\r\n    >\r\n      {value === index && (\r\n        <Box sx={{ p: 2 }}>\r\n          {children}\r\n        </Box>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction a11yProps(index: number) {\r\n  return {\r\n    id: `admin-dashboard-tab-${index}`,\r\n    'aria-controls': `admin-dashboard-tabpanel-${index}`,\r\n  };\r\n}\r\n\r\nconst AdminDashboard: React.FC = () => {\r\n  const [value, setValue] = useState(0);\r\n\r\n  const handleChange = (event: React.SyntheticEvent, newValue: number) => {\r\n    setValue(newValue);\r\n  };\r\n\r\n  return (\r\n    <Container maxWidth=\"xl\" sx={{ mt: 4, mb: 4 }}>\r\n      <Paper elevation={3} sx={{ p: 3, mb: 4 }}>\r\n        <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n          Admin Dashboard\r\n        </Typography>\r\n        <Typography variant=\"body1\" color=\"text.secondary\" paragraph>\r\n          Manage your flight booking system settings and monitor system performance.\r\n        </Typography>\r\n        <Divider sx={{ my: 2 }} />\r\n        \r\n        <Box sx={{ borderBottom: 1, borderColor: 'divider' }}>\r\n          <Tabs \r\n            value={value} \r\n            onChange={handleChange} \r\n            aria-label=\"admin dashboard tabs\"\r\n            variant=\"scrollable\"\r\n            scrollButtons=\"auto\"\r\n          >\r\n            <Tab icon={<ApiIcon sx={{ mr: 1 }} />} iconPosition=\"start\" label=\"API Management\" {...a11yProps(0)} />\r\n            <Tab icon={<PeopleIcon sx={{ mr: 1 }} />} iconPosition=\"start\" label=\"User Management\" {...a11yProps(1)} />\r\n          </Tabs>\r\n        </Box>\r\n        \r\n        <TabPanel value={value} index={0}>\r\n          <ApiManagement />\r\n        </TabPanel>\r\n        \r\n        <TabPanel value={value} index={1}>\r\n          <UserManagement />\r\n        </TabPanel>\r\n      </Paper>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default AdminDashboard; ","import React, { useState, useEffect } from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { CircularProgress, Box, Typography } from '@mui/material';\r\n\r\ninterface AdminRouteProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst AdminRoute: React.FC<AdminRouteProps> = ({ children }) => {\r\n  const { user, loading, checkAuth } = useAuth();\r\n  const [isVerifying, setIsVerifying] = useState<boolean>(true);\r\n  const [isAuthorized, setIsAuthorized] = useState<boolean>(false);\r\n\r\n  useEffect(() => {\r\n    const verifyAdmin = async () => {\r\n      setIsVerifying(true);\r\n\r\n      // Check if authenticated and has admin role\r\n      const isValid = checkAuth();\r\n      const isAdmin = isValid && user?.role === 'ADMIN';\r\n      \r\n      console.log('AdminRoute auth check:', { \r\n        isValid,\r\n        isAdmin, \r\n        userRole: user?.role || 'none' \r\n      });\r\n      \r\n      setIsAuthorized(isAdmin);\r\n      setIsVerifying(false);\r\n    };\r\n\r\n    verifyAdmin();\r\n  }, [user, checkAuth]);\r\n\r\n  // Show loading indicator while verifying\r\n  if (loading || isVerifying) {\r\n    return (\r\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '80vh' }}>\r\n        <CircularProgress />\r\n        <Typography variant=\"body1\" sx={{ ml: 2 }}>\r\n          Verifying admin access...\r\n        </Typography>\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  // Check if the user is authenticated\r\n  const isUserAuthenticated = checkAuth();\r\n\r\n  // If not authenticated, redirect to login\r\n  if (!isUserAuthenticated) {\r\n    console.log('User not authenticated, redirecting to login');\r\n    return <Navigate to=\"/login\" replace />;\r\n  }\r\n\r\n  // If authenticated but not admin, redirect to home\r\n  if (!isAuthorized) {\r\n    console.log('User not authorized as admin, redirecting to home');\r\n    return <Navigate to=\"/\" replace />;\r\n  }\r\n\r\n  // If admin, render children\r\n  console.log('Admin access granted, rendering admin dashboard');\r\n  return <>{children}</>;\r\n};\r\n\r\nexport default AdminRoute; ","import React, { useEffect } from 'react';\nimport { BrowserRouter, Routes, Route, useNavigate } from 'react-router-dom';\nimport Navbar from './components/common/Navbar';\nimport Login from './components/auth/Login';\nimport Register from './components/auth/Register';\nimport FlightList from './components/flight/FlightList';\nimport SeatSelectionWrapper from './components/flight/SeatSelectionWrapper';\nimport Home from './components/home/Home';\nimport Profile from './components/profile/Profile';\nimport BookingHistory from './components/booking/BookingHistory';\nimport BookingConfirmation from './components/booking/BookingConfirmation';\nimport ProtectedRoute from './components/common/ProtectedRoute';\nimport AdminDashboard from './components/admin/AdminDashboard';\nimport AdminRoute from './components/common/AdminRoute';\nimport { initializeSession } from './utils/sessionHandler';\n\nconst AppRouter = () => {\n    // Initialize session timeout handler\n    useEffect(() => {\n        if (localStorage.getItem('token')) {\n            initializeSession();\n        }\n    }, []);\n\n    return (\n        <BrowserRouter>\n            <Navbar />\n            <Routes>\n                <Route path=\"/\" element={<Home />} />\n                <Route path=\"/login\" element={<Login />} />\n                <Route path=\"/register\" element={<Register />} />\n\n                {/* Protected Routes */}\n                <Route path=\"/flights\" element={\n                    <ProtectedRoute>\n                        <FlightList />\n                    </ProtectedRoute>\n                } />\n                <Route path=\"/flights/:flightId/seats\" element={\n                    <ProtectedRoute>\n                        <SeatSelectionWrapper />\n                    </ProtectedRoute>\n                } />\n                <Route path=\"/profile\" element={\n                    <ProtectedRoute>\n                        <Profile />\n                    </ProtectedRoute>\n                } />\n                <Route path=\"/bookings\" element={\n                    <ProtectedRoute>\n                        <BookingHistory />\n                    </ProtectedRoute>\n                } />\n                <Route path=\"/booking-confirmation/:bookingId\" element={\n                    <ProtectedRoute>\n                        <BookingConfirmation />\n                    </ProtectedRoute>\n                } />\n                \n                {/* Admin Routes */}\n                <Route \n                    path=\"/admin/*\" \n                    element={\n                        <AdminRoute>\n                            <AdminDashboard />\n                        </AdminRoute>\n                    } \n                />\n            </Routes>\n        </BrowserRouter>\n    );\n};\n\nexport default AppRouter;"],"names":["Navbar","_user$email","navigate","useNavigate","location","useLocation","isAuthenticated","user","logout","checkAuth","useAuth","authStatus","setAuthStatus","useState","isAdmin","checked","useEffect","updateAuthStatus","isAuth","isAdminUser","role","console","log","pathname","anchorEl","setAnchorEl","open","Boolean","handleClose","_jsx","AppBar","position","sx","background","boxShadow","children","_jsxs","Toolbar","IconButton","size","edge","color","mr","onClick","HomeIcon","Typography","variant","component","flexGrow","Button","startIcon","AirplaneTicketIcon","_Fragment","PersonIcon","HistoryIcon","AdminPanelSettingsIcon","Tooltip","title","email","event","currentTarget","undefined","ml","Avatar","width","height","bgcolor","charAt","toUpperCase","Menu","id","onClose","MenuListProps","PaperProps","borderRadius","MenuItem","Divider","handleLogout","_ref","error","severity","action","Box","_objectSpread","mb","Collapse","in","Alert","CloseIcon","fontSize","AlertTitle","Login","login","loading","authLoading","setEmail","password","setPassword","setError","sessionExpired","setSessionExpired","setLoading","showTestCredentials","setShowTestCredentials","URLSearchParams","search","get","applyTestCredentials","isLoading","Container","maxWidth","Paper","elevation","p","mt","textAlign","ErrorAlert","onSubmit","async","e","preventDefault","Error","from","state","message","status","navigator","onLine","TextField","margin","required","fullWidth","label","name","autoComplete","autoFocus","value","onChange","target","disabled","type","CircularProgress","borderColor","backgroundColor","gutterBottom","display","Register","formData","setFormData","firstName","lastName","confirmPassword","handleChange","align","length","response","registerUser","userId","initializeSession","Grid","container","spacing","item","xs","sm","helperText","formatPrice","price","Intl","NumberFormat","style","currency","maximumFractionDigits","format","text","highlight","trim","searchValue","replace","regex","RegExp","concat","parts","split","map","part","i","toLowerCase","fontWeight","API_BASE_URL","process","REACT_APP_BACKEND_URL","CodePill","styled","theme","alignItems","justifyContent","minWidth","marginRight","padding","ResultItem","_ref2","cursor","palette","hover","_ref3","_anchorRef$current","placeholder","setOpen","options","setOptions","searchText","setSearchText","displayValue","setDisplayValue","errorMessage","setErrorMessage","anchorRef","useRef","searchAirports","useCallback","query","fetch","encodeURIComponent","ok","data","json","ClickAwayListener","onClickAway","handleClickAway","ref","newValue","onFocus","InputProps","startAdornment","InputAdornment","SearchIcon","endAdornment","handleClear","Popper","current","placement","clientWidth","zIndex","maxHeight","overflow","airport","React","formattedValue","code","city","handleOptionSelect","noWrap","HighlightText","country","demoFlights","flightNumber","airline","origin","destination","departureTime","moment","add","set","hour","minute","arrivalTime","seats","Array","fill","_","seatNumber","String","fromCharCode","Math","floor","available","random","apiSourced","originCity","originName","destinationCity","destinationName","isAdminView","searchDate","setSearchDate","setOrigin","originAirport","setOriginAirport","setDestination","destinationAirport","setDestinationAirport","flights","setFlights","isSearching","setIsSearching","apiAvailable","setApiAvailable","searchAttempted","setSearchAttempted","bookingInProgress","setBookingInProgress","useTheme","isMobile","useMediaQuery","breakpoints","down","isTablet","between","handleBooking","flight","find","f","flightId","isBefore","filter","s","token","localStorage","getItem","apiFlightData","_flight$seats","seatCount","availableSeatsCount","seat","availableSeats","convertToApiFlightType","timeoutPromise","Promise","reject","setTimeout","savedFlight","race","saveApiFlightToDatabase","includes","err","getAvailableSeatsCount","getFlightStatus","Chip","now","departure","hoursDiff","diff","isDepartingSoon","totalSeats","getFlightSourceInfo","CloudIcon","FlightIcon","calculateDuration","start","end","duration","hours","asHours","minutes","getAirportDisplayShort","className","py","AirportAutocomplete","handleOriginChange","handleDestinationChange","LocalizationProvider","dateAdapter","AdapterMoment","DatePicker","slotProps","textField","startOf","axios","params","departureDate","headers","processedData","all","enrichedFlight","getAirportByCode","warn","filteredFlights","isSame","originCode","destinationCode","newDemoFlight","clone","LinearProgress","Card","transition","transform","CardContent","pb","flexDirection","flex","ArrowRightAltIcon","mx","my","AirlineSeatReclineNormalIcon","AttachMoneyIcon","CardActions","px","pt","TableContainer","Table","TableHead","TableRow","TableCell","TableBody","webSocketService","constructor","client","subscriptions","Map","connectionPromise","reconnectAttempts","maxReconnectAttempts","reconnectDelay","_connected","tokenUserId","this","getUserIdFromToken","setItem","storedUserId","Date","toString","substring","initializeConnection","window","addEventListener","key","updateUserIdFromToken","base64","jsonPayload","decodeURIComponent","atob","c","charCodeAt","slice","join","payload","JSON","parse","sub","user_id","newUserId","forceReconnect","isConnected","connect","deactivate","Client","webSocketFactory","SockJS","debug","str","heartbeatIncoming","heartbeatOutgoing","resolve","onConnect","frame","wasDisconnected","resubscribeAll","reconnectEvent","CustomEvent","document","dispatchEvent","onStompError","onWebSocketClose","handleReconnect","activate","delay","min","pow","oldSubscriptions","clear","forEach","topic","callback","subscription","subscribe","body","subscribeSeatUpdates","ensureConnection","has","update","unsubscribeSeatUpdates","unsubscribe","delete","staleConnectionTime","lastConnectionAttempt","parseInt","selectSeat","request","sendMessage","releaseSeat","holdSeat","publish","stringify","disconnect","SEAT_SELECTION_STORAGE_KEY","onSeatSelect","selectedSeats","setSeats","isProcessing","setIsProcessing","initialSeatCount","setInitialSeatCount","lastVerificationTime","setLastVerificationTime","holdExpirationMessage","setHoldExpirationMessage","pendingOperations","setPendingOperations","Set","lastRefreshTime","setLastRefreshTime","lastBroadcastTime","setLastBroadcastTime","broadcastSeatUpdate","seatId","timestamp","removeItem","handleStorageChange","verifyAllSeats","removeEventListener","then","catch","refreshInterval","setInterval","refreshSeats","clearInterval","handleSeatUpdate","prevSeats","isBooked","booked","_seats$find","allSeatsData","getAllSeatsForFlight","serverSeat","unavailableSelectedSeats","unavailableSeatId","_seats$find2","validSelectedSeats","verifySelectedSeats","seatsData","updatedSeats","fetchSeats","abs","refetchSeats","syncAllSeats","hasChanges","seatMap","localSeat","_seats$find3","intervalId","renderSeat","isSelected","isPermanentlyBooked","isTemporarilySelected","statusText","isClickable","handleClick","prev","currentSeat","newSet","success","handleSeatClick","md","m","content","bottom","left","overflowX","Snackbar","autoHideDuration","renderSeatGrid","groupedByRow","reduce","acc","rowLetter","push","Object","keys","sort","sortedSeats","a","b","midPoint","ceil","leftSeats","rightSeats","alignSelf","flexWrap","gap","SyncIcon","SEAT_STORAGE_KEY","SeatSelectionWrapper","useParams","setSelectedSeats","selectedSeatNumbers","setSelectedSeatNumbers","setIsLoading","successMessage","setSuccessMessage","passengerDialogOpen","setPassengerDialogOpen","passengers","setPassengers","formErrors","setFormErrors","flightData","setFlightData","isApiSourced","setIsApiSourced","isFlightSaved","setIsFlightSaved","lastSeatCheckTime","setLastSeatCheckTime","flightIdNumber","seatStorageKey","seatNumbersStorageKey","storedSeats","sessionStorage","storedSeatNumbers","parsedSeats","isArray","parsedSeatNumbers","checkForUpdates","storedFlights","apiFlight","storageErr","checkFlight","saveFlightIfNeeded","updatedPassengers","index","existingPassenger","phone","age","handleSeatSelect","updatedSeatNumbers","num","validatePassengerInfo","errors","isValid","passenger","passengerPrefix","match","isNaN","Number","handlePassengerDialogClose","some","confirm","handleBookingConfirmation","formattedPassengers","bookingResult","createBooking","bookError","getFieldError","passengerIndex","field","handlePassengerChange","errorKey","updatedErrors","seatNum","onDelete","SeatSelection","handlePassengerInfoClick","top","right","Dialog","DialogTitle","DialogContent","inputProps","max","DialogActions","anchorOrigin","vertical","horizontal","Home","FlightTakeoffIcon","Profile","profile","setProfile","isEditing","setIsEditing","setSuccess","emailChanged","setEmailChanged","userData","apiError","decoded","jwt_decode","fetchProfile","put","FormHelperText","multiline","rows","address","demoBookings","seatIds","subtract","BookingHistory","bookings","setBookings","confirmDialogOpen","setConfirmDialogOpen","selectedBookingId","setSelectedBookingId","showFilters","setShowFilters","filters","setFilters","bookingId","flightDate","page","sortBy","direction","totalPages","setTotalPages","totalItems","setTotalItems","flightDateValue","setFlightDateValue","retryCount","setRetryCount","fetchBookings","hasActiveFilters","cleanedFilters","getFilteredBookings","filteredDemoBookings","_filters$status","getUserBookings","simpleResponse","getSimpleFilteredBookings","fallbackError","stack","handleFilterChange","prevFilters","handleDateChange","date","formattedDate","handleApplyFilters","handleResetFilters","handleCancelDialogClose","select","booking","FlightLandIcon","EventIcon","toLocaleString","AccessTimeIcon","paddingLeft","handleCancelDialogOpen","Pagination","count","handlePageChange","DialogContentText","updatedBookings","bookingIdToCancel","result","cancelBooking","BookingConfirmation","_booking$passengers","setBooking","shareDialogOpen","setShareDialogOpen","formatDate","dateString","toLocaleDateString","weekday","year","month","day","formatTime","toLocaleTimeString","hour12","bookingData","getBookingById","fetchBookingDetails","hasPassengerInfo","hasFlightInfo","Stepper","activeStep","alternativeLabel","Step","StepLabel","CheckCircleIcon","verticalAlign","AirplanemodeActiveIcon","CalendarTodayIcon","LocalOfferIcon","seatClass","departureTimeStr","arrivalTimeStr","durationMs","getTime","ConfirmationNumberIcon","InfoIcon","getBookingStatusChip","flightStatus","getFlightStatusChip","List","_booking$passengers2","ListItem","divider","EmailIcon","PhoneIcon","DownloadIcon","downloadTicket","emailTicket","ShareIcon","isChecking","setIsChecking","timer","path","clearTimeout","Navigate","to","ApiManagement","apiEnabled","setApiEnabled","statsLoading","setStatsLoading","statistics","setStatistics","fetchApiStatus","enabled","fetchApiStatistics","generateMockStatistics","stats","parseApiUsageString","parseErr","usageString","callsMatch","maxMatch","calls","totalCalls","successRate","failureRate","avgResponseTime","callsByEndpoint","callsByDay","setDate","getDate","dailyCalls","toISOString","mockStats","FormControlLabel","control","Switch","newStatus","post","enableApi","toFixed","ResponsiveContainer","BarChart","entries","endpoint","CartesianGrid","strokeDasharray","XAxis","dataKey","angle","textAnchor","YAxis","Bar","LineChart","yAxisId","orientation","domain","Legend","Line","stroke","UserManagement","users","setUsers","openDialog","setOpenDialog","openDeleteDialog","setOpenDeleteDialog","selectedUserId","setSelectedUserId","snackbar","setSnackbar","isServerAvailable","timeout","fetchUsers","mappedUsers","Authorization","registrationDate","handleInputChange","resetForm","handleOpenDialog","handleCloseDialog","handleCloseDeleteDialog","showSnackbar","handleCloseSnackbar","RefreshIcon","AddIcon","handleOpenDeleteDialog","DeleteIcon","FormControl","InputLabel","Select","labelId","mockUser","newUser","TabPanel","props","other","_objectWithoutProperties","_excluded","hidden","a11yProps","AdminDashboard","setValue","paragraph","borderBottom","Tabs","scrollButtons","Tab","icon","ApiIcon","iconPosition","PeopleIcon","isVerifying","setIsVerifying","isAuthorized","setIsAuthorized","userRole","verifyAdmin","AppRouter","BrowserRouter","Routes","Route","element","ProtectedRoute","FlightList","AdminRoute"],"sourceRoot":""}